<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />

    <link rel="icon" href="%sveltekit.assets%/favicon.png" />
    
    <!-- UPDATED: Combined and enhanced viewport meta tag for Capacitor -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, maximum-scale=1.0, user-scalable=no" />
    
    <meta
      name="facebook-domain-verification"
      content="336vfi1l9zfva9cxs7h2nd0304eqam"
    />
    <link rel="stylesheet" href="/atlas-icons/style.css" />
    <link rel="stylesheet" href="/css/native-like-experience.css" />

    %sveltekit.head%
    <link rel="manifest" href="%sveltekit.assets%/manifest.json" />

    <title>AgSkan</title>
    <meta
      name="description"
      content="Live vehicle tracking. Auto-Path for your Paddocks."
    />



    <!-- ADDED: Specific mobile settings for Capacitor -->
    <meta name="format-detection" content="telephone=no" />
    <meta name="msapplication-tap-highlight" content="no" />
    
    <!-- UPDATED: Theme color handling for Capacitor -->
    <meta name="theme-color" content="#f9e58a" id="theme-color" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="google" content="notranslate" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary" />
    <meta name="twitter:site" content="@SKANfarming" />
    <meta name="twitter:url" content="https://www.skanfarming.com.au/" />
    <meta name="twitter:title" content="AgSKAN" />
    <meta
      name="twitter:description"
      content="Live vehicle tracking. Auto-Path for your Paddocks."
    />
    <meta
      name="twitter:image"
      content="https://www.skanfarming.com.au//mobiledisplay1.jpg"
    />

    <!-- Open Graph -->
    <meta property="og:type" content="website" />
    <meta property="og:title" content="AgSKAN" />
    <meta
      property="og:description"
      content="Live vehicle tracking. Auto-Path for your Paddocks."
    />
    <meta property="og:site_name" content="AgSKAN" />
    <meta property="og:url" content="https://www.skanfarming.com.au/" />
    <meta
      property="og:image"
      content="https://www.skanfarming.com.au//mobiledisplay1.jpg"
    />

    <script
      async
      src="https://unpkg.com/pwacompat"
      crossorigin="anonymous"
    ></script>

    <!-- Apple touch icon -->
    <link
      rel="apple-touch-icon"
      sizes="120x120"
      href="/icons/apple-touch-icon_120.png"
    />
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/icons/apple-touch-icon_180.png"
    />

    <link rel="icon" href="%sveltekit.assets%/icon.svg" />
  </head>
  <body
    data-sveltekit-preload-data="hover"
    style="min-height: 100vh; display: flex; flex-direction: column"
  >
    <div style="display: contents">
      %sveltekit.body%

      <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/gsap.min.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.9.1/MotionPathPlugin.min.js"></script>

      <!--Ionic Icons-->
      <script
        type="module"
        src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"
      ></script>
      <script
        nomodule
        src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"
      ></script>
    </div>

    <script>
      function updateThemeColor() {
        const themeColorMeta = document.getElementById("theme-color")
        if (
          window.matchMedia &&
          window.matchMedia("(prefers-color-scheme: dark)").matches
        ) {
          themeColorMeta.setAttribute("content", "#f9e58a") // Dark mode color
        } else {
          themeColorMeta.setAttribute("content", "#102030") // Light mode color
        }
      }

      // Initial update
      updateThemeColor()

      // Listen for changes in color scheme preference
      window
        .matchMedia("(prefers-color-scheme: dark)")
        .addListener(updateThemeColor)
    </script>

    <!-- SIMPLIFIED: StatusBar fix without scrollbar changes -->
    <!-- <script>
      // Wait for the DOM to be ready
      document.addEventListener('DOMContentLoaded', function() {
        // Check if running in Capacitor
        const isCapacitor = window.Capacitor && window.Capacitor.isNativePlatform();
        
        if (isCapacitor) {
          console.log('Initializing Capacitor environment');
          
          try {
            // Access plugins through Capacitor.Plugins
            const { StatusBar, SplashScreen } = Capacitor.Plugins;
            
            // Minimal status bar fix - the essential sequence to fix the overlay issue
            if (Capacitor.isPluginAvailable('StatusBar')) {
              // Hide first to reset state
              StatusBar.hide()
                .then(() => {
                  // Set overlay to false - this is the critical part
                  return StatusBar.setOverlaysWebView({ overlay: false });
                })
                .then(() => {
                  // Show again with correct styling
                  return StatusBar.show();
                })
                .then(() => {
                  // Set style based on theme
                  const isDark = window.matchMedia &&
                                window.matchMedia("(prefers-color-scheme: dark)").matches;
                  return StatusBar.setStyle({
                    style: isDark ? 'DARK' : 'LIGHT'
                  });
                })
                .then(() => {
                  console.log('StatusBar configured successfully');
                })
                .catch(err => {
                  console.error('Error configuring StatusBar:', err);
                });
            }
            
            // Hide splash screen
            if (Capacitor.isPluginAvailable('SplashScreen')) {
              // Hide splash with a slight delay to ensure UI is ready
              setTimeout(() => {
                SplashScreen.hide().catch(err => {
                  console.error('Error hiding splash screen:', err);
                });
              }, 500);
            }
          } catch (err) {
            console.error('Error during Capacitor initialization:', err);
          }
        }
      });
    </script> -->

    <!-- 100% privacy-first analytics - Fixed with hostname for localhost -->
    <script
      async
      defer
      data-hostname="skanfarming.com.au"
      src="https://scripts.simpleanalyticscdn.com/latest.js"
    ></script>
    <noscript>
      <img
        src="https://queue.simpleanalyticscdn.com/noscript.gif?hostname=skanfarming.com.au"
        alt=""
        referrerpolicy="no-referrer-when-downgrade"
      />
    </noscript>
  </body>
</html>

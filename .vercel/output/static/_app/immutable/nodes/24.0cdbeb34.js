import{b as N,r as U}from"../chunks/_layout.78544974.js";import{s as j,e as v,c as _,b as C,h as f,i as y,j as x,n as g,l as A,N as H,q as L,a as k,g as w,d as S,k as b,x as O,t as D,f as F,A as q,z}from"../chunks/scheduler.ccf898a6.js";import{S as P,i as V,t as $,a as E,c as B,b as M,d as J,m as K,e as W,g as G}from"../chunks/index.7272c3b3.js";import{s as Q}from"../chunks/user.18705ff9.js";import{s as R}from"../chunks/supabaseClient.5a6af499.js";import"../chunks/paths.d8f4387a.js";function X(c){let e;return{c(){e=v("div"),this.h()},l(r){e=_(r,"DIV",{id:!0,class:!0}),C(e).forEach(f),this.h()},h(){y(e,"id","container_"+T),y(e,"class","min-h-[90vh] overflow-auto")},m(r,t){x(r,e,t)},p:g,d(r){r&&f(e)}}}function Y(c){let e,r,t="Form Completed!",n,s,o,m="Dashboard",a,l;function i(d,p){return d[1]&&d[1].user?ee:Z}let u=i(c),h=u(c);return{c(){e=v("div"),r=v("h2"),r.textContent=t,n=k(),h.c(),s=k(),o=v("button"),o.textContent=m,this.h()},l(d){e=_(d,"DIV",{class:!0});var p=C(e);r=_(p,"H2",{class:!0,"data-svelte-h":!0}),w(r)!=="svelte-11160wg"&&(r.textContent=t),n=S(p),h.l(p),s=S(p),o=_(p,"BUTTON",{class:!0,"data-svelte-h":!0}),w(o)!=="svelte-133g8s4"&&(o.textContent=m),p.forEach(f),this.h()},h(){y(r,"class","text-2xl font-bold mb-4"),y(o,"class","btn btn-primary mt-6"),y(e,"class","text-center")},m(d,p){x(d,e,p),b(e,r),b(e,n),h.m(e,null),b(e,s),b(e,o),a||(l=O(o,"click",c[2]),a=!0)},p(d,p){u===(u=i(d))&&h?h.p(d,p):(h.d(1),h=u(d),h&&(h.c(),h.m(e,s)))},d(d){d&&f(e),h.d(),a=!1,l()}}}function Z(c){let e,r="Thank you for submitting the form!";return{c(){e=v("p"),e.textContent=r,this.h()},l(t){e=_(t,"P",{class:!0,"data-svelte-h":!0}),w(e)!=="svelte-1a4erge"&&(e.textContent=r),this.h()},h(){y(e,"class","text-lg")},m(t,n){x(t,e,n)},p:g,d(t){t&&f(e)}}}function ee(c){let e,r,t=c[1].user.user_metadata.name+"",n;return{c(){e=v("p"),r=D("Thankyou "),n=D(t),this.h()},l(s){e=_(s,"P",{class:!0});var o=C(e);r=F(o,"Thankyou "),n=F(o,t),o.forEach(f),this.h()},h(){y(e,"class","text-lg")},m(s,o){x(s,e,o),b(e,r),b(e,n)},p(s,o){o&2&&t!==(t=s[1].user.user_metadata.name+"")&&q(n,t)},d(s){s&&f(e)}}}function te(c){let e;function r(s,o){return s[0]?Y:X}let t=r(c),n=t(c);return{c(){e=v("div"),n.c(),this.h()},l(s){e=_(s,"DIV",{class:!0});var o=C(e);n.l(o),o.forEach(f),this.h()},h(){y(e,"class","max-w-2xl mx-auto p-4 bg-green-200 rounded-lg shadow-md overflow-auto")},m(s,o){x(s,e,o),n.m(e,null)},p(s,[o]){t===(t=r(s))&&n?n.p(s,o):(n.d(1),n=t(s),n&&(n.c(),n.m(e,null)))},i:g,o:g,d(s){s&&f(e),n.d()}}}const T="7d624884-1198-4af8-b49d-4b8b5efcb85c",re="Customer Survey";function se(c,e,r){let t;A(c,Q,a=>r(1,t=a));const n=H();let s=!1,o=null;return L(async()=>{const a=document.createElement("script");return a.src="https://cdn.jsdelivr.net/npm/@feathery/react@latest/umd/index.js",a.async=!0,a.onload=()=>{Feathery.init(T),t&&t.user&&Feathery.updateUserId(t.user.id),Feathery.renderAt(`container_${T}`,{formName:re,initialLoader:{show:!0,loader:`
                <div class="flex flex-col items-center space-y-4">
                  <div class="border-t-4 border-primary animate-spin rounded-full w-12 h-12 mb-4"></div>
                  <p class="text-lg text-primary-content">Loading form...</p>
                </div>
              `,initialContainerHeight:"600px",initialContainerWidth:"100%"},onFormComplete:async l=>{r(0,s=!0),o={id:l.userId};for(const i in l.fields)if(l.fields.hasOwnProperty(i)){const u=l.fields[i],h=i.replace(/[#\s]/g,"_").toLowerCase(),d=Array.isArray(u.value)?u.value.join(", "):u.value;d!==void 0&&(o[h]=d)}try{const{data:i,error:u}=await R.from("survey_response").upsert(o,{onConflict:"id"});u?console.error("Error inserting survey response:",u):console.log("Survey response inserted successfully:",i)}catch(i){console.error("Error inserting survey response:",i)}n("complete"),console.log(o)}})},document.head.appendChild(a),()=>{document.head.removeChild(a)}}),[s,t,()=>location.href="/account"]}class ne extends P{constructor(e){super(),V(this,e,se,te,j,{})}}async function oe({parent:c}){const e=await c();if(N(e==null?void 0:e.profile))throw U(303,"/account/select_plan");return e}const he=Object.freeze(Object.defineProperty({__proto__:null,load:oe},Symbol.toStringTag,{value:"Module"}));function I(c){let e,r,t,n="Skip Survey",s,o,m;return e=new ne({}),e.$on("complete",c[1]),{c(){M(e.$$.fragment),r=k(),t=v("button"),t.textContent=n,this.h()},l(a){J(e.$$.fragment,a),r=S(a),t=_(a,"BUTTON",{class:!0,"data-svelte-h":!0}),w(t)!=="svelte-jba738"&&(t.textContent=n),this.h()},h(){y(t,"class","btn btn-secondary mt-4")},m(a,l){K(e,a,l),x(a,r,l),x(a,t,l),s=!0,o||(m=O(t,"click",c[2]),o=!0)},p:g,i(a){s||($(e.$$.fragment,a),s=!0)},o(a){E(e.$$.fragment,a),s=!1},d(a){a&&(f(r),f(t)),W(e,a),o=!1,m()}}}function ae(c){let e,r,t,n,s,o="User Survey",m,a,l=!c[0]&&I(c);return{c(){e=k(),r=v("div"),t=v("div"),n=v("div"),s=v("h1"),s.textContent=o,m=k(),l&&l.c(),this.h()},l(i){z("svelte-1tnm1ny",document.head).forEach(f),e=S(i),r=_(i,"DIV",{class:!0});var h=C(r);t=_(h,"DIV",{class:!0});var d=C(t);n=_(d,"DIV",{});var p=C(n);s=_(p,"H1",{class:!0,"data-svelte-h":!0}),w(s)!=="svelte-nesswd"&&(s.textContent=o),m=S(p),l&&l.l(p),p.forEach(f),d.forEach(f),h.forEach(f),this.h()},h(){document.title="User Survey",y(s,"class","text-2xl font-bold mb-6"),y(t,"class","flex flex-col w-full px-6"),y(r,"class","text-center content-center min-h-[100vh] mb-12 mt-4 flex items-center place-content-center")},m(i,u){x(i,e,u),x(i,r,u),b(r,t),b(t,n),b(n,s),b(n,m),l&&l.m(n,null),a=!0},p(i,[u]){i[0]?l&&(G(),E(l,1,1,()=>{l=null}),B()):l?(l.p(i,u),u&1&&$(l,1)):(l=I(i),l.c(),$(l,1),l.m(n,null))},i(i){a||($(l),a=!0)},o(i){E(l),a=!1},d(i){i&&(f(e),f(r)),l&&l.d()}}}function le(c,e,r){let t=!1;const n=async m=>{if(!(await fetch("/account/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"updateProfile",surveyCompleted:m})})).ok)throw console.error("Error updating survey status"),new Error("Failed to update survey status")};return[t,async()=>{r(0,t=!0);try{await n(!0),window.location.reload()}catch(m){console.error("Error updating survey status:",m)}finally{}},async()=>{try{await n(!0),window.location.reload()}catch(m){console.error("Error updating survey status:",m)}finally{}}]}class pe extends P{constructor(e){super(),V(this,e,le,ae,j,{})}}export{pe as component,he as universal};

import{s as Ne,N as ze,B as ge,j as P,h as p,q as Fe,e as m,a as M,c as h,b as w,d as D,g as z,i as f,O as ke,k as a,x as G,y as xe,t as ce,f as fe,A as me,M as Te,n as pe,l as Be,D as ot,P as Ie,v as Me,w as De,z as it,I as ct,C as ft}from"../chunks/scheduler.ccf898a6.js";import{S as Pe,i as Le,t as Q,g as Ce,a as le,c as ye,b as _e,d as Ee,m as ve,e as be}from"../chunks/index.7272c3b3.js";import{_ as at}from"../chunks/preload-helper.a4192956.js";import{w as ut}from"../chunks/paths.d8f4387a.js";import{e as je}from"../chunks/each.34974530.js";import{p as He}from"../chunks/stores.54c459da.js";import{s as he}from"../chunks/supabaseClient.5a6af499.js";import{c as dt}from"../chunks/public.d2f41676.js";import{v as pt}from"../chunks/v4.4a60fe23.js";const Oe=ut([]);function mt(n){const e=[".zip",".kml",".isoxml",".xml"],t=n.name.toLowerCase().slice(n.name.lastIndexOf("."));return e.includes(t)}function ht(n,e,t){let{file:l}=e;const s=ze();function o(){mt(l)?s("validFile",{file:l}):s("invalidFile",{file:l})}return n.$$set=r=>{"file"in r&&t(0,l=r.file)},n.$$.update=()=>{n.$$.dirty&1&&l&&o()},[l]}class Se extends Pe{constructor(e){super(),Le(this,e,ht,null,Ne,{file:0})}}function Ae(n){let e,t,l,s,o,r,d='<svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path></svg>',i,c,u="Upload Files",_,v,C="Upload your farms paddock boundary files",I,E,x,T,y,N,k,b,g,S,W,U,F,q,R,Z,A=`<h3 class="text-lg font-bold mb-2">File Upload Requirements</h3> <ul class="list-none pl-6 mb-4"><li class="mb-2"><span class="inline-block w-4 h-4 mr-2"><i class="at-check-circle-bold"></i></span>
              Zipped Shapefiles, .KML files and ISOXML files are all accepted</li> <li class="mb-2"><span class="inline-block w-4 h-4 mr-2"><i class="at-check-circle-bold"></i></span>
              Shapefile ZIP must contain .dbf, .shx and .shp files.</li> <li class="mb-2"><span class="inline-block w-4 h-4 mr-2"><i class="at-check-circle-bold"></i></span>
              Multiple ZIP files or an ISOXML can be contained in a single ZIP file.</li> <li><span class="inline-block w-4 h-4 mr-2"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M6 2a2 2 0 00-2 2v12a2 2 0 002 2h8a2 2 0 002-2V7.414A2 2 0 0015.414 6L12 2.586A2 2 0 0010.586 2H6zm5 6a1 1 0 10-2 0v3.586l-1.293-1.293a1 1 0 10-1.414 1.414l3 3a1 1 0 001.414 0l3-3a1 1 0 00-1.414-1.414L11 11.586V8z" clip-rule="evenodd"></path></svg></span> <a href="docs/skan_sample_shapefile.zip" class="text-blue-500 hover:text-blue-700 underline">Download Example Paddock
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 inline-block ml-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"></path></svg></a></li></ul> <h3 class="text-lg font-bold mb-2">Supported Polygon Types</h3> <ul class="list-none pl-6"><li class="mb-2"><span class="inline-block w-4 h-4 mr-2"><i class="at-check-circle-bold"></i></span>
              Polygon</li> <li><span class="inline-block w-4 h-4 mr-2"><i class="at-check-circle-bold"></i></span>
              Multipolygon</li></ul>`,O,L,H,Y,j;const K=[bt,vt,_t],ee=[];function ae(V,$){return V[2]&&!V[5]?0:V[5]?1:2}T=ae(n),y=ee[T]=K[T](n);function ue(V,$){return V[4]?wt:gt}let ie=ue(n),re=ie(n),X=n[5]&&Ze(n),te=n[6]&&Ke(n),B=n[7]&&Xe(n);return L=new Se({props:{file:n[2]}}),L.$on("validFile",n[9]),L.$on("invalidFile",n[10]),{c(){e=m("div"),t=m("div"),l=M(),s=m("div"),o=m("div"),r=m("button"),r.innerHTML=d,i=M(),c=m("h3"),c.textContent=u,_=M(),v=m("h3"),v.textContent=C,I=M(),E=m("div"),x=m("label"),y.c(),N=M(),k=m("input"),b=M(),g=m("button"),re.c(),W=M(),U=m("div"),X&&X.c(),F=M(),te&&te.c(),q=M(),B&&B.c(),R=M(),Z=m("div"),Z.innerHTML=A,O=M(),_e(L.$$.fragment),this.h()},l(V){e=h(V,"DIV",{class:!0});var $=w(e);t=h($,"DIV",{class:!0}),w(t).forEach(p),l=D($),s=h($,"DIV",{class:!0});var we=w(s);o=h(we,"DIV",{class:!0});var ne=w(o);r=h(ne,"BUTTON",{class:!0,"data-svelte-h":!0}),z(r)!=="svelte-101rc4g"&&(r.innerHTML=d),i=D(ne),c=h(ne,"H3",{class:!0,"data-svelte-h":!0}),z(c)!=="svelte-1ifn8g3"&&(c.textContent=u),_=D(ne),v=h(ne,"H3",{class:!0,"data-svelte-h":!0}),z(v)!=="svelte-squgt5"&&(v.textContent=C),I=D(ne),E=h(ne,"DIV",{class:!0});var J=w(E);x=h(J,"LABEL",{for:!0,class:!0});var se=w(x);y.l(se),N=D(se),k=h(se,"INPUT",{id:!0,type:!0,class:!0}),se.forEach(p),b=D(J),g=h(J,"BUTTON",{class:!0});var oe=w(g);re.l(oe),oe.forEach(p),J.forEach(p),W=D(ne),U=h(ne,"DIV",{class:!0});var de=w(U);X&&X.l(de),F=D(de),te&&te.l(de),q=D(de),B&&B.l(de),de.forEach(p),R=D(ne),Z=h(ne,"DIV",{class:!0,"data-svelte-h":!0}),z(Z)!=="svelte-xkpt54"&&(Z.innerHTML=A),O=D(ne),Ee(L.$$.fragment,ne),ne.forEach(p),we.forEach(p),$.forEach(p),this.h()},h(){f(t,"class","overlay absolute inset-0 bg-black opacity-50"),f(r,"class","btn btn-sm btn-circle absolute top-2 right-2"),f(c,"class","card-title justify-center text-2xl font-bold mb-4"),f(v,"class","card-title justify-center text-lg mb-4"),f(k,"id","dropzone-file"),f(k,"type","file"),f(k,"class","hidden"),f(x,"for","dropzone-file"),f(x,"class","flex flex-col items-center justify-center w-3/4 h-64 border-2 border-gray-300 border-dashed rounded-lg cursor-pointer bg-gray-50 dark:hover:bg-bray-800 dark:bg-gray-700 hover:bg-gray-100 dark:border-gray-600 dark:hover:border-gray-500 dark:hover:bg-gray-600"),f(g,"class","btn mt-4"),g.disabled=S=!n[2]||!n[3]||n[4],ke(g,"bg-gray-400",!n[2]||!n[3]),ke(g,"bg-green-500",n[2]&&n[3]),ke(g,"hover:bg-green-600",n[2]&&n[3]),ke(g,"opacity-50",!n[2]||!n[3]),f(E,"class","flex flex-col items-center justify-center w-full max-w-7xl mx-auto"),f(U,"class","justify-center mx-auto"),f(Z,"class","mt-2 max-w-6xl mx-auto"),f(o,"class","card-body relative"),f(s,"class","card w-full max-w-3xl bg-base-100 shadow-xl z-10 mx-auto fullscreen-modal svelte-1e8mk0g"),f(e,"class","fixed inset-0 z-50")},m(V,$){P(V,e,$),a(e,t),a(e,l),a(e,s),a(s,o),a(o,r),a(o,i),a(o,c),a(o,_),a(o,v),a(o,I),a(o,E),a(E,x),ee[T].m(x,null),a(x,N),a(x,k),a(E,b),a(E,g),re.m(g,null),a(o,W),a(o,U),X&&X.m(U,null),a(U,F),te&&te.m(U,null),a(U,q),B&&B.m(U,null),a(o,R),a(o,Z),a(o,O),ve(L,o,null),H=!0,Y||(j=[G(r,"click",n[15]),G(k,"change",n[8]),G(x,"dragover",n[12]),G(x,"dragleave",n[13]),G(x,"drop",n[14]),G(g,"click",n[11])],Y=!0)},p(V,$){let we=T;T=ae(V),T===we?ee[T].p(V,$):(Ce(),le(ee[we],1,1,()=>{ee[we]=null}),ye(),y=ee[T],y?y.p(V,$):(y=ee[T]=K[T](V),y.c()),Q(y,1),y.m(x,N)),ie!==(ie=ue(V))&&(re.d(1),re=ie(V),re&&(re.c(),re.m(g,null))),(!H||$&28&&S!==(S=!V[2]||!V[3]||V[4]))&&(g.disabled=S),(!H||$&12)&&ke(g,"bg-gray-400",!V[2]||!V[3]),(!H||$&12)&&ke(g,"bg-green-500",V[2]&&V[3]),(!H||$&12)&&ke(g,"hover:bg-green-600",V[2]&&V[3]),(!H||$&12)&&ke(g,"opacity-50",!V[2]||!V[3]),V[5]?X?X.p(V,$):(X=Ze(V),X.c(),X.m(U,F)):X&&(X.d(1),X=null),V[6]?te?te.p(V,$):(te=Ke(V),te.c(),te.m(U,q)):te&&(te.d(1),te=null),V[7]?B?B.p(V,$):(B=Xe(V),B.c(),B.m(U,null)):B&&(B.d(1),B=null);const ne={};$&4&&(ne.file=V[2]),L.$set(ne)},i(V){H||(Q(y),Q(L.$$.fragment,V),H=!0)},o(V){le(y),le(L.$$.fragment,V),H=!1},d(V){V&&p(e),ee[T].d(),re.d(),X&&X.d(),te&&te.d(),B&&B.d(),be(L),Y=!1,xe(j)}}}function _t(n){let e,t,l,s=`<span class="font-semibold">Click to upload</span> or drag and
                  drop`,o,r,d="ZIP, ISOXML or .KML files (Max: 50mb)",i,c=n[1]&&Ge(n);return{c(){e=m("div"),c&&c.c(),t=M(),l=m("p"),l.innerHTML=s,o=M(),r=m("p"),r.textContent=d,this.h()},l(u){e=h(u,"DIV",{class:!0});var _=w(e);c&&c.l(_),t=D(_),l=h(_,"P",{class:!0,"data-svelte-h":!0}),z(l)!=="svelte-1mmujl8"&&(l.innerHTML=s),o=D(_),r=h(_,"P",{class:!0,"data-svelte-h":!0}),z(r)!=="svelte-10predt"&&(r.textContent=d),_.forEach(p),this.h()},h(){f(l,"class","mb-2 text-sm text-gray-500 dark:text-gray-400"),f(r,"class","text-xs text-gray-500 dark:text-gray-400"),f(e,"class","flex flex-col items-center justify-center pt-5 pb-6")},m(u,_){P(u,e,_),c&&c.m(e,null),a(e,t),a(e,l),a(e,o),a(e,r),i=!0},p(u,_){u[1]?c?(c.p(u,_),_&2&&Q(c,1)):(c=Ge(u),c.c(),Q(c,1),c.m(e,t)):c&&(Ce(),le(c,1,1,()=>{c=null}),ye())},i(u){i||(Q(c),i=!0)},o(u){le(c),i=!1},d(u){u&&p(e),c&&c.d()}}}function vt(n){let e,t,l=n[1]&&Re(n);return{c(){e=m("div"),l&&l.c(),this.h()},l(s){e=h(s,"DIV",{class:!0});var o=w(e);l&&l.l(o),o.forEach(p),this.h()},h(){f(e,"class","flex flex-col items-center justify-center pt-5 pb-6")},m(s,o){P(s,e,o),l&&l.m(e,null),t=!0},p(s,o){s[1]?l?(l.p(s,o),o&2&&Q(l,1)):(l=Re(s),l.c(),Q(l,1),l.m(e,null)):l&&(Ce(),le(l,1,1,()=>{l=null}),ye())},i(s){t||(Q(l),t=!0)},o(s){le(l),t=!1},d(s){s&&p(e),l&&l.d()}}}function bt(n){let e,t,l,s,o=n[2].name+"",r,d,i=n[1]&&Je(n);return{c(){e=m("div"),i&&i.c(),t=M(),l=m("p"),s=m("span"),r=ce(o),this.h()},l(c){e=h(c,"DIV",{class:!0});var u=w(e);i&&i.l(u),t=D(u),l=h(u,"P",{class:!0});var _=w(l);s=h(_,"SPAN",{class:!0});var v=w(s);r=fe(v,o),v.forEach(p),_.forEach(p),u.forEach(p),this.h()},h(){f(s,"class","font-semibold"),f(l,"class","mb-2 text-sm text-gray-500 dark:text-gray-400"),f(e,"class","flex flex-col items-center justify-center pt-5 pb-6")},m(c,u){P(c,e,u),i&&i.m(e,null),a(e,t),a(e,l),a(l,s),a(s,r),d=!0},p(c,u){c[1]?i?(i.p(c,u),u&2&&Q(i,1)):(i=Je(c),i.c(),Q(i,1),i.m(e,t)):i&&(Ce(),le(i,1,1,()=>{i=null}),ye()),(!d||u&4)&&o!==(o=c[2].name+"")&&me(r,o)},i(c){d||(Q(i),d=!0)},o(c){le(i),d=!1},d(c){c&&p(e),i&&i.d()}}}function Ge(n){let e,t,l;var s=n[1];function o(r,d){return{props:{src:"/animations/IdleFile.json",autoplay:!0,loop:!0,controls:!1,controlsLayout:null,renderer:"svg",background:"transparent",height:150,width:150}}}return s&&(e=Te(s,o())),{c(){e&&_e(e.$$.fragment),t=ge()},l(r){e&&Ee(e.$$.fragment,r),t=ge()},m(r,d){e&&ve(e,r,d),P(r,t,d),l=!0},p(r,d){if(d&2&&s!==(s=r[1])){if(e){Ce();const i=e;le(i.$$.fragment,1,0,()=>{be(i,1)}),ye()}s?(e=Te(s,o()),_e(e.$$.fragment),Q(e.$$.fragment,1),ve(e,t.parentNode,t)):e=null}},i(r){l||(e&&Q(e.$$.fragment,r),l=!0)},o(r){e&&le(e.$$.fragment,r),l=!1},d(r){r&&p(t),e&&be(e,r)}}}function Re(n){let e,t,l;var s=n[1];function o(r,d){return{props:{src:"/animations/Error2.json",autoplay:!0,loop:!0,controls:!1,controlsLayout:null,renderer:"svg",background:"transparent",height:200,width:200}}}return s&&(e=Te(s,o())),{c(){e&&_e(e.$$.fragment),t=ge()},l(r){e&&Ee(e.$$.fragment,r),t=ge()},m(r,d){e&&ve(e,r,d),P(r,t,d),l=!0},p(r,d){if(d&2&&s!==(s=r[1])){if(e){Ce();const i=e;le(i.$$.fragment,1,0,()=>{be(i,1)}),ye()}s?(e=Te(s,o()),_e(e.$$.fragment),Q(e.$$.fragment,1),ve(e,t.parentNode,t)):e=null}},i(r){l||(e&&Q(e.$$.fragment,r),l=!0)},o(r){e&&le(e.$$.fragment,r),l=!1},d(r){r&&p(t),e&&be(e,r)}}}function Je(n){let e,t,l;var s=n[1];function o(r,d){return{props:{src:"/animations/OneFileMovement.json",autoplay:!0,loop:!0,controls:!1,controlsLayout:null,renderer:"svg",background:"transparent",height:150,width:200}}}return s&&(e=Te(s,o())),{c(){e&&_e(e.$$.fragment),t=ge()},l(r){e&&Ee(e.$$.fragment,r),t=ge()},m(r,d){e&&ve(e,r,d),P(r,t,d),l=!0},p(r,d){if(d&2&&s!==(s=r[1])){if(e){Ce();const i=e;le(i.$$.fragment,1,0,()=>{be(i,1)}),ye()}s?(e=Te(s,o()),_e(e.$$.fragment),Q(e.$$.fragment,1),ve(e,t.parentNode,t)):e=null}},i(r){l||(e&&Q(e.$$.fragment,r),l=!0)},o(r){e&&le(e.$$.fragment,r),l=!1},d(r){r&&p(t),e&&be(e,r)}}}function gt(n){let e;return{c(){e=ce("Upload File")},l(t){e=fe(t,"Upload File")},m(t,l){P(t,e,l)},d(t){t&&p(e)}}}function wt(n){let e;return{c(){e=ce("Uploading...")},l(t){e=fe(t,"Uploading...")},m(t,l){P(t,e,l)},d(t){t&&p(e)}}}function Ze(n){let e,t;return{c(){e=m("p"),t=ce(n[5]),this.h()},l(l){e=h(l,"P",{class:!0});var s=w(e);t=fe(s,n[5]),s.forEach(p),this.h()},h(){f(e,"class","text-red-500")},m(l,s){P(l,e,s),a(e,t)},p(l,s){s&32&&me(t,l[5])},d(l){l&&p(e)}}}function Ke(n){let e,t;return{c(){e=m("p"),t=ce(n[6]),this.h()},l(l){e=h(l,"P",{class:!0});var s=w(e);t=fe(s,n[6]),s.forEach(p),this.h()},h(){f(e,"class","text-green-500")},m(l,s){P(l,e,s),a(e,t)},p(l,s){s&64&&me(t,l[6])},d(l){l&&p(e)}}}function Xe(n){let e,t,l;return{c(){e=m("p"),t=ce("File Info: "),l=ce(n[7])},l(s){e=h(s,"P",{});var o=w(e);t=fe(o,"File Info: "),l=fe(o,n[7]),o.forEach(p)},m(s,o){P(s,e,o),a(e,t),a(e,l)},p(s,o){o&128&&me(l,s[7])},d(s){s&&p(e)}}}function kt(n){let e,t,l=n[0]&&Ae(n);return{c(){l&&l.c(),e=ge()},l(s){l&&l.l(s),e=ge()},m(s,o){l&&l.m(s,o),P(s,e,o),t=!0},p(s,[o]){s[0]?l?(l.p(s,o),o&1&&Q(l,1)):(l=Ae(s),l.c(),Q(l,1),l.m(e.parentNode,e)):l&&(Ce(),le(l,1,1,()=>{l=null}),ye())},i(s){t||(Q(l),t=!0)},o(s){le(l),t=!1},d(s){s&&p(e),l&&l.d(s)}}}function Ct(n,e,t){let l;Fe(async()=>{{const k=await at(()=>import("../chunks/index.9bcd1db9.js"),["..\\chunks\\index.9bcd1db9.js","..\\chunks\\scheduler.ccf898a6.js","..\\chunks\\index.7272c3b3.js","..\\chunks\\lottie.c94986b4.js","..\\chunks\\_commonjsHelpers.de833af9.js","..\\chunks\\each.34974530.js","..\\assets\\index.798bbb7e.css"],import.meta.url);t(1,l=k.LottiePlayer)}});let{isPopoverOpen:s=!1}=e,o=null,r=!1,d=!1,i="",c="",u="";const _=ze(),v=k=>{var g;const b=k.target;t(2,o=((g=b.files)==null?void 0:g[0])||null),t(3,r=!1),t(5,i=""),t(6,c=""),t(7,u=""),o&&new Se({target:document.createElement("div"),props:{file:o}})},C=k=>{t(3,r=!0),t(5,i=""),t(7,u=k.detail.info)},I=()=>{t(3,r=!1),t(5,i="Invalid file format. Please select a Valid file."),t(7,u="")},E=async()=>{if(o&&r){t(4,d=!0),t(5,i=""),t(6,c="");const k=new FormData;k.append("action","uploadFile"),k.append("file",o);try{const b=await fetch("/account/api",{method:"POST",body:k});if(b.ok){console.log("File uploaded successfully"),t(2,o=null),t(3,r=!1),t(6,c="File uploaded successfully"),_("fileUploaded");const g=await fetch("/account/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"fetchUploadedFiles"})});if(g.ok){const{files:S}=await g.json();Oe.set(S)}else{const S=await g.json();console.error("Error fetching uploaded files:",S),t(5,i="Error fetching uploaded files. Please try again."),t(3,r=!1)}}else{const g=await b.json();console.error("Error uploading file:",g),g.message?t(5,i=g.message):g.error?t(5,i=g.error):t(5,i="An error occurred while uploading the file. Please try again."),t(3,r=!1)}}catch(b){console.error("Error uploading file:",b),t(5,i="An unexpected error occurred while uploading the file. Please try again."),t(3,r=!1)}finally{t(4,d=!1)}}};function x(k){k.preventDefault()}function T(k){k.preventDefault()}function y(k){var g;k.preventDefault();const b=(g=k.dataTransfer)==null?void 0:g.files[0];b&&(t(2,o=b),t(3,r=!1),t(5,i=""),t(6,c=""),t(7,u=""),new Se({target:document.createElement("div"),props:{file:o}}))}function N(){t(5,i=""),t(6,c=""),t(7,u=""),t(3,r=!1),t(2,o=null),t(0,s=!1),document.body.classList.remove("modal-open"),_("close")}return n.$$set=k=>{"isPopoverOpen"in k&&t(0,s=k.isPopoverOpen)},[s,l,o,r,d,i,c,u,v,C,I,E,x,T,y,N]}class yt extends Pe{constructor(e){super(),Le(this,e,Ct,kt,Ne,{isPopoverOpen:0})}}function Et(n){let e,t,l="Upload File",s,o,r,d,i;return o=new yt({props:{isPopoverOpen:n[0]}}),o.$on("close",n[2]),{c(){e=m("div"),t=m("button"),t.textContent=l,s=M(),_e(o.$$.fragment),this.h()},l(c){e=h(c,"DIV",{class:!0});var u=w(e);t=h(u,"BUTTON",{class:!0,"data-svelte-h":!0}),z(t)!=="svelte-13c8ukm"&&(t.textContent=l),s=D(u),Ee(o.$$.fragment,u),u.forEach(p),this.h()},h(){f(t,"class","btn btn-primary"),f(e,"class","my-2")},m(c,u){P(c,e,u),a(e,t),a(e,s),ve(o,e,null),r=!0,d||(i=G(t,"click",n[1]),d=!0)},p(c,[u]){const _={};u&1&&(_.isPopoverOpen=c[0]),o.$set(_)},i(c){r||(Q(o.$$.fragment,c),r=!0)},o(c){le(o.$$.fragment,c),r=!1},d(c){c&&p(e),be(o),d=!1,i()}}}function xt(n,e,t){let l=!1;function s(){t(0,l=!l)}function o(){t(0,l=!1)}return[l,s,o]}class Tt extends Pe{constructor(e){super(),Le(this,e,xt,Et,Ne,{})}}function We(n,e,t){const l=n.slice();return l[7]=e[t],l}function It(n){let e,t=je(n[0]),l=[];for(let s=0;s<t.length;s+=1)l[s]=Ye(We(n,t,s));return{c(){e=m("ul");for(let s=0;s<l.length;s+=1)l[s].c()},l(s){e=h(s,"UL",{});var o=w(e);for(let r=0;r<l.length;r+=1)l[r].l(o);o.forEach(p)},m(s,o){P(s,e,o);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(e,null)},p(s,o){if(o&7){t=je(s[0]);let r;for(r=0;r<t.length;r+=1){const d=We(s,t,r);l[r]?l[r].p(d,o):(l[r]=Ye(d),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(s){s&&p(e),ot(l,s)}}}function Mt(n){let e,t="No files uploaded yet.";return{c(){e=m("p"),e.textContent=t},l(l){e=h(l,"P",{"data-svelte-h":!0}),z(e)!=="svelte-ua8t8w"&&(e.textContent=t)},m(l,s){P(l,e,s)},p:pe,d(l){l&&p(e)}}}function Ye(n){let e,t,l=n[2](n[7])+"",s,o,r,d="Delete",i,c,u;function _(){return n[4](n[7])}return{c(){e=m("li"),t=m("span"),s=ce(l),o=M(),r=m("button"),r.textContent=d,i=M(),this.h()},l(v){e=h(v,"LI",{class:!0});var C=w(e);t=h(C,"SPAN",{});var I=w(t);s=fe(I,l),I.forEach(p),o=D(C),r=h(C,"BUTTON",{class:!0,"data-svelte-h":!0}),z(r)!=="svelte-19xgv8e"&&(r.textContent=d),i=D(C),C.forEach(p),this.h()},h(){f(r,"class","btn btn-sm btn-error"),f(e,"class","flex items-center justify-between")},m(v,C){P(v,e,C),a(e,t),a(t,s),a(e,o),a(e,r),a(e,i),c||(u=G(r,"click",_),c=!0)},p(v,C){n=v,C&1&&l!==(l=n[2](n[7])+"")&&me(s,l)},d(v){v&&p(e),c=!1,u()}}}function Dt(n){let e,t,l="Uploaded Files",s,o,r;function d(u,_){return u[0].length===0?Mt:It}let i=d(n),c=i(n);return{c(){e=m("div"),t=m("h1"),t.textContent=l,s=M(),c.c(),o=M(),r=ge(),this.h()},l(u){e=h(u,"DIV",{class:!0});var _=w(e);t=h(_,"H1",{class:!0,"data-svelte-h":!0}),z(t)!=="svelte-1mht8ki"&&(t.textContent=l),s=D(_),c.l(_),_.forEach(p),o=D(u),r=ge(),this.h()},h(){f(t,"class","text-xl font-bold mb-1"),f(e,"class","my-6")},m(u,_){P(u,e,_),a(e,t),a(e,s),c.m(e,null),P(u,o,_),P(u,r,_)},p(u,[_]){i===(i=d(u))&&c?c.p(u,_):(c.d(1),c=i(u),c&&(c.c(),c.m(e,null)))},i:pe,o:pe,d(u){u&&(p(e),p(o),p(r)),c.d()}}}const Qe=20;function Vt(n,e,t){let l,s;Be(n,Oe,u=>t(3,s=u));const o=ze();let r=!1;function d(u){console.log("deleteFile event dispatched with file:",u),o("deleteFile",{file:u})}function i(u){return r&&u.length>Qe?u.slice(0,Qe)+"...":u}Fe(()=>{const u=new CustomEvent("fetchUploadedFiles");dispatchEvent(u);const _=()=>{r=window.innerWidth<=768};return _(),window.addEventListener("resize",_),()=>{window.removeEventListener("resize",_)}});const c=u=>d(u);return n.$$.update=()=>{n.$$.dirty&8&&t(0,l=s)},[l,d,i,s,c]}class Nt extends Pe{constructor(e){super(),Le(this,e,Vt,Dt,Ne,{})}}async function Pt(n){if("serviceWorker"in navigator&&"PushManager"in window)try{const t=await(await navigator.serviceWorker.ready).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:dt});return await he.from("push_subscriptions").upsert({user_id:n,subscription:JSON.stringify(t)},{onConflict:"user_id"}),t}catch(e){console.error("Error subscribing to push notifications:",e)}}async function Lt(n,e,t){console.log("Sending push notification...");const l=await fetch("/api/send-notification",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({subscription:n,title:e,body:t})});if(!l.ok)throw new Error("Failed to send push notification");return l.json()}function $e(n){let e,t,l,s="Chat",o;function r(c,u){return c[1]!=="granted"?Ot:Ut}let d=r(n),i=d(n);return{c(){e=m("div"),t=m("div"),l=m("h3"),l.textContent=s,o=M(),i.c(),this.h()},l(c){e=h(c,"DIV",{class:!0});var u=w(e);t=h(u,"DIV",{class:!0});var _=w(t);l=h(_,"H3",{class:!0,"data-svelte-h":!0}),z(l)!=="svelte-1ezxekg"&&(l.textContent=s),o=D(_),i.l(_),_.forEach(p),u.forEach(p),this.h()},h(){f(l,"class","card-title"),f(t,"class","card-body"),f(e,"class","card w-80 bg-base-100 shadow-xl")},m(c,u){P(c,e,u),a(e,t),a(t,l),a(t,o),i.m(t,null)},p(c,u){d===(d=r(c))&&i?i.p(c,u):(i.d(1),i=d(c),i&&(i.c(),i.m(t,null)))},d(c){c&&p(e),i.d()}}}function Ut(n){let e,t="Test Push Notification",l,s;return{c(){e=m("button"),e.textContent=t,this.h()},l(o){e=h(o,"BUTTON",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1xh3d94"&&(e.textContent=t),this.h()},h(){f(e,"class","btn btn-secondary")},m(o,r){P(o,e,r),l||(s=G(e,"click",n[4]),l=!0)},p:pe,d(o){o&&p(e),l=!1,s()}}}function Ot(n){let e,t="Enable Notifications",l,s;return{c(){e=m("button"),e.textContent=t,this.h()},l(o){e=h(o,"BUTTON",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-wr1838"&&(e.textContent=t),this.h()},h(){f(e,"class","btn btn-primary")},m(o,r){P(o,e,r),l||(s=G(e,"click",n[3]),l=!0)},p:pe,d(o){o&&p(e),l=!1,s()}}}function Ft(n){let e,t,l="",s,o,r,d=n[0]&&$e(n);return{c(){e=m("div"),t=m("button"),t.innerHTML=l,s=M(),d&&d.c(),this.h()},l(i){e=h(i,"DIV",{class:!0});var c=w(e);t=h(c,"BUTTON",{class:!0,"data-svelte-h":!0}),z(t)!=="svelte-9gwy8j"&&(t.innerHTML=l),s=D(c),d&&d.l(c),c.forEach(p),this.h()},h(){f(t,"class","btn btn-circle btn-lg btn-primary"),f(e,"class","fixed bottom-8 right-8 z-50")},m(i,c){P(i,e,c),a(e,t),a(e,s),d&&d.m(e,null),o||(r=G(t,"click",n[2]),o=!0)},p(i,[c]){i[0]?d?d.p(i,c):(d=$e(i),d.c(),d.m(e,null)):d&&(d.d(1),d=null)},i:pe,o:pe,d(i){i&&p(e),d&&d.d(),o=!1,r()}}}function jt(n,e,t){let l;Be(n,He,u=>t(6,l=u));let s=!1,o="default",r;Fe(async()=>{t(1,o=Notification.permission);const u=l.data.session;u&&(r=u.user.id)});function d(){t(0,s=!s)}async function i(){try{const u=await Notification.requestPermission();t(1,o=u),u==="granted"&&r&&await Pt(r)}catch(u){console.error("Error enabling notifications:",u)}}async function c(){try{const{data:u,error:_}=await he.from("push_subscriptions").select("subscription").eq("user_id",r).single();if(_)throw _;if(u){const v=JSON.parse(u.subscription);await Lt(v,"Test Notification","This is a test push notification!")}else console.error("No subscription found for this user")}catch(u){console.error("Error sending test notification:",u)}}return[s,o,d,i,c]}class Bt extends Pe{constructor(e){super(),Le(this,e,jt,Ft,Ne,{})}}function et(n,e,t){const l=n.slice();return l[48]=e[t],l}function St(n){let e,t="<p>No map assigned.</p>",l,s,o,r="Generate New Map",d,i,c="Connect to Existing Map",u,_;return{c(){e=m("div"),e.innerHTML=t,l=M(),s=m("div"),o=m("button"),o.textContent=r,d=M(),i=m("button"),i.textContent=c,this.h()},l(v){e=h(v,"DIV",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-121ptqh"&&(e.innerHTML=t),l=D(v),s=h(v,"DIV",{class:!0});var C=w(s);o=h(C,"BUTTON",{class:!0,"data-svelte-h":!0}),z(o)!=="svelte-1jlzvsp"&&(o.textContent=r),d=D(C),i=h(C,"BUTTON",{class:!0,"data-svelte-h":!0}),z(i)!=="svelte-139kn95"&&(i.textContent=c),C.forEach(p),this.h()},h(){f(e,"class","my-2 text-center"),f(o,"class","btn btn-primary mb-2 sm:mb-0 sm:mr-2"),f(i,"class","btn btn-secondary"),f(s,"class","flex flex-col sm:flex-row sm:justify-center mt-4")},m(v,C){P(v,e,C),P(v,l,C),P(v,s,C),a(s,o),a(s,d),a(s,i),u||(_=[G(o,"click",n[24]),G(i,"click",n[27])],u=!0)},p:pe,i:pe,o:pe,d(v){v&&(p(e),p(l),p(s)),u=!1,xe(_)}}}function zt(n){let e,t,l,s="Map Name:",o,r,d,i,c,u="Owner:",_,v,C,I,E,x="Share Map:",T,y,N,k,b,g,S,W,U,F,q,R,Z,A,O,L,H,Y="Settings",j,K,ee;function ae(B,V){return B[14]?qt:Ht}let ue=ae(n),ie=ue(n);const re=[Gt,At],X=[];function te(B,V){return B[0]?0:1}return A=te(n),O=X[A]=re[A](n),{c(){e=m("div"),t=m("p"),l=m("strong"),l.textContent=s,o=M(),r=ce(n[2]),d=M(),i=m("p"),c=m("strong"),c.textContent=u,_=M(),v=ce(n[4]),C=M(),I=m("div"),E=m("strong"),E.textContent=x,T=M(),y=m("div"),N=m("button"),k=m("div"),b=m("span"),g=ce(n[1]),S=M(),W=m("div"),U=M(),ie.c(),q=M(),R=m("div"),Z=m("button"),O.c(),L=M(),H=m("button"),H.textContent=Y,this.h()},l(B){e=h(B,"DIV",{class:!0});var V=w(e);t=h(V,"P",{class:!0});var $=w(t);l=h($,"STRONG",{"data-svelte-h":!0}),z(l)!=="svelte-xjrk0h"&&(l.textContent=s),o=D($),r=fe($,n[2]),$.forEach(p),d=D(V),i=h(V,"P",{class:!0});var we=w(i);c=h(we,"STRONG",{"data-svelte-h":!0}),z(c)!=="svelte-q5vggv"&&(c.textContent=u),_=D(we),v=fe(we,n[4]),we.forEach(p),C=D(V),I=h(V,"DIV",{class:!0});var ne=w(I);E=h(ne,"STRONG",{class:!0,"data-svelte-h":!0}),z(E)!=="svelte-snpo0u"&&(E.textContent=x),T=D(ne),y=h(ne,"DIV",{class:!0,"data-tip":!0});var J=w(y);N=h(J,"BUTTON",{class:!0});var se=w(N);k=h(se,"DIV",{class:!0});var oe=w(k);b=h(oe,"SPAN",{class:!0});var de=w(b);g=fe(de,n[1]),de.forEach(p),S=D(oe),W=h(oe,"DIV",{class:!0}),w(W).forEach(p),U=D(oe),ie.l(oe),oe.forEach(p),se.forEach(p),J.forEach(p),ne.forEach(p),V.forEach(p),q=D(B),R=h(B,"DIV",{class:!0});var Ve=w(R);Z=h(Ve,"BUTTON",{class:!0});var Ue=w(Z);O.l(Ue),Ue.forEach(p),L=D(Ve),H=h(Ve,"BUTTON",{class:!0,"data-svelte-h":!0}),z(H)!=="svelte-fzd9e5"&&(H.textContent=Y),Ve.forEach(p),this.h()},h(){f(t,"class","mt-2"),f(i,"class","mt-2"),f(E,"class","mr-2"),f(b,"class","break-all flex-grow"),f(W,"class","border-l border-accent mx-2 h-4"),f(k,"class","flex items-center w-full"),f(N,"class","btn btn-sm btn-outline btn-accent text-xs mt-2 sm:mt-0"),f(y,"class","tooltip text-sm"),f(y,"data-tip",F=n[14]?"Copied!":"Click to copy"),f(I,"class","flex flex-col sm:flex-row sm:items-center mt-2"),f(e,"class","my-2 text-left"),f(Z,"class","btn btn-primary mb-2 sm:mb-0 sm:mr-2"),f(H,"class","btn btn-secondary mb-2 sm:mb-0 sm:mr-2"),f(R,"class","flex flex-col sm:flex-row sm:justify-center mt-8")},m(B,V){P(B,e,V),a(e,t),a(t,l),a(t,o),a(t,r),a(e,d),a(e,i),a(i,c),a(i,_),a(i,v),a(e,C),a(e,I),a(I,E),a(I,T),a(I,y),a(y,N),a(N,k),a(k,b),a(b,g),a(k,S),a(k,W),a(k,U),ie.m(k,null),P(B,q,V),P(B,R,V),a(R,Z),X[A].m(Z,null),a(R,L),a(R,H),j=!0,K||(ee=[G(N,"click",n[34]),G(Z,"click",n[35]),G(H,"click",n[18])],K=!0)},p(B,V){(!j||V[0]&4)&&me(r,B[2]),(!j||V[0]&16)&&me(v,B[4]),(!j||V[0]&2)&&me(g,B[1]),ue!==(ue=ae(B))&&(ie.d(1),ie=ue(B),ie&&(ie.c(),ie.m(k,null))),(!j||V[0]&16384&&F!==(F=B[14]?"Copied!":"Click to copy"))&&f(y,"data-tip",F);let $=A;A=te(B),A===$?X[A].p(B,V):(Ce(),le(X[$],1,1,()=>{X[$]=null}),ye(),O=X[A],O?O.p(B,V):(O=X[A]=re[A](B),O.c()),Q(O,1),O.m(Z,null))},i(B){j||(Q(O),j=!0)},o(B){le(O),j=!1},d(B){B&&(p(e),p(q),p(R)),ie.d(),X[A].d(),K=!1,xe(ee)}}}function Ht(n){let e,t;return{c(){e=Me("svg"),t=Me("path"),this.h()},l(l){e=De(l,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var s=w(e);t=De(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),w(t).forEach(p),s.forEach(p),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"stroke-width","2"),f(t,"d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"class","h-4 w-4"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke","currentColor")},m(l,s){P(l,e,s),a(e,t)},d(l){l&&p(e)}}}function qt(n){let e,t;return{c(){e=Me("svg"),t=Me("path"),this.h()},l(l){e=De(l,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var s=w(e);t=De(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),w(t).forEach(p),s.forEach(p),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"stroke-width","2"),f(t,"d","M5 13l4 4L19 7"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"class","h-4 w-4"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke","currentColor")},m(l,s){P(l,e,s),a(e,t)},d(l){l&&p(e)}}}function At(n){let e,t="Map Viewer";return{c(){e=m("span"),e.textContent=t},l(l){e=h(l,"SPAN",{"data-svelte-h":!0}),z(e)!=="svelte-16n78em"&&(e.textContent=t)},m(l,s){P(l,e,s)},p:pe,i:pe,o:pe,d(l){l&&p(e)}}}function Gt(n){let e,t,l;var s=n[0];function o(r,d){return{props:{src:"/animations/CoolLineMap.json",autoplay:!0,loop:!0,controls:!1,renderer:"svg",background:"transparent",height:40,width:40,controlsLayout:!1}}}return s&&(e=Te(s,o())),{c(){e&&_e(e.$$.fragment),t=ge()},l(r){e&&Ee(e.$$.fragment,r),t=ge()},m(r,d){e&&ve(e,r,d),P(r,t,d),l=!0},p(r,d){if(d[0]&1&&s!==(s=r[0])){if(e){Ce();const i=e;le(i.$$.fragment,1,0,()=>{be(i,1)}),ye()}s?(e=Te(s,o()),_e(e.$$.fragment),Q(e.$$.fragment,1),ve(e,t.parentNode,t)):e=null}},i(r){l||(e&&Q(e.$$.fragment,r),l=!0)},o(r){e&&le(e.$$.fragment,r),l=!1},d(r){r&&p(t),e&&be(e,r)}}}function tt(n){let e,t,l,s="Generate New Map",o,r,d,i,c,u,_,v,C,I="Confirm",E,x,T="Cancel",y,N;return{c(){e=m("div"),t=m("div"),l=m("h3"),l.textContent=s,o=M(),r=m("div"),d=m("h3"),i=ce(n[8]),c=M(),u=m("input"),_=M(),v=m("div"),C=m("button"),C.textContent=I,E=M(),x=m("button"),x.textContent=T,this.h()},l(k){e=h(k,"DIV",{class:!0});var b=w(e);t=h(b,"DIV",{class:!0});var g=w(t);l=h(g,"H3",{class:!0,"data-svelte-h":!0}),z(l)!=="svelte-7xzojl"&&(l.textContent=s),o=D(g),r=h(g,"DIV",{class:!0});var S=w(r);d=h(S,"H3",{class:!0});var W=w(d);i=fe(W,n[8]),W.forEach(p),S.forEach(p),c=D(g),u=h(g,"INPUT",{type:!0,placeholder:!0,class:!0}),_=D(g),v=h(g,"DIV",{class:!0});var U=w(v);C=h(U,"BUTTON",{class:!0,"data-svelte-h":!0}),z(C)!=="svelte-qvejqd"&&(C.textContent=I),E=D(U),x=h(U,"BUTTON",{class:!0,"data-svelte-h":!0}),z(x)!=="svelte-azdtti"&&(x.textContent=T),U.forEach(p),g.forEach(p),b.forEach(p),this.h()},h(){f(l,"class","font-bold text-lg text-center mb-4"),f(d,"class","font-bold text-xs badge badge-lg badge-info"),f(r,"class","flex justify-center mb-4"),f(u,"type","text"),f(u,"placeholder","Enter map name"),f(u,"class","input input-bordered w-full mb-4"),f(C,"class","btn btn-primary mb-2 sm:mb-0 sm:mr-2"),f(x,"class","btn mb-2 sm:mb-0"),f(v,"class","modal-action flex flex-col sm:flex-row sm:justify-center mb-6"),f(t,"class","modal-box px-4 py-2 w-11/12 max-w-md mx-auto"),f(e,"class","modal modal-open z-50")},m(k,b){P(k,e,b),a(e,t),a(t,l),a(t,o),a(t,r),a(r,d),a(d,i),a(t,c),a(t,u),Ie(u,n[7]),a(t,_),a(t,v),a(v,C),a(v,E),a(v,x),y||(N=[G(u,"input",n[36]),G(C,"click",n[25]),G(x,"click",n[26])],y=!0)},p(k,b){b[0]&256&&me(i,k[8]),b[0]&128&&u.value!==k[7]&&Ie(u,k[7])},d(k){k&&p(e),y=!1,xe(N)}}}function lt(n){let e,t,l,s="Confirm Map Deletion",o,r,d="Are you sure you want to permanently delete this map?",i,c,u="Please type the first 8 letters of the master map ID to confirm:",_,v,C,I=n[1].slice(0,8)+"",E,x,T=n[1].slice(8)+"",y,N,k,b,g,S,W,U,F,q,R="Cancel",Z,A;return{c(){e=m("div"),t=m("div"),l=m("h3"),l.textContent=s,o=M(),r=m("p"),r.textContent=d,i=M(),c=m("p"),c.textContent=u,_=M(),v=m("p"),C=m("span"),E=ce(I),x=m("span"),y=ce(T),N=M(),k=m("input"),b=M(),g=m("div"),S=m("button"),W=ce("Confirm Deletion"),F=M(),q=m("button"),q.textContent=R,this.h()},l(O){e=h(O,"DIV",{class:!0});var L=w(e);t=h(L,"DIV",{class:!0});var H=w(t);l=h(H,"H3",{class:!0,"data-svelte-h":!0}),z(l)!=="svelte-188pz9c"&&(l.textContent=s),o=D(H),r=h(H,"P",{class:!0,"data-svelte-h":!0}),z(r)!=="svelte-lx5nkw"&&(r.textContent=d),i=D(H),c=h(H,"P",{class:!0,"data-svelte-h":!0}),z(c)!=="svelte-cr7bpr"&&(c.textContent=u),_=D(H),v=h(H,"P",{class:!0});var Y=w(v);C=h(Y,"SPAN",{class:!0});var j=w(C);E=fe(j,I),j.forEach(p),x=h(Y,"SPAN",{});var K=w(x);y=fe(K,T),K.forEach(p),Y.forEach(p),N=D(H),k=h(H,"INPUT",{type:!0,class:!0,placeholder:!0}),b=D(H),g=h(H,"DIV",{class:!0});var ee=w(g);S=h(ee,"BUTTON",{class:!0});var ae=w(S);W=fe(ae,"Confirm Deletion"),ae.forEach(p),F=D(ee),q=h(ee,"BUTTON",{class:!0,"data-svelte-h":!0}),z(q)!=="svelte-fop7uq"&&(q.textContent=R),ee.forEach(p),H.forEach(p),L.forEach(p),this.h()},h(){f(l,"class","font-bold text-lg text-center mb-4"),f(r,"class","mb-4"),f(c,"class","mb-4"),f(C,"class","font-bold text-error"),f(v,"class","mb-4"),f(k,"type","text"),f(k,"class","input input-bordered w-full mb-4"),f(k,"placeholder","Type the first 8 letters of the map ID"),f(S,"class","btn btn-error mb-2 sm:mb-0 sm:mr-2"),S.disabled=U=n[3].toLowerCase()!==n[1].slice(0,8).toLowerCase(),f(q,"class","btn mb-2 sm:mb-0"),f(g,"class","modal-action flex flex-col sm:flex-row sm:justify-center mb-6"),f(t,"class","modal-box px-4 py-2 w-11/12 max-w-md mx-auto"),f(e,"class","modal modal-open z-100")},m(O,L){P(O,e,L),a(e,t),a(t,l),a(t,o),a(t,r),a(t,i),a(t,c),a(t,_),a(t,v),a(v,C),a(C,E),a(v,x),a(x,y),a(t,N),a(t,k),Ie(k,n[3]),a(t,b),a(t,g),a(g,S),a(S,W),a(g,F),a(g,q),Z||(A=[G(k,"input",n[37]),G(S,"click",n[22]),G(q,"click",n[23])],Z=!0)},p(O,L){L[0]&2&&I!==(I=O[1].slice(0,8)+"")&&me(E,I),L[0]&2&&T!==(T=O[1].slice(8)+"")&&me(y,T),L[0]&8&&k.value!==O[3]&&Ie(k,O[3]),L[0]&10&&U!==(U=O[3].toLowerCase()!==O[1].slice(0,8).toLowerCase())&&(S.disabled=U)},d(O){O&&p(e),Z=!1,xe(A)}}}function st(n){let e,t,l,s="Connect to Master Map",o,r,d,i='<span class="label-text">Enter Master Map ID:</span>',c,u,_,v,C,I,E,x,T,y,N,k="Cancel",b,g;function S(F,q){return F[9].length>0?Jt:Rt}let W=S(n),U=W(n);return{c(){e=m("div"),t=m("div"),l=m("h3"),l.textContent=s,o=M(),r=m("div"),d=m("label"),d.innerHTML=i,c=M(),u=m("div"),_=m("input"),v=M(),C=m("button"),I=ce("Connect"),x=M(),U.c(),T=M(),y=m("div"),N=m("button"),N.textContent=k,this.h()},l(F){e=h(F,"DIV",{class:!0});var q=w(e);t=h(q,"DIV",{class:!0});var R=w(t);l=h(R,"H3",{class:!0,"data-svelte-h":!0}),z(l)!=="svelte-z1ktt7"&&(l.textContent=s),o=D(R),r=h(R,"DIV",{class:!0});var Z=w(r);d=h(Z,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),z(d)!=="svelte-jktoli"&&(d.innerHTML=i),c=D(Z),u=h(Z,"DIV",{class:!0});var A=w(u);_=h(A,"INPUT",{type:!0,id:!0,placeholder:!0,class:!0}),v=D(A),C=h(A,"BUTTON",{class:!0});var O=w(C);I=fe(O,"Connect"),O.forEach(p),A.forEach(p),Z.forEach(p),x=D(R),U.l(R),T=D(R),y=h(R,"DIV",{class:!0});var L=w(y);N=h(L,"BUTTON",{class:!0,"data-svelte-h":!0}),z(N)!=="svelte-1o3cmbf"&&(N.textContent=k),L.forEach(p),R.forEach(p),q.forEach(p),this.h()},h(){f(l,"class","font-bold text-lg text-center mb-4"),f(d,"class","label"),f(d,"for","enteredMapId"),f(_,"type","text"),f(_,"id","enteredMapId"),f(_,"placeholder","Master Map ID"),f(_,"class","input input-bordered w-full pr-16"),f(C,"class","btn btn-primary absolute top-0 right-0 rounded-l-none"),C.disabled=E=!n[11],ke(C,"btn-success",n[11]),f(u,"class","relative"),f(r,"class","form-control mb-4"),f(N,"class","btn mb-2 sm:mb-0"),f(y,"class","modal-action flex flex-col sm:flex-row sm:justify-center mb-6"),f(t,"class","modal-box px-4 py-2 w-11/12 max-w-md mx-auto"),f(e,"class","modal modal-open")},m(F,q){P(F,e,q),a(e,t),a(t,l),a(t,o),a(t,r),a(r,d),a(r,c),a(r,u),a(u,_),Ie(_,n[10]),a(u,v),a(u,C),a(C,I),a(t,x),U.m(t,null),a(t,T),a(t,y),a(y,N),b||(g=[G(_,"input",n[38]),G(_,"input",n[30]),G(C,"click",n[39]),G(N,"click",n[29])],b=!0)},p(F,q){q[0]&1024&&_.value!==F[10]&&Ie(_,F[10]),q[0]&2048&&E!==(E=!F[11])&&(C.disabled=E),q[0]&2048&&ke(C,"btn-success",F[11]),W===(W=S(F))&&U?U.p(F,q):(U.d(1),U=W(F),U&&(U.c(),U.m(t,T)))},d(F){F&&p(e),U.d(),b=!1,xe(g)}}}function Rt(n){let e,t="No master maps found.";return{c(){e=m("p"),e.textContent=t,this.h()},l(l){e=h(l,"P",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-1tj0rqn"&&(e.textContent=t),this.h()},h(){f(e,"class","mb-4")},m(l,s){P(l,e,s)},p:pe,d(l){l&&p(e)}}}function Jt(n){let e,t=je(n[9]),l=[];for(let s=0;s<t.length;s+=1)l[s]=rt(et(n,t,s));return{c(){e=m("ul");for(let s=0;s<l.length;s+=1)l[s].c();this.h()},l(s){e=h(s,"UL",{class:!0});var o=w(e);for(let r=0;r<l.length;r+=1)l[r].l(o);o.forEach(p),this.h()},h(){f(e,"class","menu bg-base-100 w-full p-2 rounded-box mb-4")},m(s,o){P(s,e,o);for(let r=0;r<l.length;r+=1)l[r]&&l[r].m(e,null)},p(s,o){if(o[0]&268435968){t=je(s[9]);let r;for(r=0;r<t.length;r+=1){const d=et(s,t,r);l[r]?l[r].p(d,o):(l[r]=rt(d),l[r].c(),l[r].m(e,null))}for(;r<l.length;r+=1)l[r].d(1);l.length=t.length}},d(s){s&&p(e),ot(l,s)}}}function rt(n){let e,t,l,s,o,r=n[48].map_name+"",d,i,c,u="Connect",_,v,C;function I(){return n[40](n[48])}function E(){return n[41](n[48])}return{c(){e=m("li"),t=m("label"),l=m("input"),s=M(),o=m("span"),d=ce(r),i=M(),c=m("button"),c.textContent=u,_=M(),this.h()},l(x){e=h(x,"LI",{});var T=w(e);t=h(T,"LABEL",{class:!0});var y=w(t);l=h(y,"INPUT",{type:!0,name:!0,class:!0}),s=D(y),o=h(y,"SPAN",{class:!0});var N=w(o);d=fe(N,r),N.forEach(p),i=D(y),c=h(y,"BUTTON",{class:!0,"data-svelte-h":!0}),z(c)!=="svelte-1dwviq2"&&(c.textContent=u),y.forEach(p),_=D(T),T.forEach(p),this.h()},h(){f(l,"type","radio"),f(l,"name","map-selection"),f(l,"class","hidden"),f(o,"class","text-center flex-grow"),f(c,"class","btn btn-sm btn-primary ml-4"),f(t,"class","flex items-center justify-between cursor-pointer")},m(x,T){P(x,e,T),a(e,t),a(t,l),a(t,s),a(t,o),a(o,d),a(t,i),a(t,c),a(e,_),v||(C=[G(l,"change",I),G(c,"click",E)],v=!0)},p(x,T){n=x,T[0]&512&&r!==(r=n[48].map_name+"")&&me(d,r)},d(x){x&&p(e),v=!1,xe(C)}}}function nt(n){let e,t,l,s="Map Settings",o,r,d,i,c="Close",u,_;function v(E,x){return E[1]?Kt:Zt}let C=v(n),I=C(n);return{c(){e=m("div"),t=m("div"),l=m("h3"),l.textContent=s,o=M(),I.c(),r=M(),d=m("div"),i=m("button"),i.textContent=c,this.h()},l(E){e=h(E,"DIV",{class:!0});var x=w(e);t=h(x,"DIV",{class:!0});var T=w(t);l=h(T,"H3",{class:!0,"data-svelte-h":!0}),z(l)!=="svelte-1ypsjn9"&&(l.textContent=s),o=D(T),I.l(T),r=D(T),d=h(T,"DIV",{class:!0});var y=w(d);i=h(y,"BUTTON",{class:!0,"data-svelte-h":!0}),z(i)!=="svelte-1ldhwp1"&&(i.textContent=c),y.forEach(p),T.forEach(p),x.forEach(p),this.h()},h(){f(l,"class","font-bold text-lg text-center mb-4"),f(i,"class","btn mb-2 sm:mb-0"),f(d,"class","modal-action flex flex-col flex-row justify-center mt-6"),f(t,"class","modal-box px-4 py-2 w-11/12 max-w-md mx-auto"),f(e,"class","modal modal-open z-10")},m(E,x){P(E,e,x),a(e,t),a(t,l),a(t,o),I.m(t,null),a(t,r),a(t,d),a(d,i),u||(_=G(i,"click",n[19]),u=!0)},p(E,x){C===(C=v(E))&&I?I.p(E,x):(I.d(1),I=C(E),I&&(I.c(),I.m(t,r)))},d(E){E&&p(e),I.d(),u=!1,_()}}}function Zt(n){let e,t,l=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M10 3a1 1 0 011 1v5h5a1 1 0 110 2h-5v5a1 1 0 11-2 0v-5H4a1 1 0 110-2h5V4a1 1 0 011-1z" clip-rule="evenodd"></path></svg>
            New Map`,s,o,r=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M12 1.586l-4 4v12.828l4-4V1.586zM3.707 3.293A1 1 0 002 4v10a1 1 0 00.293.707L6 18.414V5.586L3.707 3.293zM17.707 5.293L14 1.586v12.828l2.293 2.293A1 1 0 0018 16V6a1 1 0 00-.293-.707z" clip-rule="evenodd"></path></svg>
            Connect`,d,i;return{c(){e=m("div"),t=m("button"),t.innerHTML=l,s=M(),o=m("button"),o.innerHTML=r,this.h()},l(c){e=h(c,"DIV",{class:!0});var u=w(e);t=h(u,"BUTTON",{class:!0,"data-svelte-h":!0}),z(t)!=="svelte-1r0ntrb"&&(t.innerHTML=l),s=D(u),o=h(u,"BUTTON",{class:!0,"data-svelte-h":!0}),z(o)!=="svelte-1lfzg2w"&&(o.innerHTML=r),u.forEach(p),this.h()},h(){f(t,"class","btn btn-primary"),f(o,"class","btn btn-secondary"),f(e,"class","flex flex-col sm:flex-row sm:justify-center space-y-4 sm:space-y-0 sm:space-x-4")},m(c,u){P(c,e,u),a(e,t),a(e,s),a(e,o),d||(i=[G(t,"click",n[24]),G(o,"click",n[27])],d=!0)},p:pe,d(c){c&&p(e),d=!1,xe(i)}}}function Kt(n){let e,t,l,s="Selected Map:",o,r,d,i,c,u,_="Owner:",v,C,I,E,x,T,y,N,k,b,g,S,W,U,F,q,R;function Z(j,K){return j[14]?Wt:Xt}let A=Z(n),O=A(n);function L(j,K){return j[16]?Qt:Yt}let H=L(n),Y=H(n);return{c(){e=m("div"),t=m("div"),l=m("span"),l.textContent=s,o=M(),r=ce(n[2]),d=M(),i=m("div"),c=m("p"),u=m("strong"),u.textContent=_,v=M(),C=ce(n[4]),I=M(),E=m("div"),x=m("div"),T=m("button"),y=m("div"),N=m("span"),k=ce(n[1]),b=M(),g=m("div"),S=M(),O.c(),U=M(),F=m("div"),Y.c(),this.h()},l(j){e=h(j,"DIV",{class:!0});var K=w(e);t=h(K,"DIV",{});var ee=w(t);l=h(ee,"SPAN",{class:!0,"data-svelte-h":!0}),z(l)!=="svelte-1gs61n7"&&(l.textContent=s),o=D(ee),r=fe(ee,n[2]),ee.forEach(p),d=D(K),i=h(K,"DIV",{class:!0});var ae=w(i);c=h(ae,"P",{class:!0});var ue=w(c);u=h(ue,"STRONG",{"data-svelte-h":!0}),z(u)!=="svelte-q5vggv"&&(u.textContent=_),v=D(ue),C=fe(ue,n[4]),ue.forEach(p),I=D(ae),E=h(ae,"DIV",{class:!0});var ie=w(E);x=h(ie,"DIV",{class:!0,"data-tip":!0});var re=w(x);T=h(re,"BUTTON",{class:!0});var X=w(T);y=h(X,"DIV",{class:!0});var te=w(y);N=h(te,"SPAN",{class:!0});var B=w(N);k=fe(B,n[1]),B.forEach(p),b=D(te),g=h(te,"DIV",{class:!0}),w(g).forEach(p),S=D(te),O.l(te),te.forEach(p),X.forEach(p),re.forEach(p),ie.forEach(p),ae.forEach(p),K.forEach(p),U=D(j),F=h(j,"DIV",{class:!0});var V=w(F);Y.l(V),V.forEach(p),this.h()},h(){f(l,"class","font-bold"),f(c,"class","mt-2"),f(N,"class","break-all flex-grow"),f(g,"class","border-l border-accent mx-2 h-4"),f(y,"class","flex items-center w-full"),f(T,"class","btn btn-sm btn-outline btn-accent text-xs mt-2 sm:mt-0"),f(x,"class","tooltip text-sm"),f(x,"data-tip",W=n[14]?"Copied!":"Click to copy"),f(E,"class","flex flex-col sm:flex-row sm:items-center mt-2"),f(i,"class","my-2 text-left"),f(e,"class","bg-info border border-blue-500 rounded-lg p-4 mb-4"),f(F,"class","flex flex-col space-y-4")},m(j,K){P(j,e,K),a(e,t),a(t,l),a(t,o),a(t,r),a(e,d),a(e,i),a(i,c),a(c,u),a(c,v),a(c,C),a(i,I),a(i,E),a(E,x),a(x,T),a(T,y),a(y,N),a(N,k),a(y,b),a(y,g),a(y,S),O.m(y,null),P(j,U,K),P(j,F,K),Y.m(F,null),q||(R=G(T,"click",n[42]),q=!0)},p(j,K){K[0]&4&&me(r,j[2]),K[0]&16&&me(C,j[4]),K[0]&2&&me(k,j[1]),A!==(A=Z(j))&&(O.d(1),O=A(j),O&&(O.c(),O.m(y,null))),K[0]&16384&&W!==(W=j[14]?"Copied!":"Click to copy")&&f(x,"data-tip",W),H===(H=L(j))&&Y?Y.p(j,K):(Y.d(1),Y=H(j),Y&&(Y.c(),Y.m(F,null)))},d(j){j&&(p(e),p(U),p(F)),O.d(),Y.d(),q=!1,R()}}}function Xt(n){let e,t;return{c(){e=Me("svg"),t=Me("path"),this.h()},l(l){e=De(l,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var s=w(e);t=De(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),w(t).forEach(p),s.forEach(p),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"stroke-width","2"),f(t,"d","M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"class","h-4 w-4"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke","currentColor")},m(l,s){P(l,e,s),a(e,t)},d(l){l&&p(e)}}}function Wt(n){let e,t;return{c(){e=Me("svg"),t=Me("path"),this.h()},l(l){e=De(l,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var s=w(e);t=De(s,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),w(t).forEach(p),s.forEach(p),this.h()},h(){f(t,"stroke-linecap","round"),f(t,"stroke-linejoin","round"),f(t,"stroke-width","2"),f(t,"d","M5 13l4 4L19 7"),f(e,"xmlns","http://www.w3.org/2000/svg"),f(e,"class","h-4 w-4"),f(e,"fill","none"),f(e,"viewBox","0 0 24 24"),f(e,"stroke","currentColor")},m(l,s){P(l,e,s),a(e,t)},d(l){l&&p(e)}}}function Yt(n){let e,t=`<svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" viewBox="0 0 20 20" fill="currentColor"><path d="M13.586 3.586a2 2 0 112.828 2.828l-.793.793-2.828-2.828.793-.793zM11.379 5.793L3 14.172V17h2.828l8.38-8.379-2.83-2.828z"></path></svg>
              Rename`,l,s,o,r=`<svg fill="#000000" width="20px" height="20px" viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" class="icon"><path d="M832.6 191.4c-84.6-84.6-221.5-84.6-306 0l-96.9 96.9 51 51 96.9-96.9c53.8-53.8 144.6-59.5 204 0 59.5 59.5 53.8 150.2 0 204l-96.9 96.9 51.1 51.1 96.9-96.9c84.4-84.6 84.4-221.5-.1-306.1zM446.5 781.6c-53.8 53.8-144.6 59.5-204 0-59.5-59.5-53.8-150.2 0-204l96.9-96.9-51.1-51.1-96.9 96.9c-84.6 84.6-84.6 221.5 0 306s221.5 84.6 306 0l96.9-96.9-51-51-96.8 97zM260.3 209.4a8.03 8.03 0 0 0-11.3 0L209.4 249a8.03 8.03 0 0 0 0 11.3l554.4 554.4c3.1 3.1 8.2 3.1 11.3 0l39.6-39.6c3.1-3.1 3.1-8.2 0-11.3L260.3 209.4z"></path></svg>
                Disconnect`,d,i,c,u,_,v,C;return{c(){e=m("button"),e.innerHTML=t,l=M(),s=m("div"),o=m("button"),o.innerHTML=r,d=M(),i=m("button"),c=m("i"),u=ce(`\r
                Delete`),this.h()},l(I){e=h(I,"BUTTON",{class:!0,"data-svelte-h":!0}),z(e)!=="svelte-6lw8t"&&(e.innerHTML=t),l=D(I),s=h(I,"DIV",{class:!0});var E=w(s);o=h(E,"BUTTON",{class:!0,"data-svelte-h":!0}),z(o)!=="svelte-1iix2gd"&&(o.innerHTML=r),d=D(E),i=h(E,"BUTTON",{class:!0});var x=w(i);c=h(x,"I",{class:!0}),w(c).forEach(p),u=fe(x,`\r
                Delete`),x.forEach(p),E.forEach(p),this.h()},h(){f(e,"class","btn btn-info"),f(o,"class","btn btn-warning w-1/2 text-xs"),f(c,"class","at-trash mr-2"),f(i,"class","btn btn-error w-1/2 text-xs"),i.disabled=_=!n[12],ke(i,"btn-disabled",!n[12]),f(s,"class","flex space-x-2")},m(I,E){P(I,e,E),P(I,l,E),P(I,s,E),a(s,o),a(s,d),a(s,i),a(i,c),a(i,u),v||(C=[G(e,"click",n[31]),G(o,"click",n[20]),G(i,"click",n[21])],v=!0)},p(I,E){E[0]&4096&&_!==(_=!I[12])&&(i.disabled=_),E[0]&4096&&ke(i,"btn-disabled",!I[12])},d(I){I&&(p(e),p(l),p(s)),v=!1,xe(C)}}}function Qt(n){let e,t,l,s,o,r="Save",d,i,c="Cancel",u,_;return{c(){e=m("div"),t=m("input"),l=M(),s=m("div"),o=m("button"),o.textContent=r,d=M(),i=m("button"),i.textContent=c,this.h()},l(v){e=h(v,"DIV",{class:!0});var C=w(e);t=h(C,"INPUT",{type:!0,class:!0}),l=D(C),s=h(C,"DIV",{class:!0});var I=w(s);o=h(I,"BUTTON",{class:!0,"data-svelte-h":!0}),z(o)!=="svelte-1me9n3c"&&(o.textContent=r),d=D(I),i=h(I,"BUTTON",{class:!0,"data-svelte-h":!0}),z(i)!=="svelte-fisrd8"&&(i.textContent=c),I.forEach(p),C.forEach(p),this.h()},h(){f(t,"type","text"),f(t,"class","input input-bordered w-full"),f(o,"class","btn btn-success w-1/2"),f(i,"class","btn btn-error w-1/2"),f(s,"class","flex space-x-2"),f(e,"class","flex flex-col space-y-2")},m(v,C){P(v,e,C),a(e,t),Ie(t,n[17]),a(e,l),a(e,s),a(s,o),a(s,d),a(s,i),u||(_=[G(t,"input",n[43]),G(o,"click",n[32]),G(i,"click",n[33])],u=!0)},p(v,C){C[0]&131072&&t.value!==v[17]&&Ie(t,v[17])},d(v){v&&p(e),u=!1,xe(_)}}}function $t(n){let e,t,l,s="Selected Map",o,r,d,i,c,u,_,v,C;const I=[zt,St],E=[];function x(b,g){return b[1]?0:1}r=x(n),d=E[r]=I[r](n);let T=n[5]&&tt(n),y=n[13]&&lt(n),N=n[6]&&st(n),k=n[15]&&nt(n);return{c(){e=m("div"),t=m("div"),l=m("div"),l.textContent=s,o=M(),d.c(),i=M(),T&&T.c(),c=M(),y&&y.c(),u=M(),N&&N.c(),_=M(),k&&k.c(),v=ge(),this.h()},l(b){e=h(b,"DIV",{class:!0});var g=w(e);t=h(g,"DIV",{class:!0});var S=w(t);l=h(S,"DIV",{class:!0,"data-svelte-h":!0}),z(l)!=="svelte-1aage3m"&&(l.textContent=s),o=D(S),d.l(S),S.forEach(p),g.forEach(p),i=D(b),T&&T.l(b),c=D(b),y&&y.l(b),u=D(b),N&&N.l(b),_=D(b),k&&k.l(b),v=ge(),this.h()},h(){f(l,"class","font-bold text-center mb-4"),f(t,"class","px-4 py-2"),f(e,"class","alert alert-info w-full mt-2")},m(b,g){P(b,e,g),a(e,t),a(t,l),a(t,o),E[r].m(t,null),P(b,i,g),T&&T.m(b,g),P(b,c,g),y&&y.m(b,g),P(b,u,g),N&&N.m(b,g),P(b,_,g),k&&k.m(b,g),P(b,v,g),C=!0},p(b,g){let S=r;r=x(b),r===S?E[r].p(b,g):(Ce(),le(E[S],1,1,()=>{E[S]=null}),ye(),d=E[r],d?d.p(b,g):(d=E[r]=I[r](b),d.c()),Q(d,1),d.m(t,null)),b[5]?T?T.p(b,g):(T=tt(b),T.c(),T.m(c.parentNode,c)):T&&(T.d(1),T=null),b[13]?y?y.p(b,g):(y=lt(b),y.c(),y.m(u.parentNode,u)):y&&(y.d(1),y=null),b[6]?N?N.p(b,g):(N=st(b),N.c(),N.m(_.parentNode,_)):N&&(N.d(1),N=null),b[15]?k?k.p(b,g):(k=nt(b),k.c(),k.m(v.parentNode,v)):k&&(k.d(1),k=null)},i(b){C||(Q(d),C=!0)},o(b){le(d),C=!1},d(b){b&&(p(e),p(i),p(c),p(u),p(_),p(v)),E[r].d(),T&&T.d(b),y&&y.d(b),N&&N.d(b),k&&k.d(b)}}}function el(n,e,t){let l;Be(n,He,J=>t(44,l=J));let s,o="",r="",d="",i="",c=!1,u=!1,_="",v="",C=[],I="",E=!1,x=!1,T=!1,y=!1,N=!1;function k(){t(15,N=!0)}function b(){t(15,N=!1)}async function g(){const J=l.data.session;if(!J){console.error("User not authenticated");return}const{data:se,error:oe}=await he.from("profiles").select("master_map_id").eq("id",J.user.id).single();if(oe){console.error("Error retrieving user profile:",oe);return}if(t(1,o=se.master_map_id),o){const{data:de,error:Ve}=await he.from("master_maps").select("map_name, master_user_id").eq("id",o).single();if(Ve){console.error("Error retrieving master map details:",Ve);return}t(2,r=de.map_name);const{data:Ue,error:qe}=await he.from("profiles").select("full_name, company_name").eq("id",de.master_user_id).single();if(qe){console.error("Error retrieving master map owner details:",qe);return}t(4,i=`${Ue.full_name} (${Ue.company_name})`),t(12,x=de.master_user_id===J.user.id)}}async function S(){const J=l.data.session;if(!J){console.error("User not authenticated");return}const{error:se}=await he.from("profiles").update({master_map_id:null}).eq("id",J.user.id);if(se){console.error("Error disconnecting from master map:",se);return}t(1,o=""),t(2,r=""),t(4,i=""),t(12,x=!1)}function W(){t(13,T=!0)}async function U(){if(!l.data.session){console.error("User not authenticated");return}const{error:se}=await he.from("profiles").update({master_map_id:null}).eq("master_map_id",o);if(se){console.error("Error updating profiles:",se);return}const{error:oe}=await he.from("master_maps").delete().eq("id",o);if(oe){console.error("Error deleting master map:",oe);return}await S(),t(13,T=!1)}function F(){t(13,T=!1)}function q(){t(8,v=pt()),t(7,_=""),t(5,c=!0)}async function R(){const J=l.data.session;if(!J){console.error("User not authenticated");return}const{data:se,error:oe}=await he.from("master_maps").insert({id:v,master_user_id:J.user.id,map_name:_}).single();if(oe){console.error("Error generating master map:",oe);return}const{error:de}=await he.from("profiles").update({master_map_id:v}).eq("id",J.user.id);if(de){console.error("Error updating user profile:",de);return}t(1,o=v),t(2,r=_),t(4,i=`${J.user.email}`),t(5,c=!1)}function Z(){t(5,c=!1)}async function A(){const J=l.data.session;if(!J){console.error("User not authenticated");return}const{data:se,error:oe}=await he.from("master_maps").select("id, map_name").eq("master_user_id",J.user.id);if(oe){console.error("Error fetching user maps:",oe);return}t(9,C=se),t(6,u=!0)}async function O(J){const se=l.data.session;if(!se){console.error("User not authenticated");return}const{error:oe}=await he.from("profiles").update({master_map_id:J}).eq("id",se.user.id);if(oe){console.error("Error updating user profile:",oe);return}await g(),t(6,u=!1)}function L(){t(6,u=!1)}async function H(){const{data:J,error:se}=await he.from("master_maps").select("id").eq("id",I).single();t(11,E=!se&&J!==null)}let Y=!1,j="";function K(){t(16,Y=!0),t(17,j=r)}async function ee(){if(!l.data.session){console.error("User not authenticated");return}const{error:se}=await he.from("master_maps").update({map_name:j}).eq("id",o);if(se){console.error("Error renaming master map:",se);return}t(2,r=j),t(16,Y=!1)}function ae(){t(16,Y=!1)}Fe(async()=>{{const J=await at(()=>import("../chunks/index.9bcd1db9.js"),["..\\chunks\\index.9bcd1db9.js","..\\chunks\\scheduler.ccf898a6.js","..\\chunks\\index.7272c3b3.js","..\\chunks\\lottie.c94986b4.js","..\\chunks\\_commonjsHelpers.de833af9.js","..\\chunks\\each.34974530.js","..\\assets\\index.798bbb7e.css"],import.meta.url);t(0,s=J.LottiePlayer)}await g()});const ue=()=>{navigator.clipboard.writeText(o),t(14,y=!0),setTimeout(()=>t(14,y=!1),2e3)},ie=()=>{window.location.href="/account/mapviewer"};function re(){_=this.value,t(7,_)}function X(){d=this.value,t(3,d)}function te(){I=this.value,t(10,I)}const B=()=>O(I),V=J=>O(J.id),$=J=>O(J.id),we=()=>{navigator.clipboard.writeText(o),t(14,y=!0),setTimeout(()=>t(14,y=!1),2e3)};function ne(){j=this.value,t(17,j)}return[s,o,r,d,i,c,u,_,v,C,I,E,x,T,y,N,Y,j,k,b,S,W,U,F,q,R,Z,A,O,L,H,K,ee,ae,ue,ie,re,X,te,B,V,$,we,ne]}class tl extends Pe{constructor(e){super(),Le(this,e,el,$t,Ne,{},null,[-1,-1])}}function ll(n){let e,t,l,s,o,r,d,i,c,u,_,v,C="Upload Paddock Boundaries",I,E,x,T,y,N,k,b,g,S="User Files",W,U,F,q,R,Z,A,O;return s=new tl({}),x=new Tt({}),x.$on("validFile",n[2]),x.$on("invalidFile",sl),F=new Nt({}),F.$on("fetchUploadedFiles",n[0]),F.$on("deleteFile",n[1]),A=new Bt({}),{c(){e=M(),t=m("div"),l=m("div"),_e(s.$$.fragment),o=M(),r=m("div"),d=m("div"),i=m("img"),u=M(),_=m("div"),v=m("div"),v.textContent=C,I=M(),E=m("div"),_e(x.$$.fragment),T=M(),y=m("div"),N=M(),k=m("div"),b=m("div"),g=m("div"),g.textContent=S,W=M(),U=m("div"),_e(F.$$.fragment),q=M(),R=m("div"),Z=M(),_e(A.$$.fragment),this.h()},l(L){it("svelte-hq06ji",document.head).forEach(p),e=D(L),t=h(L,"DIV",{class:!0});var Y=w(t);l=h(Y,"DIV",{class:!0});var j=w(l);Ee(s.$$.fragment,j),j.forEach(p),o=D(Y),r=h(Y,"DIV",{class:!0});var K=w(r);d=h(K,"DIV",{class:!0});var ee=w(d);i=h(ee,"IMG",{src:!0,alt:!0,class:!0}),u=D(ee),_=h(ee,"DIV",{});var ae=w(_);v=h(ae,"DIV",{class:!0,"data-svelte-h":!0}),z(v)!=="svelte-1cir21x"&&(v.textContent=C),I=D(ae),E=h(ae,"DIV",{class:!0});var ue=w(E);Ee(x.$$.fragment,ue),ue.forEach(p),T=D(ae),y=h(ae,"DIV",{class:!0}),w(y).forEach(p),ae.forEach(p),ee.forEach(p),N=D(K),k=h(K,"DIV",{class:!0});var ie=w(k);b=h(ie,"DIV",{});var re=w(b);g=h(re,"DIV",{class:!0,"data-svelte-h":!0}),z(g)!=="svelte-11l4quw"&&(g.textContent=S),W=D(re),U=h(re,"DIV",{class:!0});var X=w(U);Ee(F.$$.fragment,X),X.forEach(p),q=D(re),R=h(re,"DIV",{class:!0}),w(R).forEach(p),re.forEach(p),ie.forEach(p),K.forEach(p),Y.forEach(p),Z=D(L),Ee(A.$$.fragment,L),this.h()},h(){document.title="Account",f(l,"class","lg:w-1/2"),ct(i.src,c="/images/file-upload-icon.svg")||f(i,"src",c),f(i,"alt","Gear"),f(i,"class","w-14 h-14"),f(v,"class","font-bold"),f(E,"class","my-2"),f(y,"class","my-2"),f(d,"class","alert alert-success w-full mt-2"),f(g,"class","font-bold"),f(U,"class","my-2"),f(R,"class","my-2"),f(k,"class","alert alert-success w-full mt-2"),f(r,"class","lg:w-1/2"),f(t,"class","flex flex-col lg:flex-row lg:space-x-4")},m(L,H){P(L,e,H),P(L,t,H),a(t,l),ve(s,l,null),a(t,o),a(t,r),a(r,d),a(d,i),a(d,u),a(d,_),a(_,v),a(_,I),a(_,E),ve(x,E,null),a(_,T),a(_,y),a(r,N),a(r,k),a(k,b),a(b,g),a(b,W),a(b,U),ve(F,U,null),a(b,q),a(b,R),P(L,Z,H),ve(A,L,H),O=!0},p:pe,i(L){O||(Q(s.$$.fragment,L),Q(x.$$.fragment,L),Q(F.$$.fragment,L),Q(A.$$.fragment,L),O=!0)},o(L){le(s.$$.fragment,L),le(x.$$.fragment,L),le(F.$$.fragment,L),le(A.$$.fragment,L),O=!1},d(L){L&&(p(e),p(t),p(Z)),be(s),be(x),be(F),be(A,L)}}}function sl(n){const e=n.detail.file;console.error("Invalid file:",e.name)}function rl(n,e,t){let l;Be(n,He,i=>t(3,l=i)),ft("adminSection").set("home");async function o(){try{const i=await fetch("/account/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"fetchUploadedFiles"})});if(i.ok){const{files:c}=await i.json();Oe.set(c)}else console.error("Error fetching uploaded files")}catch{console.error("Error fetching uploaded files")}}console.log("Account Parent component mounted");async function r(i){console.log("deleteFile event received with file:",i.detail.file);const c=i.detail.file;try{console.log("Sending delete request for file:",c);const u=await fetch("/account/api",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({action:"deleteFile",fileName:c})});if(console.log("Delete request response:",u.status,u.statusText),!u.ok){const _=await u.text();throw console.error("Error response:",_),new Error(`HTTP error! status: ${u.status}`)}console.log("File deleted successfully:",c),Oe.update(_=>_.filter(v=>v!==c))}catch(u){console.error(`Error deleting file ${c}:`,u.message)}}async function d(i){const c=i.detail.file;try{const u=new FormData;u.append("file",c),(await fetch("/account/api",{method:"POST",body:u})).ok?Oe.update(v=>[...v,c.name]):console.error("Error uploading file")}catch{console.error("Error uploading file")}}return Fe(()=>{console.log("Parent component mounted with session:",l.data.session),o()}),[o,r,d]}class ml extends Pe{constructor(e){super(),Le(this,e,rl,ll,Ne,{})}}export{ml as component};

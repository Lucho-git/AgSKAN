import{s as we,n as de,d as b,q as F,i as R,a,A as xe,b as p,c as g,e as x,g as B,f as A,h as H,j as v,k as I,t as j,l as De,$ as Ee,G as ke,L as Se}from"../chunks/scheduler.BVGjjnGO.js";import{e as ue}from"../chunks/each.Ddz8tcEt.js";import{S as Le,i as Te}from"../chunks/index.Vv2yv23T.js";import{s as te}from"../chunks/supabaseClient.CPicN285.js";import{i as ye,a as Ae,p as Ie}from"../chunks/entry.DlOh58KF.js";import{p as Ce}from"../chunks/stores.CPPq2u7A.js";function Ve(r){const t=JSON.parse(r);return t.data&&(t.data=Ie(t.data)),t}function fe(r){return HTMLElement.prototype.cloneNode.call(r)}function Me(r,t=()=>{}){const e=async({action:s,result:l,reset:n=!0,invalidateAll:i=!0})=>{l.type==="success"&&(n&&HTMLFormElement.prototype.reset.call(r),i&&await ye()),(location.origin+location.pathname===s.origin+s.pathname||l.type==="redirect"||l.type==="error")&&Ae(l)};async function d(s){if((s.submitter?.hasAttribute("formmethod")?s.submitter.formMethod:fe(r).method)!=="post")return;s.preventDefault();const n=new URL(s.submitter?.hasAttribute("formaction")?s.submitter.formAction:fe(r).action),i=new FormData(r),o=s.submitter?.getAttribute("name");o&&i.append(o,s.submitter?.getAttribute("value")??"");const c=new AbortController;let m=!1;const f=await t({action:n,cancel:()=>m=!0,controller:c,formData:i,formElement:r,submitter:s.submitter})??e;if(m)return;let y;try{const L=await fetch(n,{method:"POST",headers:{accept:"application/json","x-sveltekit-action":"true"},cache:"no-store",body:i,signal:c.signal});y=Ve(await L.text()),y.type==="error"&&(y.status=L.status)}catch(L){if(L?.name==="AbortError")return;y={type:"error",error:L}}f({action:n,formData:i,formElement:r,update:L=>e({action:n,result:y,reset:L?.reset,invalidateAll:L?.invalidateAll}),result:y})}return HTMLFormElement.prototype.addEventListener.call(r,"submit",d),{destroy(){HTMLFormElement.prototype.removeEventListener.call(r,"submit",d)}}}const Oe=!1,Ue=Object.freeze(Object.defineProperty({__proto__:null,prerender:Oe},Symbol.toStringTag,{value:"Module"}));function me(r,t,e){const d=r.slice();return d[9]=t[e],d}function pe(r){let t,e,d;return{c(){t=v("div"),e=v("span"),d=j(r[3]),this.h()},l(s){t=g(s,"DIV",{class:!0,role:!0});var l=x(t);e=g(l,"SPAN",{class:!0});var n=x(e);d=H(n,r[3]),n.forEach(b),l.forEach(b),this.h()},h(){p(e,"class","block sm:inline"),p(t,"class","relative rounded border border-red-400 bg-red-100 px-4 py-3 text-red-700"),p(t,"role","alert")},m(s,l){R(s,t,l),a(t,e),a(e,d)},p(s,l){l&8&&F(d,s[3])},d(s){s&&b(t)}}}function he(r){let t,e,d=r[2]?"Loading...":"Logout",s,l,n,i;return{c(){t=v("form"),e=v("button"),s=j(d),this.h()},l(o){t=g(o,"FORM",{method:!0,action:!0});var c=x(t);e=g(c,"BUTTON",{type:!0,class:!0});var m=x(e);s=H(m,d),m.forEach(b),c.forEach(b),this.h()},h(){p(e,"type","submit"),e.disabled=r[2],p(e,"class","flex w-full justify-center rounded-md border border-transparent bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50"),p(t,"method","POST"),p(t,"action","?/logout")},m(o,c){R(o,t,c),a(t,e),a(e,s),n||(i=Ee(l=Me.call(null,t,r[7])),n=!0)},p(o,c){c&4&&d!==(d=o[2]?"Loading...":"Logout")&&F(s,d),c&4&&(e.disabled=o[2]),l&&Se(l.update)&&c&12&&l.update.call(null,o[7])},d(o){o&&b(t),n=!1,i()}}}function ge(r){let t,e,d='<h3 class="text-lg font-medium leading-6 text-gray-900">Active Session Found</h3>',s,l,n,i,o,c="User ID",m,u,f=r[0].id+"",y,L,C,V,S="Email",_,h,D=r[0].email+"",E,w,k,T,N="Provider",U,z,J=r[0].provider+"",Z,se,P,q,le="Expires At",oe,G,K=new Date(r[0].expiresAt*1e3).toLocaleString()+"",$;return{c(){t=v("div"),e=v("div"),e.innerHTML=d,s=I(),l=v("div"),n=v("dl"),i=v("div"),o=v("dt"),o.textContent=c,m=I(),u=v("dd"),y=j(f),L=I(),C=v("div"),V=v("dt"),V.textContent=S,_=I(),h=v("dd"),E=j(D),w=I(),k=v("div"),T=v("dt"),T.textContent=N,U=I(),z=v("dd"),Z=j(J),se=I(),P=v("div"),q=v("dt"),q.textContent=le,oe=I(),G=v("dd"),$=j(K),this.h()},l(O){t=g(O,"DIV",{class:!0});var M=x(t);e=g(M,"DIV",{class:!0,"data-svelte-h":!0}),B(e)!=="svelte-m18uka"&&(e.innerHTML=d),s=A(M),l=g(M,"DIV",{class:!0});var ae=x(l);n=g(ae,"DL",{});var Q=x(n);i=g(Q,"DIV",{class:!0});var W=x(i);o=g(W,"DT",{class:!0,"data-svelte-h":!0}),B(o)!=="svelte-11k5p0n"&&(o.textContent=c),m=A(W),u=g(W,"DD",{class:!0});var re=x(u);y=H(re,f),re.forEach(b),L=A(W),W.forEach(b),C=g(Q,"DIV",{class:!0});var X=x(C);V=g(X,"DT",{class:!0,"data-svelte-h":!0}),B(V)!=="svelte-qj6i1v"&&(V.textContent=S),_=A(X),h=g(X,"DD",{class:!0});var ne=x(h);E=H(ne,D),ne.forEach(b),w=A(X),X.forEach(b),k=g(Q,"DIV",{class:!0});var Y=x(k);T=g(Y,"DT",{class:!0,"data-svelte-h":!0}),B(T)!=="svelte-12jityq"&&(T.textContent=N),U=A(Y),z=g(Y,"DD",{class:!0});var ie=x(z);Z=H(ie,J),ie.forEach(b),se=A(Y),Y.forEach(b),P=g(Q,"DIV",{class:!0});var ee=x(P);q=g(ee,"DT",{class:!0,"data-svelte-h":!0}),B(q)!=="svelte-1qs6ebm"&&(q.textContent=le),oe=A(ee),G=g(ee,"DD",{class:!0});var ce=x(G);$=H(ce,K),ce.forEach(b),ee.forEach(b),Q.forEach(b),ae.forEach(b),M.forEach(b),this.h()},h(){p(e,"class","px-4 py-5 sm:px-6"),p(o,"class","text-sm font-medium text-gray-500"),p(u,"class","mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0"),p(i,"class","bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"),p(V,"class","text-sm font-medium text-gray-500"),p(h,"class","mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0"),p(C,"class","bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"),p(T,"class","text-sm font-medium text-gray-500"),p(z,"class","mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0"),p(k,"class","bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"),p(q,"class","text-sm font-medium text-gray-500"),p(G,"class","mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0"),p(P,"class","bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"),p(l,"class","border-t border-gray-200"),p(t,"class","overflow-hidden bg-white shadow sm:rounded-lg")},m(O,M){R(O,t,M),a(t,e),a(t,s),a(t,l),a(l,n),a(n,i),a(i,o),a(i,m),a(i,u),a(u,y),a(i,L),a(n,C),a(C,V),a(C,_),a(C,h),a(h,E),a(C,w),a(n,k),a(k,T),a(k,U),a(k,z),a(z,Z),a(k,se),a(n,P),a(P,q),a(P,oe),a(P,G),a(G,$)},p(O,M){M&1&&f!==(f=O[0].id+"")&&F(y,f),M&1&&D!==(D=O[0].email+"")&&F(E,D),M&1&&J!==(J=O[0].provider+"")&&F(Z,J),M&1&&K!==(K=new Date(O[0].expiresAt*1e3).toLocaleString()+"")&&F($,K)},d(O){O&&b(t)}}}function ve(r){let t,e,d='<h3 class="text-lg font-medium leading-6 text-gray-900">Active Cookies Found</h3> <p class="mt-1 text-sm text-gray-500">Supabase-related cookies currently stored in browser</p>',s,l,n,i=ue(r[4]),o=[];for(let c=0;c<i.length;c+=1)o[c]=be(me(r,i,c));return{c(){t=v("div"),e=v("div"),e.innerHTML=d,s=I(),l=v("div"),n=v("dl");for(let c=0;c<o.length;c+=1)o[c].c();this.h()},l(c){t=g(c,"DIV",{class:!0});var m=x(t);e=g(m,"DIV",{class:!0,"data-svelte-h":!0}),B(e)!=="svelte-s04tvc"&&(e.innerHTML=d),s=A(m),l=g(m,"DIV",{class:!0});var u=x(l);n=g(u,"DL",{});var f=x(n);for(let y=0;y<o.length;y+=1)o[y].l(f);f.forEach(b),u.forEach(b),m.forEach(b),this.h()},h(){p(e,"class","px-4 py-5 sm:px-6"),p(l,"class","border-t border-gray-200"),p(t,"class","mt-8 overflow-hidden bg-white shadow sm:rounded-lg")},m(c,m){R(c,t,m),a(t,e),a(t,s),a(t,l),a(l,n);for(let u=0;u<o.length;u+=1)o[u]&&o[u].m(n,null)},p(c,m){if(m&16){i=ue(c[4]);let u;for(u=0;u<i.length;u+=1){const f=me(c,i,u);o[u]?o[u].p(f,m):(o[u]=be(f),o[u].c(),o[u].m(n,null))}for(;u<o.length;u+=1)o[u].d(1);o.length=i.length}},d(c){c&&b(t),ke(o,c)}}}function be(r){let t,e,d=r[9].name+"",s,l,n,i=r[9].value+"",o,c;return{c(){t=v("div"),e=v("dt"),s=j(d),l=I(),n=v("dd"),o=j(i),c=I(),this.h()},l(m){t=g(m,"DIV",{class:!0});var u=x(t);e=g(u,"DT",{class:!0});var f=x(e);s=H(f,d),f.forEach(b),l=A(u),n=g(u,"DD",{class:!0});var y=x(n);o=H(y,i),y.forEach(b),c=A(u),u.forEach(b),this.h()},h(){p(e,"class","break-all text-sm font-medium text-gray-500"),p(n,"class","mt-1 break-all text-sm text-gray-900 sm:col-span-2 sm:mt-0"),p(t,"class","bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6")},m(m,u){R(m,t,u),a(t,e),a(e,s),a(t,l),a(t,n),a(n,o),a(t,c)},p(m,u){u&16&&d!==(d=m[9].name+"")&&F(s,d),u&16&&i!==(i=m[9].value+"")&&F(o,i)},d(m){m&&b(t)}}}function _e(r){let t,e,d;return{c(){t=v("div"),e=v("span"),d=j(r[1]),this.h()},l(s){t=g(s,"DIV",{class:!0,role:!0});var l=x(t);e=g(l,"SPAN",{class:!0});var n=x(e);d=H(n,r[1]),n.forEach(b),l.forEach(b),this.h()},h(){p(e,"class","block sm:inline"),p(t,"class","relative rounded border border-green-400 bg-green-100 px-4 py-3 text-green-700"),p(t,"role","alert")},m(s,l){R(s,t,l),a(t,e),a(e,d)},p(s,l){l&2&&F(d,s[1])},d(s){s&&b(t)}}}function Fe(r){let t,e,d,s='<h2 class="mt-6 text-3xl font-extrabold text-gray-900">Session Management</h2>',l,n,i,o,c=r[2]?"Loading...":"Find Session",m,u,f,y,L,C,V,S=r[3]&&pe(r),_=r[0]&&he(r),h=r[0]&&ge(r),D=r[4].length>0&&ve(r),E=r[1]&&_e(r);return{c(){t=v("div"),e=v("div"),d=v("div"),d.innerHTML=s,l=I(),S&&S.c(),n=I(),i=v("div"),o=v("button"),m=j(c),u=I(),_&&_.c(),f=I(),h&&h.c(),y=I(),D&&D.c(),L=I(),E&&E.c(),this.h()},l(w){t=g(w,"DIV",{class:!0});var k=x(t);e=g(k,"DIV",{class:!0});var T=x(e);d=g(T,"DIV",{class:!0,"data-svelte-h":!0}),B(d)!=="svelte-1n2wac4"&&(d.innerHTML=s),l=A(T),S&&S.l(T),n=A(T),i=g(T,"DIV",{class:!0});var N=x(i);o=g(N,"BUTTON",{class:!0});var U=x(o);m=H(U,c),U.forEach(b),u=A(N),_&&_.l(N),N.forEach(b),f=A(T),h&&h.l(T),y=A(T),D&&D.l(T),L=A(T),E&&E.l(T),T.forEach(b),k.forEach(b),this.h()},h(){p(d,"class","text-center"),o.disabled=r[2],p(o,"class","flex w-full justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50"),p(i,"class","space-y-4"),p(e,"class","mx-auto max-w-md space-y-8"),p(t,"class","min-h-screen bg-gray-50 px-4 py-12 sm:px-6 lg:px-8")},m(w,k){R(w,t,k),a(t,e),a(e,d),a(e,l),S&&S.m(e,null),a(e,n),a(e,i),a(i,o),a(o,m),a(i,u),_&&_.m(i,null),a(e,f),h&&h.m(e,null),a(e,y),D&&D.m(e,null),a(e,L),E&&E.m(e,null),C||(V=xe(o,"click",r[5]),C=!0)},p(w,[k]){w[3]?S?S.p(w,k):(S=pe(w),S.c(),S.m(e,n)):S&&(S.d(1),S=null),k&4&&c!==(c=w[2]?"Loading...":"Find Session")&&F(m,c),k&4&&(o.disabled=w[2]),w[0]?_?_.p(w,k):(_=he(w),_.c(),_.m(i,null)):_&&(_.d(1),_=null),w[0]?h?h.p(w,k):(h=ge(w),h.c(),h.m(e,y)):h&&(h.d(1),h=null),w[4].length>0?D?D.p(w,k):(D=ve(w),D.c(),D.m(e,L)):D&&(D.d(1),D=null),w[1]?E?E.p(w,k):(E=_e(w),E.c(),E.m(e,null)):E&&(E.d(1),E=null)},i:de,o:de,d(w){w&&b(t),S&&S.d(),_&&_.d(),h&&h.d(),D&&D.d(),E&&E.d(),C=!1,V()}}}function He(r,t,e){let d;De(r,Ce,f=>e(8,d=f));let s=null,l="",n=!1,i="",o=[];async function c(){try{e(2,n=!0),e(3,i=""),e(0,s=d.data.session),console.log("Raw session data:",d.data.session),e(4,o=document.cookie.split(";").map(f=>{const[y,L]=f.trim().split("=");return{name:y,value:L}}).filter(f=>f.name.includes("supabase")||f.name.includes("sb-"))),console.log("Current cookies:",o),s?(e(0,s={id:s.user?.id,email:s.user?.email,provider:s.user?.app_metadata?.provider,expiresAt:s.expires_at}),console.log("Processed session data:",s),e(1,l="")):(e(0,s=null),e(1,l="No active session found"))}catch(f){e(3,i=f.message||"Failed to fetch session"),e(0,s=null)}finally{e(2,n=!1)}}async function m(){try{e(2,n=!0),e(3,i="");const f=()=>{for(let _=0;_<localStorage.length;_++){const h=localStorage.key(_);(h?.includes("supabase")||h?.includes("sb-"))&&localStorage.removeItem(h)}for(let _=0;_<sessionStorage.length;_++){const h=sessionStorage.key(_);(h?.includes("supabase")||h?.includes("sb-"))&&sessionStorage.removeItem(h)}const V=[window.location.hostname,`.${window.location.hostname}`,window.location.hostname.split(".").slice(1).join("."),""],S=["/",""];document.cookie.split(";").forEach(_=>{const h=_.split("=")[0].trim();(h.includes("supabase")||h.includes("sb-"))&&V.forEach(D=>{S.forEach(E=>{document.cookie=`${h}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=${E}${D?`; domain=${D}`:""}`})})})},y=new FormData;if(!(await fetch("?/logout",{method:"POST",body:y})).ok)throw new Error("Server-side logout failed");const{error:C}=await te.auth.signOut({scope:"global"});if(C)throw C;f(),await ye(),e(0,s=null),e(4,o=[]),e(1,l="Successfully logged out and cleared session"),console.log("Initial cleanup completed"),setTimeout(async()=>{f(),e(1,l="Verifying session state..."),await c();const{data:{session:V}}=await te.auth.getSession();V||s?(console.log("Session still detected - attempting final cleanup"),e(1,l="Session still detected - forcing page reload..."),await te.auth.signOut({scope:"global"}),f(),window.location.href="/login"):(e(1,l="Verification complete: No active session found"),console.log("Logout successful - no session detected"))},2e3)}catch(f){console.error("Logout error:",f),e(3,i=f.message||"Failed to logout");try{clearBrowserStorage(),await te.auth.signOut({scope:"global"})}catch(y){console.error("Recovery attempt failed:",y)}}finally{e(2,n=!1)}}return[s,l,n,i,o,c,m,()=>(e(2,n=!0),async({result:f})=>{f.error&&e(3,i=f.error),await m()})]}class ze extends Le{constructor(t){super(),Te(this,t,He,Fe,we,{})}}export{ze as component,Ue as universal};

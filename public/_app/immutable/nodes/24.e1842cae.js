import{s as N,a as E,e as h,x as A,d as f,f as w,c as m,b as g,i as _,j as C,l as B,z as L,g as D,k as u,B as q,n as P,t as U,h as G,q as J}from"../chunks/scheduler.78aa6f0d.js";import{S as K,i as Q,b as V,e as R,t as j,g as W,c as X,a as Y,m as Z,d as $}from"../chunks/index.9a12d9f3.js";import{P as ee}from"../chunks/PricingSection.6d8108cf.js";import{a as te,s as re}from"../chunks/sessionStore.4d48270f.js";import{p as H}from"../chunks/profileStore.16c3ff97.js";import{t as M}from"../chunks/Toaster.svelte_svelte_type_style_lang.006f4a9b.js";import{g as ae}from"../chunks/navigation.dd464073.js";const oe=()=>({}),ve=Object.freeze(Object.defineProperty({__proto__:null,load:oe},Symbol.toStringTag,{value:"Module"}));function se(v){let t,r,a="Select a Plan",o,s,i,c,l,e,n,d,b,p,y,T,z;return i=new ee({props:{currentPlanId:"none",useFullPrice:!0}}),{c(){t=h("div"),r=h("h1"),r.textContent=a,o=E(),s=h("div"),X(i.$$.fragment),c=E(),l=h("div"),e=h("div"),n=h("div"),d=h("button"),b=E(),p=h("div"),this.h()},l(x){t=m(x,"DIV",{class:!0});var k=g(t);r=m(k,"H1",{class:!0,"data-svelte-h":!0}),D(r)!=="svelte-1ms61ox"&&(r.textContent=a),o=w(k),s=m(k,"DIV",{class:!0});var I=g(s);Y(i.$$.fragment,I),c=w(I),l=m(I,"DIV",{class:!0});var F=g(l);e=m(F,"DIV",{class:!0});var S=g(e);n=m(S,"DIV",{class:!0});var O=g(n);d=m(O,"BUTTON",{class:!0,"aria-label":!0}),g(d).forEach(f),O.forEach(f),b=w(S),p=m(S,"DIV",{}),g(p).forEach(f),S.forEach(f),F.forEach(f),I.forEach(f),k.forEach(f),this.h()},h(){_(r,"class","mb-4 text-center text-4xl font-bold"),_(d,"class","pointer-events-auto absolute bottom-[calc(50%-80px)] left-1/2 h-12 w-[90%] -translate-x-1/2 opacity-0"),_(d,"aria-label","Get Started with Free Plan"),_(n,"class","relative"),_(e,"class","grid h-full md:grid-cols-2"),_(l,"class","pointer-events-none absolute left-0 top-0 z-10 h-full w-full"),_(s,"class","relative"),_(t,"class","py-2")},m(x,k){C(x,t,k),u(t,r),u(t,o),u(t,s),Z(i,s,null),u(s,c),u(s,l),u(l,e),u(e,n),u(n,d),u(e,b),u(e,p),y=!0,T||(z=q(d,"click",v[2]),T=!0)},p:P,i(x){y||(j(i.$$.fragment,x),y=!0)},o(x){V(i.$$.fragment,x),y=!1},d(x){x&&f(t),$(i),T=!1,z()}}}function ne(v){let t,r,a="Error",o,s,i,c,l,e="Try Again",n,d;return{c(){t=h("div"),r=h("h2"),r.textContent=a,o=E(),s=h("p"),i=U(v[1]),c=E(),l=h("button"),l.textContent=e,this.h()},l(b){t=m(b,"DIV",{class:!0});var p=g(t);r=m(p,"H2",{class:!0,"data-svelte-h":!0}),D(r)!=="svelte-1ndfz0n"&&(r.textContent=a),o=w(p),s=m(p,"P",{class:!0});var y=g(s);i=G(y,v[1]),y.forEach(f),c=w(p),l=m(p,"BUTTON",{class:!0,"data-svelte-h":!0}),D(l)!=="svelte-12xr3ni"&&(l.textContent=e),p.forEach(f),this.h()},h(){_(r,"class","mb-4 text-xl font-bold text-red-700"),_(s,"class","text-red-600"),_(l,"class","mt-4 rounded bg-primary px-4 py-2 text-white"),_(t,"class","my-8 rounded-lg bg-red-50 p-6 text-center")},m(b,p){C(b,t,p),u(t,r),u(t,o),u(t,s),u(s,i),u(t,c),u(t,l),n||(d=q(l,"click",v[3]),n=!0)},p(b,p){p&2&&J(i,b[1])},i:P,o:P,d(b){b&&f(t),n=!1,d()}}}function le(v){let t,r='<div class="h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent"></div>';return{c(){t=h("div"),t.innerHTML=r,this.h()},l(a){t=m(a,"DIV",{class:!0,"data-svelte-h":!0}),D(t)!=="svelte-1kiyzhj"&&(t.innerHTML=r),this.h()},h(){_(t,"class","flex h-48 items-center justify-center")},m(a,o){C(a,t,o)},p:P,i:P,o:P,d(a){a&&f(t)}}}function ie(v){let t,r,a,o,s;const i=[le,ne,se],c=[];function l(e,n){return e[0]?0:e[1]?1:2}return a=l(v),o=c[a]=i[a](v),{c(){t=E(),r=h("div"),o.c(),this.h()},l(e){A("svelte-1dceu6j",document.head).forEach(f),t=w(e),r=m(e,"DIV",{class:!0});var d=g(r);o.l(d),d.forEach(f),this.h()},h(){document.title="Select a Plan",_(r,"class","container mx-auto px-4")},m(e,n){C(e,t,n),C(e,r,n),c[a].m(r,null),s=!0},p(e,[n]){let d=a;a=l(e),a===d?c[a].p(e,n):(W(),V(c[d],1,1,()=>{c[d]=null}),R(),o=c[a],o?o.p(e,n):(o=c[a]=i[a](e),o.c()),j(o,1),o.m(r,null))},i(e){s||(j(o),s=!0)},o(e){V(o),s=!1},d(e){e&&(f(t),f(r)),c[a].d()}}}function ce(v,t,r){let a,o;B(v,re,e=>r(4,a=e)),B(v,H,e=>r(5,o=e));let s=!0,i=null;L(async()=>{try{if(o!=null&&o.id){const{error:e}=await te.from("profiles").update({onboarded:!0,updated_at:new Date().toISOString()}).eq("id",o.id);e&&console.error("Error updating onboarding status:",e),H.update(n=>({...n,onboarded:!0}))}r(0,s=!1)}catch(e){console.error("Error initializing payment page:",e),r(1,i=e.message),r(0,s=!1)}});async function c(){try{if(!(a!=null&&a.access_token))throw new Error("No authentication token available");if(!(await fetch("/api/subscription/free",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a.access_token}`}})).ok)throw new Error("Failed to activate free plan");M.success("Free plan activated!"),ae("/account")}catch(e){console.error(e),M.error("Failed to activate free plan. Please try again.")}}return[s,i,c,()=>window.location.reload()]}class be extends K{constructor(t){super(),Q(this,t,ce,ie,N,{})}}export{be as component,ve as universal};

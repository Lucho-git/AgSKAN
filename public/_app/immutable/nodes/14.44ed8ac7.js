import{s as vt,e as k,E as Wt,a as Y,c as _,b as T,F as Ut,d as E,f as K,g as J,i as h,j as gt,k as f,U as ht,B as I,n as at,K as Ot,z as qt,Q as $t,A as mt,a3 as Gt,y as Yt}from"../chunks/scheduler.0ff5556b.js";import{S as ft,i as wt,c as Kt,a as Qt,m as Xt,t as Zt,b as Jt,d as te}from"../chunks/index.e3d1f712.js";import"../chunks/paths.6ba9dd8c.js";import"../chunks/supabaseClient.f7f11bf4.js";import"../chunks/MapViewer.svelte_svelte_type_style_lang.63940976.js";import"../chunks/Toaster.svelte_svelte_type_style_lang.7b1bf8eb.js";/* empty css                                                     */import"../chunks/index.d7bd5d03.js";import"../chunks/create.68466a8a.js";import"../chunks/sessionStore.a0feee67.js";function ee(a){let n,s,o,v,i,l,S,c,x,j="↺",U,B,V,u,y,r="↻",p,d,H,L,F='<div class="card bg-base-100 rounded-none flex-grow overflow-y-auto border-2 border-black h-full -mb-1"><div class="card-body p-4"><div class="mb-2"><div class="flex items-center"><svg class="w-6 h-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <span class="font-bold text-sm">Time</span></div> <div id="time" class="text-sm"><div class="badge badge-outline" id="date"></div> <br/> <div class="badge badge-outline" id="hours"></div></div></div> <div class="mb-2"><div class="flex items-center"><svg class="w-6 h-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"></path></svg> <span class="font-bold text-sm">Crop</span></div> <div class="badge badge-outline" id="crop"></div></div> <div class="mb-2"><div class="flex items-center"><svg class="w-6 h-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"></path></svg> <span class="font-bold text-sm">Applied Rate</span></div> <div class="badge badge-outline" id="appliedRate"></div></div> <div class="mb-2"><div class="flex items-center"><svg class="w-6 h-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path></svg> <span class="font-bold text-sm">Swath Width</span></div> <div class="badge badge-outline" id="swathWidth"></div></div> <div class="mb-2"><div class="flex items-center"><svg class="w-6 h-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"></path></svg> <span class="font-bold text-sm">Heading</span></div> <div class="badge badge-outline" id="heading"></div></div> <div class="mb-2"><div class="flex items-center"><svg class="w-6 h-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg> <span class="font-bold text-sm">Target Rate</span></div> <div class="badge badge-outline" id="targetRate"></div></div> <div class="mb-2"><div class="flex items-center"><svg class="w-6 h-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 7v10c0 2.21 3.582 4 8 4s8-1.79 8-4V7M4 7c0 2.21 3.582 4 8 4s8-1.79 8-4M4 7c0-2.21 3.582-4 8-4s8 1.79 8 4m0 5c0 2.21-3.582 4-8 4s-8-1.79-8-4"></path></svg> <span class="font-bold text-sm">Variety</span></div> <div class="badge badge-outline" id="variety"></div></div> <div class="mb-2"><div class="flex items-center"><svg class="w-6 h-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path></svg> <span class="font-bold text-sm">Machine</span></div> <div class="badge badge-outline" id="machine"></div></div> <div class="mb-2"><div class="flex items-center"><svg class="w-6 h-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17.657 18.657A8 8 0 016.343 7.343S7 9 9 10c0-2 .5-5 2.986-7C14 5 16.09 5.777 17.656 7.343A7.975 7.975 0 0120 13a7.975 7.975 0 01-2.343 5.657z"></path><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.879 16.121A3 3 0 1012.015 11L11 14H9c0 .768.293 1.536.879 2.121z"></path></svg> <span class="font-bold text-sm">Fuel</span></div> <div class="badge badge-outline" id="fuel"></div></div> <div class="mb-2"><div class="flex items-center"><svg class="w-6 h-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 10V3L4 14h7v7l9-11h-7z"></path></svg> <span class="font-bold text-sm">Vehicle Speed</span></div> <div class="badge badge-outline" id="vehicleSpeed"></div></div></div></div> <div class="border-t-2 border-black"></div>',N,O;return{c(){n=k("div"),s=k("div"),o=k("div"),v=k("div"),i=k("div"),l=Wt("svg"),S=Y(),c=k("div"),x=k("button"),x.textContent=j,U=Y(),B=k("button"),u=Y(),y=k("button"),y.textContent=r,p=Y(),d=k("input"),H=Y(),L=k("div"),L.innerHTML=F,this.h()},l(D){n=_(D,"DIV",{class:!0});var m=T(n);s=_(m,"DIV",{class:!0});var M=T(s);o=_(M,"DIV",{class:!0});var W=T(o);v=_(W,"DIV",{class:!0});var q=T(v);i=_(q,"DIV",{id:!0,class:!0});var R=T(i);l=Ut(R,"svg",{id:!0,width:!0,height:!0}),T(l).forEach(E),R.forEach(E),q.forEach(E),S=K(W),c=_(W,"DIV",{class:!0});var C=T(c);x=_(C,"BUTTON",{"data-svelte-h":!0}),J(x)!=="svelte-dbuqjm"&&(x.textContent=j),U=K(C),B=_(C,"BUTTON",{class:!0,"data-state":!0}),T(B).forEach(E),u=K(C),y=_(C,"BUTTON",{"data-svelte-h":!0}),J(y)!=="svelte-l0lyy5"&&(y.textContent=r),p=K(C),d=_(C,"INPUT",{class:!0,type:!0,min:!0,max:!0,step:!0}),C.forEach(E),W.forEach(E),H=K(M),L=_(M,"DIV",{class:!0,"data-svelte-h":!0}),J(L)!=="svelte-1y58c7p"&&(L.innerHTML=F),M.forEach(E),m.forEach(E),this.h()},h(){h(l,"id","animation-svg"),h(l,"width","100%"),h(l,"height","100%"),h(i,"id","animation-container"),h(i,"class","svelte-sfludt"),h(v,"class","animation-wrapper flex-grow svelte-sfludt"),h(B,"class","play-pause-restart ml-2 mr-2 svelte-sfludt"),h(B,"data-state",V=a[3].toLowerCase()),h(d,"class","ml-2"),h(d,"type","range"),h(d,"min","0"),h(d,"max","1"),h(d,"step","0.001"),h(c,"class","controls mt-4 svelte-sfludt"),h(o,"class","w-5/6 flex flex-col"),h(L,"class","hidden md:block md:w-1/6 mt-8 md:mt-0 flex flex-col relative min-w-[160px] max-w-[200px] svelte-sfludt"),h(s,"class","flex flex-row"),h(n,"class","full-width mx-auto svelte-sfludt")},m(D,m){gt(D,n,m),f(n,s),f(s,o),f(o,v),f(v,i),f(i,l),a[10](l),a[11](i),f(o,S),f(o,c),f(c,x),f(c,U),f(c,B),f(c,u),f(c,y),f(c,p),f(c,d),ht(d,a[2]),f(s,H),f(s,L),N||(O=[I(x,"click",a[9]),I(B,"click",a[7]),I(y,"click",a[8]),I(d,"change",a[12]),I(d,"input",a[12]),I(d,"input",a[4]),I(d,"mousedown",a[5]),I(d,"touchstart",a[5],{passive:!0}),I(d,"mouseup",a[6]),I(d,"touchend",a[6],{passive:!0}),I(d,"mouseleave",a[6])],N=!0)},p(D,m){m[0]&8&&V!==(V=D[3].toLowerCase())&&h(B,"data-state",V),m[0]&4&&ht(d,D[2])},i:at,o:at,d(D){D&&E(n),a[10](null),a[11](null),N=!1,Ot(O)}}}let se=.1;const ae=.1;function ne(a,n){const s=n.x-a.x,o=n.y-a.y;return Math.sqrt(s*s+o*o)}function nt(a,n){const s=a.map(i=>({x:i.geometry.coordinates[0],y:i.geometry.coordinates[1]}));if(s.length<=2)return a;let o=0,v=0;for(let i=1;i<s.length-1;i++){const l=oe(s[i],s[0],s[s.length-1]);l>o&&(v=i,o=l)}if(o>n){const i=nt(a.slice(0,v+1),n),l=nt(a.slice(v),n);return[...i.slice(0,-1),...l]}else return[a[0],a[a.length-1]]}function oe(a,n,s){const o=s.x-n.x,v=s.y-n.y,i=Math.abs(v*a.x-o*a.y+s.x*n.y-s.y*n.x),l=Math.sqrt(o*o+v*v);return i/l}function ie(a,n,s){let o=[],v=[],i=[],l=[],S=[],c=[],x=[],j=[],U=[],B=[],V,u,y,r,p=[],d=[],H,L,F,N,O,D,m=0,M,W,q={},R,C,P=[],ot=0,$=!0,G="Pause",tt=[],Q=0,X=1;qt(async()=>{gsap.registerPlugin(MotionPathPlugin),await bt(),await xt();const t=nt(p,5e-6);console.log(`Original data points: ${p.length}`),console.log(`Simplified data points: ${t.length}`),p=t,o=p.map(e=>e.properties.Time),v=p.map(e=>e.properties.Crop),i=p.map(e=>e.properties.AppliedRate),l=p.map(e=>e.properties.SWATHWIDTH),S=p.map(e=>e.properties.Heading),c=p.map(e=>e.properties.TargetRate),x=p.map(e=>e.properties.Variety),j=p.map(e=>e.properties.Machine),U=p.map(e=>e.properties.FUEL),B=p.map(e=>e.properties.VEHICLSPEED),Ct(),y=Et(),P=St(),kt(),_t(),Mt(),yt(),dt(),console.log("About to draw paddock boundary"),Bt(),console.log("Drawn paddock boundary"),lt(),V.addEventListener("wheel",it),addEventListener("animationprogress",e=>{s(2,m=e.detail)})}),$t(()=>{V.removeEventListener("wheel",it),removeEventListener("animationprogress",t=>{s(2,m=t.detail)}),r&&(r.clear(),s(2,m=0)),s(1,u.innerHTML="",u)});async function bt(){p=(await(await fetch("/data/supershedseeding.geojson")).json()).features}async function xt(){d=(await(await fetch("/data/supershedboundary.geojson")).json()).features[0].geometry.coordinates[0][0],console.log(d)}function it(t){t.preventDefault();const e=t.deltaY<0?1:-1;X+=e*ae,X=Math.max(.5,Math.min(X,2)),s(1,u.style.transform=`scale(${X})`,u)}function yt(){tt=[],Q=0;for(let t=1;t<P.length;t++){const e=P[t-1],w=P[t],b=ne(e,w);tt.push(b),Q+=b}Q*=se}function kt(){M=document.createElementNS("http://www.w3.org/2000/svg","path"),M.setAttribute("fill","none"),M.setAttribute("stroke","transparent"),M.setAttribute("stroke-width",y),M.setAttribute("d",`M${P.map(t=>`${t.x},${t.y}`).join("L")}`),u.appendChild(M),W={path:M,autoRotate:!0,align:M,alignOrigin:[.5,.5],start:0,end:1}}function _t(){const t=["red","green","orange","purple","cyan","magenta","teal","brown","lime"];p.forEach((e,w)=>{const b=e.properties&&e.properties.SECTIONID;b&&!q[b]&&(q[b]=t.length>0?t[ot%t.length]:`hsl(${Math.random()*360}, 50%, 50%)`,ot++)})}function Mt(){R=document.createElementNS("http://www.w3.org/2000/svg","image"),R.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href","/images/tractor.svg"),R.setAttribute("width",y*4),R.setAttribute("height",y*4),C=gsap.to(R,{motionPath:W,duration:1,ease:"linear",paused:!0})}function Ct(){H=Math.min(...d.map(t=>t[0])),L=Math.max(...d.map(t=>t[0])),F=Math.min(...d.map(t=>t[1])),N=Math.max(...d.map(t=>t[1])),O=u.clientWidth/(L-H),D=u.clientHeight/(N-F)}function Dt(){r&&(r.pause(),r.progress(m),m===1?($=!1,s(3,G="Restart")):($=!0,s(3,G="Pause")))}function Pt(){r&&r.pause()}function At(){r&&m!==1&&r.resume()}function Et(){const e=(L-H)*(Math.PI/180),w=(N-F)*(Math.PI/180),b=Math.sin(w/2)**2+Math.cos(F*(Math.PI/180))*Math.cos(N*(Math.PI/180))*Math.sin(e/2)**2,A=6371e3*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)));return 12*(u.clientWidth/A)}function St(){const t=[];for(let e=0;e<p.length;e++){const{geometry:{coordinates:[w,b]}}=p[e],g=(w-H)*O,A=u.clientHeight-(b-F)*D;t.push({x:g,y:A})}return t}function Bt(){console.log("Drawing paddock boundary");const t=document.createElementNS("http://www.w3.org/2000/svg","path"),e=d.map(w=>`${(w[0]-H)*O},${u.clientHeight-(w[1]-F)*D}`).join("L");t.setAttribute("d",`M${e}Z`),t.setAttribute("fill","none"),t.setAttribute("stroke","blue"),t.setAttribute("stroke-width",5),u.appendChild(t)}function rt(t){const e=o[t],[w,b]=e.split(" ");document.getElementById("date").textContent=w,document.getElementById("hours").textContent=b,document.getElementById("crop").textContent=v[t],document.getElementById("appliedRate").textContent=i[t],document.getElementById("swathWidth").textContent=l[t];const g=S[t];document.getElementById("heading").textContent=g.toFixed(2),document.getElementById("targetRate").textContent=c[t],document.getElementById("variety").textContent=x[t],document.getElementById("machine").textContent=j[t];const A=U[t];document.getElementById("fuel").textContent=A.toFixed(4);const z=B[t];document.getElementById("vehicleSpeed").textContent=z.toFixed(2)}let et=0;function lt(){r=gsap.timeline({onUpdate:()=>{s(2,m=r.progress()),dispatchEvent(new CustomEvent("animationprogress",{detail:m}));const e=Math.floor(m*(P.length-1));e!==et&&(et=e,rt(et))}}),s(2,m=0),r.clear();let t=0;for(let e=1;e<P.length;e++){const w=e-1,b=e,g=tt[e-1]/Q*10;Lt(w,b,g,t),t+=g}u.appendChild(R),C.duration(t),C.restart(),r.add(C,0),r.eventCallback("onComplete",()=>{$=!1,s(3,G="Restart")})}function Lt(t,e,w,b){const g=document.createElementNS("http://www.w3.org/2000/svg","path"),A=P[t],z=P[e],Z={x:(A.x+z.x)/2,y:(A.y+z.y)/2},ct={x:(A.x+Z.x)/2,y:(A.y+Z.y)/2},ut={x:(Z.x+z.x)/2,y:(Z.y+z.y)/2},Rt=`M${A.x},${A.y} C${ct.x},${ct.y} ${ut.x},${ut.y} ${z.x},${z.y}`;g.setAttribute("d",Rt);const pt=p[e].properties&&p[e].properties.SECTIONID,zt=pt?q[pt]:"black";g.setAttribute("stroke",zt),g.setAttribute("fill","none"),g.setAttribute("stroke-width",y),g.setAttribute("stroke-linecap","round"),g.setAttribute("stroke-linejoin","round"),g.style.opacity=0,u.appendChild(g);const st=g.getTotalLength();r.fromTo(g,{strokeDasharray:st+" "+st,strokeDashoffset:st},{strokeDashoffset:0,duration:w,ease:"linear",onUpdate:()=>{const Nt=r.progress();g.style.opacity=Nt>=b/r.duration()?1:0}},b)}function dt(){const t=document.createElementNS("http://www.w3.org/2000/svg","path"),e=`M${P[0].x},${P[0].y} ${P.slice(1).map(w=>`L${w.x},${w.y}`).join(" ")}`;t.setAttribute("d",e),t.setAttribute("stroke","black"),t.setAttribute("fill","none"),t.setAttribute("stroke-width",y*.05),t.setAttribute("stroke-linecap","round"),t.setAttribute("stroke-linejoin","round"),t.setAttribute("opacity",.3),u.appendChild(t)}function It(){$?(r.pause(),s(3,G="Play")):(r.progress()===1?(s(1,u.innerHTML="",u),dt(),rt(0),lt()):r.play(),s(3,G="Pause")),$=!$}function jt(){r.progress(r.progress()+.1)}function Vt(){r.progress(r.progress()-.1)}function Tt(t){mt[t?"unshift":"push"](()=>{u=t,s(1,u)})}function Ht(t){mt[t?"unshift":"push"](()=>{V=t,s(0,V)})}function Ft(){m=Gt(this.value),s(2,m)}return[V,u,m,G,Dt,Pt,At,It,jt,Vt,Tt,Ht,Ft]}class re extends ft{constructor(n){super(),wt(this,n,ie,ee,vt,{},null,[-1,-1,-1])}}function le(a){let n,s,o,v=`<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" class="h-6 w-6 shrink-0 stroke-current"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg> <div><h3 class="font-bold">Coming Later: PathPlanner Feature</h3> <div class="text-sm">We&#39;re working on an exciting new PathPlanner feature. Stay tuned for
          updates!</div></div>`,i,l,S;return l=new re({}),{c(){n=k("div"),s=k("div"),o=k("div"),o.innerHTML=v,i=Y(),Kt(l.$$.fragment),this.h()},l(c){n=_(c,"DIV",{class:!0});var x=T(n);s=_(x,"DIV",{class:!0});var j=T(s);o=_(j,"DIV",{class:!0,"data-svelte-h":!0}),J(o)!=="svelte-c8rhou"&&(o.innerHTML=v),i=K(j),Qt(l.$$.fragment,j),j.forEach(E),x.forEach(E),this.h()},h(){h(o,"class","alert alert-info mb-4 mt-2 w-full"),h(s,"class","mx-auto w-full max-w-4xl"),h(n,"class","app-container svelte-1tt9gwm")},m(c,x){gt(c,n,x),f(n,s),f(s,o),f(s,i),Xt(l,s,null),S=!0},p:at,i(c){S||(Zt(l.$$.fragment,c),S=!0)},o(c){Jt(l.$$.fragment,c),S=!1},d(c){c&&E(n),te(l)}}}function de(a){return Yt("adminSection").set("pathplanner"),[]}class xe extends ft{constructor(n){super(),wt(this,n,de,le,vt,{})}}export{xe as component};

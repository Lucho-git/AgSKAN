import{s as we,e as v,a as A,t as F,c as b,b as x,g as B,f as C,h as H,d as _,i as h,j as R,k as r,B as xe,q as j,n as de,l as De,$ as Ee,L as Se,G as ke}from"../chunks/scheduler.0ff5556b.js";import{e as ue}from"../chunks/each.1577e3f3.js";import{S as Le,i as Te}from"../chunks/index.e3d1f712.js";import{s as te}from"../chunks/supabaseClient.f7f11bf4.js";import{i as ye}from"../chunks/navigation.2ad273ee.js";import{p as Ie}from"../chunks/stores.1e905000.js";import{p as Ae}from"../chunks/parse.bee59afc.js";import{a as Ce}from"../chunks/singletons.8f083e01.js";function Ve(a){return Ce.apply_action(a)}function Me(a){const t=JSON.parse(a);return t.data&&(t.data=Ae(t.data)),t}function fe(a){return HTMLElement.prototype.cloneNode.call(a)}function Oe(a,t=()=>{}){const e=async({action:s,result:l,reset:n=!0,invalidateAll:i=!0})=>{l.type==="success"&&(n&&HTMLFormElement.prototype.reset.call(a),i&&await ye()),(location.origin+location.pathname===s.origin+s.pathname||l.type==="redirect"||l.type==="error")&&Ve(l)};async function u(s){var V,L,S,D;if(((V=s.submitter)!=null&&V.hasAttribute("formmethod")?s.submitter.formMethod:fe(a).method)!=="post")return;s.preventDefault();const n=new URL((L=s.submitter)!=null&&L.hasAttribute("formaction")?s.submitter.formAction:fe(a).action),i=new FormData(a),o=(S=s.submitter)==null?void 0:S.getAttribute("name");o&&i.append(o,((D=s.submitter)==null?void 0:D.getAttribute("value"))??"");const d=new AbortController;let p=!1;const g=await t({action:n,cancel:()=>p=!0,controller:d,get data(){return i},formData:i,get form(){return a},formElement:a,submitter:s.submitter})??e;if(p)return;let y;try{const c=await fetch(n,{method:"POST",headers:{accept:"application/json","x-sveltekit-action":"true"},cache:"no-store",body:i,signal:d.signal});y=Me(await c.text()),y.type==="error"&&(y.status=c.status)}catch(c){if((c==null?void 0:c.name)==="AbortError")return;y={type:"error",error:c}}g({action:n,get data(){return i},formData:i,get form(){return a},formElement:a,update:c=>e({action:n,result:y,reset:c==null?void 0:c.reset,invalidateAll:c==null?void 0:c.invalidateAll}),result:y})}return HTMLFormElement.prototype.addEventListener.call(a,"submit",u),{destroy(){HTMLFormElement.prototype.removeEventListener.call(a,"submit",u)}}}const Fe=!1,Je=Object.freeze(Object.defineProperty({__proto__:null,prerender:Fe},Symbol.toStringTag,{value:"Module"}));function me(a,t,e){const u=a.slice();return u[9]=t[e],u}function pe(a){let t,e,u;return{c(){t=v("div"),e=v("span"),u=F(a[3]),this.h()},l(s){t=b(s,"DIV",{class:!0,role:!0});var l=x(t);e=b(l,"SPAN",{class:!0});var n=x(e);u=H(n,a[3]),n.forEach(_),l.forEach(_),this.h()},h(){h(e,"class","block sm:inline"),h(t,"class","relative rounded border border-red-400 bg-red-100 px-4 py-3 text-red-700"),h(t,"role","alert")},m(s,l){R(s,t,l),r(t,e),r(e,u)},p(s,l){l&8&&j(u,s[3])},d(s){s&&_(t)}}}function he(a){let t,e,u=a[2]?"Loading...":"Logout",s,l,n,i;return{c(){t=v("form"),e=v("button"),s=F(u),this.h()},l(o){t=b(o,"FORM",{method:!0,action:!0});var d=x(t);e=b(d,"BUTTON",{type:!0,class:!0});var p=x(e);s=H(p,u),p.forEach(_),d.forEach(_),this.h()},h(){h(e,"type","submit"),e.disabled=a[2],h(e,"class","flex w-full justify-center rounded-md border border-transparent bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50"),h(t,"method","POST"),h(t,"action","?/logout")},m(o,d){R(o,t,d),r(t,e),r(e,s),n||(i=Ee(l=Oe.call(null,t,a[7])),n=!0)},p(o,d){d&4&&u!==(u=o[2]?"Loading...":"Logout")&&j(s,u),d&4&&(e.disabled=o[2]),l&&Se(l.update)&&d&12&&l.update.call(null,o[7])},d(o){o&&_(t),n=!1,i()}}}function ge(a){let t,e,u='<h3 class="text-lg font-medium leading-6 text-gray-900">Active Session Found</h3>',s,l,n,i,o,d="User ID",p,f,g=a[0].id+"",y,V,L,S,D="Email",c,m,E=a[0].email+"",k,w,T,I,N="Provider",U,z,J=a[0].provider+"",Z,se,P,q,ae="Expires At",oe,G,K=new Date(a[0].expiresAt*1e3).toLocaleString()+"",$;return{c(){t=v("div"),e=v("div"),e.innerHTML=u,s=A(),l=v("div"),n=v("dl"),i=v("div"),o=v("dt"),o.textContent=d,p=A(),f=v("dd"),y=F(g),V=A(),L=v("div"),S=v("dt"),S.textContent=D,c=A(),m=v("dd"),k=F(E),w=A(),T=v("div"),I=v("dt"),I.textContent=N,U=A(),z=v("dd"),Z=F(J),se=A(),P=v("div"),q=v("dt"),q.textContent=ae,oe=A(),G=v("dd"),$=F(K),this.h()},l(O){t=b(O,"DIV",{class:!0});var M=x(t);e=b(M,"DIV",{class:!0,"data-svelte-h":!0}),B(e)!=="svelte-m18uka"&&(e.innerHTML=u),s=C(M),l=b(M,"DIV",{class:!0});var le=x(l);n=b(le,"DL",{});var Q=x(n);i=b(Q,"DIV",{class:!0});var W=x(i);o=b(W,"DT",{class:!0,"data-svelte-h":!0}),B(o)!=="svelte-11k5p0n"&&(o.textContent=d),p=C(W),f=b(W,"DD",{class:!0});var re=x(f);y=H(re,g),re.forEach(_),V=C(W),W.forEach(_),L=b(Q,"DIV",{class:!0});var X=x(L);S=b(X,"DT",{class:!0,"data-svelte-h":!0}),B(S)!=="svelte-qj6i1v"&&(S.textContent=D),c=C(X),m=b(X,"DD",{class:!0});var ne=x(m);k=H(ne,E),ne.forEach(_),w=C(X),X.forEach(_),T=b(Q,"DIV",{class:!0});var Y=x(T);I=b(Y,"DT",{class:!0,"data-svelte-h":!0}),B(I)!=="svelte-12jityq"&&(I.textContent=N),U=C(Y),z=b(Y,"DD",{class:!0});var ie=x(z);Z=H(ie,J),ie.forEach(_),se=C(Y),Y.forEach(_),P=b(Q,"DIV",{class:!0});var ee=x(P);q=b(ee,"DT",{class:!0,"data-svelte-h":!0}),B(q)!=="svelte-1qs6ebm"&&(q.textContent=ae),oe=C(ee),G=b(ee,"DD",{class:!0});var ce=x(G);$=H(ce,K),ce.forEach(_),ee.forEach(_),Q.forEach(_),le.forEach(_),M.forEach(_),this.h()},h(){h(e,"class","px-4 py-5 sm:px-6"),h(o,"class","text-sm font-medium text-gray-500"),h(f,"class","mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0"),h(i,"class","bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"),h(S,"class","text-sm font-medium text-gray-500"),h(m,"class","mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0"),h(L,"class","bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"),h(I,"class","text-sm font-medium text-gray-500"),h(z,"class","mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0"),h(T,"class","bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"),h(q,"class","text-sm font-medium text-gray-500"),h(G,"class","mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0"),h(P,"class","bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"),h(l,"class","border-t border-gray-200"),h(t,"class","overflow-hidden bg-white shadow sm:rounded-lg")},m(O,M){R(O,t,M),r(t,e),r(t,s),r(t,l),r(l,n),r(n,i),r(i,o),r(i,p),r(i,f),r(f,y),r(i,V),r(n,L),r(L,S),r(L,c),r(L,m),r(m,k),r(L,w),r(n,T),r(T,I),r(T,U),r(T,z),r(z,Z),r(T,se),r(n,P),r(P,q),r(P,oe),r(P,G),r(G,$)},p(O,M){M&1&&g!==(g=O[0].id+"")&&j(y,g),M&1&&E!==(E=O[0].email+"")&&j(k,E),M&1&&J!==(J=O[0].provider+"")&&j(Z,J),M&1&&K!==(K=new Date(O[0].expiresAt*1e3).toLocaleString()+"")&&j($,K)},d(O){O&&_(t)}}}function ve(a){let t,e,u='<h3 class="text-lg font-medium leading-6 text-gray-900">Active Cookies Found</h3> <p class="mt-1 text-sm text-gray-500">Supabase-related cookies currently stored in browser</p>',s,l,n,i=ue(a[4]),o=[];for(let d=0;d<i.length;d+=1)o[d]=be(me(a,i,d));return{c(){t=v("div"),e=v("div"),e.innerHTML=u,s=A(),l=v("div"),n=v("dl");for(let d=0;d<o.length;d+=1)o[d].c();this.h()},l(d){t=b(d,"DIV",{class:!0});var p=x(t);e=b(p,"DIV",{class:!0,"data-svelte-h":!0}),B(e)!=="svelte-s04tvc"&&(e.innerHTML=u),s=C(p),l=b(p,"DIV",{class:!0});var f=x(l);n=b(f,"DL",{});var g=x(n);for(let y=0;y<o.length;y+=1)o[y].l(g);g.forEach(_),f.forEach(_),p.forEach(_),this.h()},h(){h(e,"class","px-4 py-5 sm:px-6"),h(l,"class","border-t border-gray-200"),h(t,"class","mt-8 overflow-hidden bg-white shadow sm:rounded-lg")},m(d,p){R(d,t,p),r(t,e),r(t,s),r(t,l),r(l,n);for(let f=0;f<o.length;f+=1)o[f]&&o[f].m(n,null)},p(d,p){if(p&16){i=ue(d[4]);let f;for(f=0;f<i.length;f+=1){const g=me(d,i,f);o[f]?o[f].p(g,p):(o[f]=be(g),o[f].c(),o[f].m(n,null))}for(;f<o.length;f+=1)o[f].d(1);o.length=i.length}},d(d){d&&_(t),ke(o,d)}}}function be(a){let t,e,u=a[9].name+"",s,l,n,i=a[9].value+"",o,d;return{c(){t=v("div"),e=v("dt"),s=F(u),l=A(),n=v("dd"),o=F(i),d=A(),this.h()},l(p){t=b(p,"DIV",{class:!0});var f=x(t);e=b(f,"DT",{class:!0});var g=x(e);s=H(g,u),g.forEach(_),l=C(f),n=b(f,"DD",{class:!0});var y=x(n);o=H(y,i),y.forEach(_),d=C(f),f.forEach(_),this.h()},h(){h(e,"class","break-all text-sm font-medium text-gray-500"),h(n,"class","mt-1 break-all text-sm text-gray-900 sm:col-span-2 sm:mt-0"),h(t,"class","bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6")},m(p,f){R(p,t,f),r(t,e),r(e,s),r(t,l),r(t,n),r(n,o),r(t,d)},p(p,f){f&16&&u!==(u=p[9].name+"")&&j(s,u),f&16&&i!==(i=p[9].value+"")&&j(o,i)},d(p){p&&_(t)}}}function _e(a){let t,e,u;return{c(){t=v("div"),e=v("span"),u=F(a[1]),this.h()},l(s){t=b(s,"DIV",{class:!0,role:!0});var l=x(t);e=b(l,"SPAN",{class:!0});var n=x(e);u=H(n,a[1]),n.forEach(_),l.forEach(_),this.h()},h(){h(e,"class","block sm:inline"),h(t,"class","relative rounded border border-green-400 bg-green-100 px-4 py-3 text-green-700"),h(t,"role","alert")},m(s,l){R(s,t,l),r(t,e),r(e,u)},p(s,l){l&2&&j(u,s[1])},d(s){s&&_(t)}}}function He(a){let t,e,u,s='<h2 class="mt-6 text-3xl font-extrabold text-gray-900">Session Management</h2>',l,n,i,o,d=a[2]?"Loading...":"Find Session",p,f,g,y,V,L,S,D=a[3]&&pe(a),c=a[0]&&he(a),m=a[0]&&ge(a),E=a[4].length>0&&ve(a),k=a[1]&&_e(a);return{c(){t=v("div"),e=v("div"),u=v("div"),u.innerHTML=s,l=A(),D&&D.c(),n=A(),i=v("div"),o=v("button"),p=F(d),f=A(),c&&c.c(),g=A(),m&&m.c(),y=A(),E&&E.c(),V=A(),k&&k.c(),this.h()},l(w){t=b(w,"DIV",{class:!0});var T=x(t);e=b(T,"DIV",{class:!0});var I=x(e);u=b(I,"DIV",{class:!0,"data-svelte-h":!0}),B(u)!=="svelte-1n2wac4"&&(u.innerHTML=s),l=C(I),D&&D.l(I),n=C(I),i=b(I,"DIV",{class:!0});var N=x(i);o=b(N,"BUTTON",{class:!0});var U=x(o);p=H(U,d),U.forEach(_),f=C(N),c&&c.l(N),N.forEach(_),g=C(I),m&&m.l(I),y=C(I),E&&E.l(I),V=C(I),k&&k.l(I),I.forEach(_),T.forEach(_),this.h()},h(){h(u,"class","text-center"),o.disabled=a[2],h(o,"class","flex w-full justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50"),h(i,"class","space-y-4"),h(e,"class","mx-auto max-w-md space-y-8"),h(t,"class","min-h-screen bg-gray-50 px-4 py-12 sm:px-6 lg:px-8")},m(w,T){R(w,t,T),r(t,e),r(e,u),r(e,l),D&&D.m(e,null),r(e,n),r(e,i),r(i,o),r(o,p),r(i,f),c&&c.m(i,null),r(e,g),m&&m.m(e,null),r(e,y),E&&E.m(e,null),r(e,V),k&&k.m(e,null),L||(S=xe(o,"click",a[5]),L=!0)},p(w,[T]){w[3]?D?D.p(w,T):(D=pe(w),D.c(),D.m(e,n)):D&&(D.d(1),D=null),T&4&&d!==(d=w[2]?"Loading...":"Find Session")&&j(p,d),T&4&&(o.disabled=w[2]),w[0]?c?c.p(w,T):(c=he(w),c.c(),c.m(i,null)):c&&(c.d(1),c=null),w[0]?m?m.p(w,T):(m=ge(w),m.c(),m.m(e,y)):m&&(m.d(1),m=null),w[4].length>0?E?E.p(w,T):(E=ve(w),E.c(),E.m(e,V)):E&&(E.d(1),E=null),w[1]?k?k.p(w,T):(k=_e(w),k.c(),k.m(e,null)):k&&(k.d(1),k=null)},i:de,o:de,d(w){w&&_(t),D&&D.d(),c&&c.d(),m&&m.d(),E&&E.d(),k&&k.d(),L=!1,S()}}}function je(a,t,e){let u;De(a,Ie,g=>e(8,u=g));let s=null,l="",n=!1,i="",o=[];async function d(){var g,y,V,L;try{e(2,n=!0),e(3,i=""),e(0,s=u.data.session),console.log("Raw session data:",u.data.session),e(4,o=document.cookie.split(";").map(S=>{const[D,c]=S.trim().split("=");return{name:D,value:c}}).filter(S=>S.name.includes("supabase")||S.name.includes("sb-"))),console.log("Current cookies:",o),s?(e(0,s={id:(g=s.user)==null?void 0:g.id,email:(y=s.user)==null?void 0:y.email,provider:(L=(V=s.user)==null?void 0:V.app_metadata)==null?void 0:L.provider,expiresAt:s.expires_at}),console.log("Processed session data:",s),e(1,l="")):(e(0,s=null),e(1,l="No active session found"))}catch(S){e(3,i=S.message||"Failed to fetch session"),e(0,s=null)}finally{e(2,n=!1)}}async function p(){try{e(2,n=!0),e(3,i="");const g=()=>{for(let c=0;c<localStorage.length;c++){const m=localStorage.key(c);(m!=null&&m.includes("supabase")||m!=null&&m.includes("sb-"))&&localStorage.removeItem(m)}for(let c=0;c<sessionStorage.length;c++){const m=sessionStorage.key(c);(m!=null&&m.includes("supabase")||m!=null&&m.includes("sb-"))&&sessionStorage.removeItem(m)}const S=[window.location.hostname,`.${window.location.hostname}`,window.location.hostname.split(".").slice(1).join("."),""],D=["/",""];document.cookie.split(";").forEach(c=>{const m=c.split("=")[0].trim();(m.includes("supabase")||m.includes("sb-"))&&S.forEach(E=>{D.forEach(k=>{document.cookie=`${m}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=${k}${E?`; domain=${E}`:""}`})})})},y=new FormData;if(!(await fetch("?/logout",{method:"POST",body:y})).ok)throw new Error("Server-side logout failed");const{error:L}=await te.auth.signOut({scope:"global"});if(L)throw L;g(),await ye(),e(0,s=null),e(4,o=[]),e(1,l="Successfully logged out and cleared session"),console.log("Initial cleanup completed"),setTimeout(async()=>{g(),e(1,l="Verifying session state..."),await d();const{data:{session:S}}=await te.auth.getSession();S||s?(console.log("Session still detected - attempting final cleanup"),e(1,l="Session still detected - forcing page reload..."),await te.auth.signOut({scope:"global"}),g(),window.location.href="/login"):(e(1,l="Verification complete: No active session found"),console.log("Logout successful - no session detected"))},2e3)}catch(g){console.error("Logout error:",g),e(3,i=g.message||"Failed to logout");try{clearBrowserStorage(),await te.auth.signOut({scope:"global"})}catch(y){console.error("Recovery attempt failed:",y)}}finally{e(2,n=!1)}}return[s,l,n,i,o,d,p,()=>(e(2,n=!0),async({result:g})=>{g.error&&e(3,i=g.error),await p()})]}class Ke extends Le{constructor(t){super(),Te(this,t,je,He,we,{})}}export{Ke as component,Je as universal};

import{s as Te,r as ye,v as Pe,m as ze,u as Oe,o as He,p as Re,e as p,a as w,t as je,c as f,b as _,g as G,f as y,d as h,h as Ue,i as r,j as Se,k as l,U as z,B as O,K as Ke,l as Ze,E as xe,F as Me,q as Ge}from"../chunks/scheduler.78aa6f0d.js";import{S as Xe,i as qe,c as ie,a as ue,m as ce,t as J,b as Q,d as pe}from"../chunks/index.9a12d9f3.js";import{g as Je}from"../chunks/navigation.dd464073.js";import{a as Ve}from"../chunks/sessionStore.4d48270f.js";import{p as Fe}from"../chunks/profileStore.16c3ff97.js";import{s as Qe}from"../chunks/subscriptionStore.fcaabd6c.js";import{t as Ae}from"../chunks/Toaster.svelte_svelte_type_style_lang.006f4a9b.js";import{g as We,a as Ye}from"../chunks/spread.8a54911c.js";import{I as et}from"../chunks/Icon.78e39609.js";import{U as tt}from"../chunks/user.8058017b.js";import{P as st}from"../chunks/phone.97600f36.js";function at(n){let e;const t=n[2].default,s=ze(t,n,n[3],null);return{c(){s&&s.c()},l(o){s&&s.l(o)},m(o,a){s&&s.m(o,a),e=!0},p(o,a){s&&s.p&&(!e||a&8)&&Oe(s,t,o,o[3],e?Re(t,o[3],a,null):He(o[3]),null)},i(o){e||(J(s,o),e=!0)},o(o){Q(s,o),e=!1},d(o){s&&s.d(o)}}}function lt(n){let e,t;const s=[{name:"building-2"},n[1],{iconNode:n[0]}];let o={$$slots:{default:[at]},$$scope:{ctx:n}};for(let a=0;a<s.length;a+=1)o=ye(o,s[a]);return e=new et({props:o}),{c(){ie(e.$$.fragment)},l(a){ue(e.$$.fragment,a)},m(a,u){ce(e,a,u),t=!0},p(a,[u]){const d=u&3?We(s,[s[0],u&2&&Ye(a[1]),u&1&&{iconNode:a[0]}]):{};u&8&&(d.$$scope={dirty:u,ctx:a}),e.$set(d)},i(a){t||(J(e.$$.fragment,a),t=!0)},o(a){Q(e.$$.fragment,a),t=!1},d(a){pe(e,a)}}}function rt(n,e,t){let{$$slots:s={},$$scope:o}=e;const a=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"}],["path",{d:"M10 6h4"}],["path",{d:"M10 10h4"}],["path",{d:"M10 14h4"}],["path",{d:"M10 18h4"}]];return n.$$set=u=>{t(1,e=ye(ye({},e),Pe(u))),"$$scope"in u&&t(3,o=u.$$scope)},e=Pe(e),[a,e,s,o]}class nt extends Xe{constructor(e){super(),qe(this,e,rt,lt,Te,{})}}const ot=nt,it=()=>({}),St=Object.freeze(Object.defineProperty({__proto__:null,load:it},Symbol.toStringTag,{value:"Module"}));function Be(n){let e,t,s,o,a,u;return{c(){e=p("div"),t=xe("svg"),s=xe("path"),o=w(),a=p("span"),u=je(n[3]),this.h()},l(d){e=f(d,"DIV",{class:!0});var i=_(e);t=Me(i,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0});var b=_(t);s=Me(b,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0}),_(s).forEach(h),b.forEach(h),o=y(i),a=f(i,"SPAN",{});var v=_(a);u=Ue(v,n[3]),v.forEach(h),i.forEach(h),this.h()},h(){r(s,"stroke-linecap","round"),r(s,"stroke-linejoin","round"),r(s,"stroke-width","2"),r(s,"d","M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"),r(t,"xmlns","http://www.w3.org/2000/svg"),r(t,"class","h-6 w-6 shrink-0 stroke-current"),r(t,"fill","none"),r(t,"viewBox","0 0 24 24"),r(e,"class","alert alert-error mb-6")},m(d,i){Se(d,e,i),l(e,t),l(t,s),l(e,o),l(e,a),l(a,u)},p(d,i){i&8&&Ge(u,d[3])},d(d){d&&h(e)}}}function Le(n){let e;return{c(){e=p("span"),this.h()},l(t){e=f(t,"SPAN",{class:!0}),_(e).forEach(h),this.h()},h(){r(e,"class","loading loading-spinner")},m(t,s){Se(t,e,s)},d(t){t&&h(e)}}}function ut(n){let e,t,s,o='<h1 class="mb-4 text-5xl font-bold text-base-content">Farm Details</h1> <p class="text-xl text-base-content/70">Tell us about your operation</p>',a,u,d,i,b,v,P,H,x,W="Full Name",R,S,K,m,k,M,fe,L,ke="Company/Farm Name",de,I,me,V,F,T,he,j,Ie="Mobile Number",_e,$,be,X,A,B,ge,U,$e="I agree to be contacted for setup assistance and important updates",ve,N,Y,ee,Z,Ee,Ne,g=n[3]&&Be(n);P=new tt({props:{size:18,class:"text-base-content/70"}}),M=new ot({props:{size:18,class:"text-base-content/70"}}),T=new st({props:{size:18,class:"text-base-content/70"}});let E=n[5]&&Le();return{c(){e=p("div"),t=p("div"),s=p("div"),s.innerHTML=o,a=w(),g&&g.c(),u=w(),d=p("div"),i=p("div"),b=p("div"),v=p("label"),ie(P.$$.fragment),H=w(),x=p("span"),x.textContent=W,R=w(),S=p("input"),K=w(),m=p("div"),k=p("label"),ie(M.$$.fragment),fe=w(),L=p("span"),L.textContent=ke,de=w(),I=p("input"),me=w(),V=p("div"),F=p("label"),ie(T.$$.fragment),he=w(),j=p("span"),j.textContent=Ie,_e=w(),$=p("input"),be=w(),X=p("div"),A=p("label"),B=p("input"),ge=w(),U=p("span"),U.textContent=$e,ve=w(),N=p("button"),E&&E.c(),Y=je(`\r
          Continue to Map Setup`),this.h()},l(c){e=f(c,"DIV",{class:!0});var D=_(e);t=f(D,"DIV",{class:!0});var q=_(t);s=f(q,"DIV",{class:!0,"data-svelte-h":!0}),G(s)!=="svelte-vz9j3r"&&(s.innerHTML=o),a=y(q),g&&g.l(q),u=y(q),d=f(q,"DIV",{class:!0});var De=_(d);i=f(De,"DIV",{class:!0});var C=_(i);b=f(C,"DIV",{class:!0});var te=_(b);v=f(te,"LABEL",{class:!0});var se=_(v);ue(P.$$.fragment,se),H=y(se),x=f(se,"SPAN",{class:!0,"data-svelte-h":!0}),G(x)!=="svelte-8nvrpr"&&(x.textContent=W),se.forEach(h),R=y(te),S=f(te,"INPUT",{type:!0,placeholder:!0,class:!0}),te.forEach(h),K=y(C),m=f(C,"DIV",{class:!0});var ae=_(m);k=f(ae,"LABEL",{class:!0});var le=_(k);ue(M.$$.fragment,le),fe=y(le),L=f(le,"SPAN",{class:!0,"data-svelte-h":!0}),G(L)!=="svelte-7sy78g"&&(L.textContent=ke),le.forEach(h),de=y(ae),I=f(ae,"INPUT",{type:!0,placeholder:!0,class:!0}),ae.forEach(h),me=y(C),V=f(C,"DIV",{class:!0});var re=_(V);F=f(re,"LABEL",{class:!0});var ne=_(F);ue(T.$$.fragment,ne),he=y(ne),j=f(ne,"SPAN",{class:!0,"data-svelte-h":!0}),G(j)!=="svelte-1gejwx0"&&(j.textContent=Ie),ne.forEach(h),_e=y(re),$=f(re,"INPUT",{type:!0,placeholder:!0,class:!0}),re.forEach(h),be=y(C),X=f(C,"DIV",{class:!0});var Ce=_(X);A=f(Ce,"LABEL",{class:!0});var oe=_(A);B=f(oe,"INPUT",{type:!0,class:!0}),ge=y(oe),U=f(oe,"SPAN",{class:!0,"data-svelte-h":!0}),G(U)!=="svelte-a47vvs"&&(U.textContent=$e),oe.forEach(h),Ce.forEach(h),ve=y(C),N=f(C,"BUTTON",{class:!0});var we=_(N);E&&E.l(we),Y=Ue(we,`\r
          Continue to Map Setup`),we.forEach(h),C.forEach(h),De.forEach(h),q.forEach(h),D.forEach(h),this.h()},h(){r(s,"class","mb-16 text-center"),r(x,"class","label-text"),r(v,"class","label items-center gap-2"),r(S,"type","text"),r(S,"placeholder","Enter your full name"),r(S,"class","input input-bordered w-full"),S.required=!0,r(b,"class","form-control mb-6"),r(L,"class","label-text"),r(k,"class","label items-center gap-2"),r(I,"type","text"),r(I,"placeholder","Enter your company name"),r(I,"class","input input-bordered w-full"),I.required=!0,r(m,"class","form-control mb-6"),r(j,"class","label-text"),r(F,"class","label items-center gap-2"),r($,"type","tel"),r($,"placeholder","04XX XXX XXX"),r($,"class","input input-bordered w-full"),$.required=!0,r(V,"class","form-control mb-6"),r(B,"type","checkbox"),r(B,"class","checkbox checkbox-sm"),r(U,"class","label-text"),r(A,"class","label cursor-pointer justify-start gap-2"),r(X,"class","form-control mb-8"),r(N,"class","btn btn-primary w-full"),N.disabled=ee=!n[6]||n[5],r(i,"class","card-body"),r(d,"class","card bg-base-100 shadow-xl"),r(t,"class","mx-auto max-w-xl"),r(e,"class","min-h-screen bg-base-200 px-4 py-12")},m(c,D){Se(c,e,D),l(e,t),l(t,s),l(t,a),g&&g.m(t,null),l(t,u),l(t,d),l(d,i),l(i,b),l(b,v),ce(P,v,null),l(v,H),l(v,x),l(b,R),l(b,S),z(S,n[0]),l(i,K),l(i,m),l(m,k),ce(M,k,null),l(k,fe),l(k,L),l(m,de),l(m,I),z(I,n[1]),l(i,me),l(i,V),l(V,F),ce(T,F,null),l(F,he),l(F,j),l(V,_e),l(V,$),z($,n[2]),l(i,be),l(i,X),l(X,A),l(A,B),B.checked=n[4],l(A,ge),l(A,U),l(i,ve),l(i,N),E&&E.m(N,null),l(N,Y),Z=!0,Ee||(Ne=[O(S,"input",n[9]),O(I,"input",n[10]),O($,"input",n[11]),O($,"input",n[7]),O(B,"change",n[12]),O(N,"click",n[8])],Ee=!0)},p(c,[D]){c[3]?g?g.p(c,D):(g=Be(c),g.c(),g.m(t,u)):g&&(g.d(1),g=null),D&1&&S.value!==c[0]&&z(S,c[0]),D&2&&I.value!==c[1]&&z(I,c[1]),D&4&&z($,c[2]),D&16&&(B.checked=c[4]),c[5]?E||(E=Le(),E.c(),E.m(N,Y)):E&&(E.d(1),E=null),(!Z||D&96&&ee!==(ee=!c[6]||c[5]))&&(N.disabled=ee)},i(c){Z||(J(P.$$.fragment,c),J(M.$$.fragment,c),J(T.$$.fragment,c),Z=!0)},o(c){Q(P.$$.fragment,c),Q(M.$$.fragment,c),Q(T.$$.fragment,c),Z=!1},d(c){c&&h(e),g&&g.d(),pe(P),pe(M),pe(T),E&&E.d(),Ee=!1,Ke(Ne)}}}function ct(n){const e=n.replace(/\D/g,"");return e.length<=4?e:e.length<=7?`${e.slice(0,4)} ${e.slice(4)}`:`${e.slice(0,4)} ${e.slice(4,7)} ${e.slice(7,10)}`}function pt(n,e,t){let s,o;Ze(n,Fe,m=>t(13,o=m));let a=null,u="",d="",i="",b=!0,v=!1;function P(m){const k=m.target,M=ct(k.value);t(2,i=M)}async function H(){try{const{error:m}=await Ve.from("user_subscriptions").upsert({user_id:o.id,subscription:"FREE",marker_limit:100,trail_limit:1e4,current_seats:5,lingering_seats:0,next_billing_date:new Date(Date.now()+31536e6).toISOString()});if(m)throw m;Qe.set({subscription:"FREE",marker_limit:100,trail_limit:1e4,lingering_seats:0,current_seats:5,next_billing_date:new Date(Date.now()+365*24*60*60*1e3).toISOString()})}catch(m){throw console.error("Failed to setup subscription:",m),new Error("Failed to setup subscription")}}async function x(){if(!s){t(3,a="Please fill out all required fields");return}t(5,v=!0),t(3,a=null);try{await H();const{error:m}=await Ve.from("profiles").update({full_name:u,company_name:d,mobile:i,contactable:b,role:"manager",onboarded:!0,updated_at:new Date().toISOString()}).eq("id",o.id);if(m)throw m;Fe.update(k=>({...k,full_name:u,company_name:d,user_type:"manager"})),Ae.success("Setup completed successfully!"),Je("/account/user_survey")}catch(m){console.error("Error:",m),t(3,a=m.message||"Failed to update profile"),Ae.error(a)}finally{t(5,v=!1)}}function W(){u=this.value,t(0,u)}function R(){d=this.value,t(1,d)}function S(){i=this.value,t(2,i)}function K(){b=this.checked,t(4,b)}return n.$$.update=()=>{n.$$.dirty&7&&t(6,s=u.trim().length>0&&d.trim().length>0&&i.replace(/\D/g,"").length>=8&&i.replace(/\D/g,"").length<=10)},[u,d,i,a,b,v,s,P,x,W,R,S,K]}class kt extends Xe{constructor(e){super(),qe(this,e,pt,ut,Te,{})}}export{kt as component,St as universal};

import{r as Ne}from"../chunks/index.D6ASlNOC.js";import{s as Pe,n as ye,d as c,K as Me,b as e,U as B,q as Ce,i as G,a as r,A as te,w as Ie,f as C,c as u,e as P,g as z,h as K,k as N,j as i,t as W}from"../chunks/scheduler.BVGjjnGO.js";import{S as De,i as Le}from"../chunks/index.Vv2yv23T.js";/* empty css                    */import{g as Te}from"../chunks/entry.Do23-0vY.js";import{u as xe}from"../chunks/authHelpers.eck-BuaK.js";import{t as Se}from"../chunks/Toaster.svelte_svelte_type_style_lang.BcvbULy5.js";import{s as ce}from"../chunks/supabaseClient.CPicN285.js";async function qe({parent:s}){throw await s(),Ne(303,"/account/user_survey")}const Re=Object.freeze(Object.defineProperty({__proto__:null,load:qe},Symbol.toStringTag,{value:"Module"}));function Ee(s){let p,t,f,l=(s[0]?.errorMessage||s[5])+"",b;return{c(){p=i("div"),t=N(),f=i("p"),b=W(l),this.h()},l(d){p=u(d,"DIV",{class:!0}),P(p).forEach(c),t=C(d),f=u(d,"P",{class:!0});var n=P(f);b=K(n,l),n.forEach(c),this.h()},h(){e(p,"class","mt-4"),e(f,"class","mt-3 text-center text-sm font-bold text-red-700")},m(d,n){G(d,p,n),G(d,t,n),G(d,f,n),r(f,b)},p(d,n){n&33&&l!==(l=(d[0]?.errorMessage||d[5])+"")&&Ce(b,l)},d(d){d&&(c(p),c(t),c(f))}}}function Fe(s){let p,t,f,l,b,d="Create Profile",n,o,v,g,I='<span class="label-text">Name</span>',j,h,k,Y,D,m,L='<span class="label-text">Company Name</span>',S,w,q,re,F,V,me='<span class="label-text">Company Website</span>',se,E,J,ae,Q,O,x,R=s[1]?"...":"Create Profile",X,le,M,oe,pe=s[6]?.user?.email+"",ne,ue,ie,de,H,_e="Sign out",fe,he,_=(s[0]?.errorMessage||s[5])&&Ee(s);return{c(){p=N(),t=i("div"),f=i("div"),l=i("div"),b=i("h1"),b.textContent=d,n=N(),o=i("form"),v=i("div"),g=i("label"),g.innerHTML=I,j=N(),h=i("input"),Y=N(),D=i("div"),m=i("label"),m.innerHTML=L,S=N(),w=i("input"),re=N(),F=i("div"),V=i("label"),V.innerHTML=me,se=N(),E=i("input"),ae=N(),_&&_.c(),Q=N(),O=i("div"),x=i("button"),X=W(R),le=N(),M=i("div"),oe=W("You are logged in as "),ne=W(pe),ue=W(`.\r
        `),ie=i("br"),de=N(),H=i("a"),H.textContent=_e,this.h()},l(a){Ie("svelte-uj7g5q",document.head).forEach(c),p=C(a),t=u(a,"DIV",{class:!0});var be=P(t);f=u(be,"DIV",{class:!0});var ve=P(f);l=u(ve,"DIV",{});var U=P(l);b=u(U,"H1",{class:!0,"data-svelte-h":!0}),z(b)!=="svelte-1p9sc6d"&&(b.textContent=d),n=C(U),o=u(U,"FORM",{class:!0});var T=P(o);v=u(T,"DIV",{class:!0});var Z=P(v);g=u(Z,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(g)!=="svelte-g3q01w"&&(g.innerHTML=I),j=C(Z),h=u(Z,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),Z.forEach(c),Y=C(T),D=u(T,"DIV",{class:!0});var $=P(D);m=u($,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(m)!=="svelte-16532ax"&&(m.innerHTML=L),S=C($),w=u($,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),$.forEach(c),re=C(T),F=u(T,"DIV",{class:!0});var ee=P(F);V=u(ee,"LABEL",{for:!0,class:!0,"data-svelte-h":!0}),z(V)!=="svelte-1fqkhyk"&&(V.innerHTML=me),se=C(ee),E=u(ee,"INPUT",{id:!0,type:!0,placeholder:!0,class:!0}),ee.forEach(c),ae=C(T),_&&_.l(T),Q=C(T),O=u(T,"DIV",{class:!0});var ge=P(O);x=u(ge,"BUTTON",{type:!0,class:!0});var we=P(x);X=K(we,R),we.forEach(c),ge.forEach(c),T.forEach(c),le=C(U),M=u(U,"DIV",{class:!0});var A=P(M);oe=K(A,"You are logged in as "),ne=K(A,pe),ue=K(A,`.\r
        `),ie=u(A,"BR",{}),de=C(A),H=u(A,"A",{class:!0,href:!0,"data-svelte-h":!0}),z(H)!=="svelte-bkrsgd"&&(H.textContent=_e),A.forEach(c),U.forEach(c),ve.forEach(c),be.forEach(c),this.h()},h(){document.title="Create Profile",e(b,"class","mb-6 text-2xl font-bold"),e(g,"for","fullName"),e(g,"class","label"),e(h,"id","fullName"),e(h,"type","text"),e(h,"placeholder","Your full name"),e(h,"class",k=(s[7](s[0],"fullName")?"input-error":"")+" input input-bordered mt-1 w-full max-w-xs border-2 border-primary"),h.required=!0,e(v,"class","mt-4"),e(m,"for","companyName"),e(m,"class","label"),e(w,"id","companyName"),e(w,"type","text"),e(w,"placeholder","Homewood Farms"),e(w,"class",q=(s[7](s[0],"companyName")?"input-error":"")+" input input-bordered mt-1 w-full max-w-xs"),e(D,"class","mt-4"),e(V,"for","website"),e(V,"class","label"),e(E,"id","website"),e(E,"type","text"),e(E,"placeholder","Company.com"),e(E,"class",J=(s[7](s[0],"website")?"input-error":"")+" input input-bordered mt-1 w-full max-w-xs"),e(F,"class","mt-4"),e(x,"type","submit"),e(x,"class","btn btn-primary btn-wide mt-3"),x.disabled=s[1],e(O,"class","mt-4"),e(o,"class","form-widget"),e(H,"class","underline"),e(H,"href","/features/"),e(M,"class","mt-14 text-sm text-slate-800"),e(f,"class","flex w-64 flex-col lg:w-80"),e(t,"class","mx-auto mb-12 flex min-h-[100vh] max-w-lg place-content-center content-center items-center text-center")},m(a,y){G(a,p,y),G(a,t,y),r(t,f),r(f,l),r(l,b),r(l,n),r(l,o),r(o,v),r(v,g),r(v,j),r(v,h),B(h,s[2]),r(o,Y),r(o,D),r(D,m),r(D,S),r(D,w),B(w,s[3]),r(o,re),r(o,F),r(F,V),r(F,se),r(F,E),B(E,s[4]),r(o,ae),_&&_.m(o,null),r(o,Q),r(o,O),r(O,x),r(x,X),r(l,le),r(l,M),r(M,oe),r(M,ne),r(M,ue),r(M,ie),r(M,de),r(M,H),fe||(he=[te(h,"input",s[10]),te(w,"input",s[11]),te(E,"input",s[12]),te(o,"submit",s[8])],fe=!0)},p(a,[y]){y&1&&k!==(k=(a[7](a[0],"fullName")?"input-error":"")+" input input-bordered mt-1 w-full max-w-xs border-2 border-primary")&&e(h,"class",k),y&4&&h.value!==a[2]&&B(h,a[2]),y&1&&q!==(q=(a[7](a[0],"companyName")?"input-error":"")+" input input-bordered mt-1 w-full max-w-xs")&&e(w,"class",q),y&8&&w.value!==a[3]&&B(w,a[3]),y&1&&J!==(J=(a[7](a[0],"website")?"input-error":"")+" input input-bordered mt-1 w-full max-w-xs")&&e(E,"class",J),y&16&&E.value!==a[4]&&B(E,a[4]),a[0]?.errorMessage||a[5]?_?_.p(a,y):(_=Ee(a),_.c(),_.m(o,Q)):_&&(_.d(1),_=null),y&2&&R!==(R=a[1]?"...":"Create Profile")&&Ce(X,R),y&2&&(x.disabled=a[1])},i:ye,o:ye,d(a){a&&(c(p),c(t)),_&&_.d(),fe=!1,Me(he)}}}function Ve(s,p,t){let{data:f}=p,{form:l}=p,{session:b,profile:d}=f,n=!1,o=d?.full_name??"",v=d?.company_name??"",g=d?.website??"",I=null;const j=(m,L)=>(m?.errorFields??[]).includes(L),h=async m=>{m.preventDefault(),t(1,n=!0);try{if(!o){t(5,I="Name is required"),t(0,l={errorMessage:"Name is required",errorFields:["fullName"]}),t(1,n=!1);return}const{error:L}=await ce.auth.updateUser({data:{full_name:o}});if(L){console.error("Error updating user metadata:",L),t(5,I=L.message||"Failed to update user data"),t(1,n=!1);return}const{data:S}=await ce.auth.getSession();if(!S.session){t(5,I="Session not found"),t(1,n=!1);return}if(!await xe(S.session)){t(5,I="Failed to create profile"),t(1,n=!1);return}const{error:q}=await ce.from("profiles").update({company_name:v,website:g,updated_at:new Date().toISOString()}).eq("id",S.session.user.id);if(q){console.error("Error updating additional profile fields:",q),t(5,I=q.message||"Failed to update profile details"),t(1,n=!1);return}Se.success("Profile created successfully"),console.log("Profile created successfully"),Te("/account/user_survey")}catch(L){console.error("Error in profile creation:",L),t(5,I="An unexpected error occurred. Please try again."),t(0,l={errorMessage:"An unexpected error occurred. Please try again.",errorFields:[]})}finally{t(1,n=!1)}};function k(){o=this.value,t(2,o)}function Y(){v=this.value,t(3,v)}function D(){g=this.value,t(4,g)}return s.$$set=m=>{"data"in m&&t(9,f=m.data),"form"in m&&t(0,l=m.form)},s.$$.update=()=>{s.$$.dirty&1&&l&&console.log("Form result:",l)},[l,n,o,v,g,I,b,j,h,f,k,Y,D]}class ze extends De{constructor(p){super(),Le(this,p,Ve,Fe,Pe,{data:9,form:0})}}export{ze as component,Re as universal};

import{i as Tr,s as Ot}from"../chunks/sessionStore.b46579ea.js";import"../chunks/index.3feb4388.js";import{d as Qt,w as we}from"../chunks/index.42bd087b.js";import{s as ie,r as Q,E as Ie,F as Ae,b as B,d as w,i as P,T as tt,j as R,k as M,n as de,v as ge,m as ke,u as ye,o as Te,p as Ce,a1 as $r,y as Xt,w as oe,O as Ee,l as re,A as He,e as N,c as V,N as Be,$ as rt,B as Me,K as vt,z as Xe,Q as gt,a as X,g as $e,f as Z,G as or,I as Oe,a5 as Gr,aq as mo,a6 as Mr,t as _e,h as be,_ as St,D as nn,q as Fe,X as Mt,a2 as Bl,P as Nt,L as go}from"../chunks/scheduler.0ff5556b.js";import{S as se,i as ae,c as W,a as J,m as G,t as C,b as S,d as Y,g as he,e as me,h as Ir}from"../chunks/index.e3d1f712.js";import{g as Nr}from"../chunks/navigation.22654e78.js";import{t as fe}from"../chunks/Toaster.svelte_svelte_type_style_lang.7b1bf8eb.js";import{m as Ke,a as po,w as _o,M as bo,d as mn}from"../chunks/MapViewer.svelte_svelte_type_style_lang.9cbd54cb.js";import{e as ht}from"../chunks/each.1577e3f3.js";import{v as gn,I as Ul,S as It,R as vo}from"../chunks/v4.3c2c735a.js";import{_ as wo}from"../chunks/preload-helper.a4192956.js";import"../chunks/index.d7bd5d03.js";import{C as Yr}from"../chunks/card.84024428.js";import{C as Rl,a as Fl,b as Hl}from"../chunks/card-title.acdfdd9f.js";import{g as Le,a as nt}from"../chunks/spread.8a54911c.js";import{n as ir,v as ko,w as ze,m as _t,s as dt,q as At,p as Ye,a as Vt,b as Wt,i as pt,o as jl,f as ql,d as Vr,x as pn,c as yo,h as zr,k as et}from"../chunks/create.68466a8a.js";import{t as Xr,o as To,r as Wl,g as Gl}from"../chunks/updater.3a05dd56.js";import{g as Yl}from"../chunks/id.b8917160.js";import{c as Xl,a as Co}from"../chunks/events.b005e1da.js";import{c as mt}from"../chunks/utils.ce6287f2.js";import{g as Eo,R as So,T as $o,a as Br}from"../chunks/index.453afe1e.js";import{a as Mo,b as Io}from"../chunks/platform.97957bf5.js";import{B as Gt}from"../chunks/button.4eb00373.js";import{E as ln,M as Zl}from"../chunks/square-pen.e5514f1d.js";import{I as sr}from"../chunks/Icon.c7f64379.js";import{I as Ao,f as Lo}from"../chunks/fileApi.1fa0edcf.js";import{m as Jl}from"../chunks/mapActivityStore.e6a2ac64.js";import{p as on}from"../chunks/profileStore.99d1945a.js";import{s as Ve}from"../chunks/supabaseClient.998d708c.js";import{p as Po}from"../chunks/stores.3b20c088.js";import{X as Kl}from"../chunks/x.add80b09.js";import"../chunks/paths.a4831724.js";import{d as pr,r as Do,c as wr,p as tr,f as Ql,a as Cr,b as Oo,e as _n,g as No}from"../chunks/index.abbb3c7d.js";import{T as xl}from"../chunks/trash-2.36e6d56b.js";import{a as Vo}from"../chunks/authHelpers.584af170.js";import{A as zo}from"../chunks/arrow-right.4a7b62ee.js";import{A as Bo}from"../chunks/arrow-left.fe80054f.js";import{s as bn}from"../chunks/operationStore.2d5735a4.js";function Uo(l){let e,r,t=[{xmlns:"http://www.w3.org/2000/svg"},{width:"24"},{height:"24"},{fill:"currentColor"},{viewBox:"0 0 17.2 17.2"},l[0]],n={};for(let o=0;o<t.length;o+=1)n=Q(n,t[o]);return{c(){e=Ie("svg"),r=Ie("path"),this.h()},l(o){e=Ae(o,"svg",{xmlns:!0,width:!0,height:!0,fill:!0,viewBox:!0});var i=B(e);r=Ae(i,"path",{d:!0}),B(r).forEach(w),i.forEach(w),this.h()},h(){P(r,"d","M8.6.8C6.1.8 4.1 2.9 4.1 5.6c0 1.2.9 2.8 1.9 4s1.9 2.1 1.9 2.1c.2.2.5.3.7.3s.5-.1.7-.3c0 0 1-.9 1.9-2.1s1.9-2.7 1.9-4c0-2.7-2-4.8-4.5-4.8m0 1.1c.1 0 .3.1.3.3v.3c1.4.1 2.5 1.2 2.6 2.6h.3c.4 0 .4.5 0 .5h-.3c-.1 1.4-1.2 2.5-2.6 2.6v.3q0 .3-.3.3c-.1 0-.3-.1-.3-.3v-.3c-1.4-.1-2.5-1.3-2.6-2.6h-.3c-.3 0-.3-.6 0-.6h.3c.1-1.4 1.2-2.5 2.6-2.6v-.3c0-.2.2-.2.3-.2m-.3 1C7.2 3 6.4 3.9 6.2 5h.2c.4 0 .4.5 0 .5h-.2c.1 1.1 1 2 2.1 2.1v-.2q0-.3.3-.3c.3 0 .3.1.3.3v.2c1.1-.1 2-1 2.1-2.1h-.2c-.4 0-.4-.5 0-.5h.2c-.1-1.1-1-2-2.1-2.1v.3q0 .3-.3.3c-.1 0-.3-.1-.3-.3zM8.6 5c.1 0 .3.1.3.3 0 .1-.1.3-.3.3-.1 0-.3-.1-.3-.3s.2-.3.3-.3M4.8 8.8c-1.4.5-2.4 1.1-3 1.9q-.45.6-.6 1.2h.3c.4 0 .4.5 0 .5h-.3c0 .2.1.5.2.7.4.9 1.3 1.6 2.6 2.2 1.2.5 2.7.8 4.3.9v-.3q0-.3.3-.3c.3 0 .3.1.3.3v.3c1.6 0 3.1-.3 4.3-.9 1.3-.5 2.2-1.3 2.6-2.2.1-.2.2-.5.2-.7h-.3c-.4 0-.4-.5 0-.5h.3q-.15-.6-.6-1.2c-.6-.7-1.6-1.4-3-1.9-.2.4-.5.7-.8 1.1-.1.1-.1.2-.2.2 1 .2 1.8.5 2.3 1 .3.2.5.5.6.8v.1h.3c.4 0 .4.5 0 .5h-.3c0 .1-.1.2-.1.3-.3.6-1.1 1-2.1 1.3-.9.3-2.1.4-3.3.5v.3q0 .3-.3.3c-.1 0-.3-.1-.3-.3v-.3c-1.2 0-2.4-.2-3.3-.5-1-.3-1.8-.7-2.1-1.3-.1-.1-.1-.2-.1-.3h-.2c-.4 0-.4-.5 0-.5h.3v-.1c.1-.3.3-.6.6-.8.5-.4 1.3-.7 2.3-1 0-.1-.1-.2-.1-.2-.3-.4-.6-.7-.8-1.1m1.3 1.7q-1.65.3-2.4.9c-.2.2-.3.3-.4.5h.2c.4 0 .4.5 0 .5h-.1v.1c.2.4.9.8 1.8 1.1s2 .4 3.1.4v-.3q0-.3.3-.3c.1 0 .3.1.3.3v.3c1.2 0 2.3-.2 3.1-.4.9-.3 1.6-.7 1.8-1.1v-.1h-.2c-.4 0-.4-.5 0-.5h.2c-.1-.1-.2-.3-.4-.5q-.75-.6-2.4-.9c-.7.8-1.3 1.4-1.4 1.4-.3.3-.7.5-1.1.5s-.7-.1-1-.4c0-.1-.6-.6-1.4-1.5"),tt(e,n)},m(o,i){R(o,e,i),M(e,r)},p(o,[i]){tt(e,n=Le(t,[{xmlns:"http://www.w3.org/2000/svg"},{width:"24"},{height:"24"},{fill:"currentColor"},{viewBox:"0 0 17.2 17.2"},i&1&&o[0]]))},i:de,o:de,d(o){o&&w(e)}}}function Ro(l,e,r){return l.$$set=t=>{r(0,e=Q(Q({},e),ge(t)))},e=ge(e),[e]}let Fo=class extends se{constructor(e){super(),ae(this,e,Ro,Uo,ie,{})}};function Ho(l){let e,r,t,n,o=[{xmlns:"http://www.w3.org/2000/svg"},{width:"24"},{height:"24"},{viewBox:"0 0 46.6 53.2"},l[0]],i={};for(let c=0;c<o.length;c+=1)i=Q(i,o[c]);return{c(){e=Ie("svg"),r=Ie("path"),t=Ie("path"),n=Ie("path"),this.h()},l(c){e=Ae(c,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0});var s=B(e);r=Ae(s,"path",{d:!0}),B(r).forEach(w),t=Ae(s,"path",{d:!0}),B(t).forEach(w),n=Ae(s,"path",{d:!0}),B(n).forEach(w),s.forEach(w),this.h()},h(){P(r,"d","M42.6 44.7c0 3.3-8.7 5.9-19.3 5.9S3.9 48 3.9 44.7c0-2.5 5.1-4.7 12.4-5.5 1.9 2.5 3.7 4.6 4.9 6.1.5.6 1.3.9 2 .9.8 0 1.5-.3 2-.9 1.3-1.5 3.1-3.7 4.9-6.1 7.4.8 12.5 3 12.5 5.5M23.3 8.5C17.6 8.5 13 13.1 13 18.7S17.6 29 23.3 29s10.2-4.6 10.2-10.2S28.9 8.5 23.3 8.5m6.7 9.7-6 1.2-1.2 6c0 .2-.2.4-.5.4-.2 0-.4-.1-.5-.3l-4.1-11.7c-.1-.2 0-.4.1-.5s.3-.2.5-.1L30 17.3c.2.1.3.3.3.5.1.2 0 .4-.3.4"),P(t,"d","M23.3 2.4c-9 0-16.4 7.3-16.4 16.4 0 7.5 11.3 21.4 15.1 25.9.7.8 1.9.8 2.5 0 3.8-4.5 15.1-18.4 15.1-25.9 0-9.1-7.3-16.4-16.3-16.4m0 27.6c-6.2 0-11.2-5-11.2-11.2s5-11.2 11.2-11.2 11.2 5 11.2 11.2S29.5 30 23.3 30"),P(n,"d","m22.2 23.4.9-4.5c0-.2.2-.4.4-.4l4.5-.9-9-3.2z"),tt(e,i)},m(c,s){R(c,e,s),M(e,r),M(e,t),M(e,n)},p(c,[s]){tt(e,i=Le(o,[{xmlns:"http://www.w3.org/2000/svg"},{width:"24"},{height:"24"},{viewBox:"0 0 46.6 53.2"},s&1&&c[0]]))},i:de,o:de,d(c){c&&w(e)}}}function jo(l,e,r){return l.$$set=t=>{r(0,e=Q(Q({},e),ge(t)))},e=ge(e),[e]}let qo=class extends se{constructor(e){super(),ae(this,e,jo,Ho,ie,{})}};function Wo(l){let e,r,t,n=[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 475.3 476.6"},l[0]],o={};for(let i=0;i<n.length;i+=1)o=Q(o,n[i]);return{c(){e=Ie("svg"),r=Ie("path"),t=Ie("path"),this.h()},l(i){e=Ae(i,"svg",{xmlns:!0,viewBox:!0});var c=B(e);r=Ae(c,"path",{d:!0}),B(r).forEach(w),t=Ae(c,"path",{d:!0}),B(t).forEach(w),c.forEach(w),this.h()},h(){P(r,"d","M235.1 25.7c-56.3 0-102 45.7-102 102s45.7 102 102 102 102-45.7 102-102c-.1-56.4-45.7-102-102-102m-64.3 145.9c-4.9 2.5-10.9.6-13.4-4.4-1.9-3.6-3.5-7.4-4.8-11.3-1.8-5.2 1-10.9 6.2-12.7s10.9 1 12.7 6.2c1 3 2.2 5.9 3.7 8.7 2.5 4.9.5 11-4.4 13.5m44.3-108.1c-26.1 8-44.7 31.1-47 58.4-.4 5.2-4.8 9.2-10 9.2h-.9c-5.5-.5-9.6-5.3-9.1-10.8 2.9-35.4 27.1-65.4 61-75.8 5.3-1.7 10.9 1.3 12.6 6.5s-1.4 10.8-6.6 12.5M230.1 392.1c3 2.1 7.1 2.1 10.1 0l10.3-143.4c-10.2 1.3-20.6 1.3-30.9 0z"),P(t,"d","M207.8 361.9c-34 2.1-65 8.1-88 17.1-21.7 8.5-34.7 19.1-34.7 28.3 0 19.3 57.1 46.3 150 46.3s150-27 150-46.3c0-9.3-13-19.8-34.7-28.3-23.1-9-54.1-15-88-17.1l-2.3 32c-.8 11.3-11.6 19.8-25 19.8s-24.1-8.5-25-19.8z"),tt(e,o)},m(i,c){R(i,e,c),M(e,r),M(e,t)},p(i,[c]){tt(e,o=Le(n,[{xmlns:"http://www.w3.org/2000/svg"},{viewBox:"0 0 475.3 476.6"},c&1&&i[0]]))},i:de,o:de,d(i){i&&w(e)}}}function Go(l,e,r){return l.$$set=t=>{r(0,e=Q(Q({},e),ge(t)))},e=ge(e),[e]}let Yo=class extends se{constructor(e){super(),ae(this,e,Go,Wo,ie,{})}};function Xo(l){let e,r,t=[{xmlns:"http://www.w3.org/2000/svg"},{width:"24"},{height:"24"},{viewBox:"0 0 100 100"},l[0]],n={};for(let o=0;o<t.length;o+=1)n=Q(n,t[o]);return{c(){e=Ie("svg"),r=Ie("path"),this.h()},l(o){e=Ae(o,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0});var i=B(e);r=Ae(i,"path",{fill:!0,d:!0,color:!0}),B(r).forEach(w),i.forEach(w),this.h()},h(){P(r,"fill","currentColor"),P(r,"d","M49.968 3.92a4.9 4.9 0 0 0-3.302 1.287L1.476 45.05l-.042.038C-.02 46.433-.358 48.628.374 50.23s2.448 2.749 4.394 2.75H16.42v38.508c0 2.629 2.288 4.59 4.797 4.591h57.564c2.509 0 4.797-1.962 4.797-4.59V52.98h11.653c1.946 0 3.662-1.146 4.394-2.749.732-1.602.394-3.798-1.06-5.143l-.042-.038-45.19-39.843a4.9 4.9 0 0 0-3.366-1.287M50 28.207c10.6 0 19.283 8.66 19.283 19.229 0 2.545-.507 4.979-1.42 7.208a11 11 0 0 1-.736 1.704l-14.79 25.17c-1.562 2.117-2.81 2.583-4.689.13l-13.41-23.181a19.05 19.05 0 0 1-3.521-11.031c0-10.57 8.683-19.23 19.283-19.23m0 9.01c-5.708 0-10.248 4.527-10.248 10.219S44.292 57.654 50 57.654s10.248-4.527 10.248-10.218c0-5.692-4.54-10.218-10.248-10.218"),P(r,"color","currentColor"),tt(e,n)},m(o,i){R(o,e,i),M(e,r)},p(o,[i]){tt(e,n=Le(t,[{xmlns:"http://www.w3.org/2000/svg"},{width:"24"},{height:"24"},{viewBox:"0 0 100 100"},i&1&&o[0]]))},i:de,o:de,d(o){o&&w(e)}}}function Zo(l,e,r){return l.$$set=t=>{r(0,e=Q(Q({},e),ge(t)))},e=ge(e),[e]}let Jo=class extends se{constructor(e){super(),ae(this,e,Zo,Xo,ie,{})}};function Ko(l){let e,r,t,n,o=[{xmlns:"http://www.w3.org/2000/svg"},{width:"1em"},{height:"1em"},{viewBox:"0 0 24 24"},l[0]],i={};for(let c=0;c<o.length;c+=1)i=Q(i,o[c]);return{c(){e=Ie("svg"),r=Ie("path"),t=Ie("path"),n=Ie("path"),this.h()},l(c){e=Ae(c,"svg",{xmlns:!0,width:!0,height:!0,viewBox:!0});var s=B(e);r=Ae(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),B(r).forEach(w),t=Ae(s,"path",{d:!0,opacity:!0}),B(t).forEach(w),n=Ae(s,"path",{"fill-rule":!0,d:!0,"clip-rule":!0}),B(n).forEach(w),s.forEach(w),this.h()},h(){P(r,"fill-rule","evenodd"),P(r,"d","M1.25 3A.75.75 0 0 1 2 2.25h20a.75.75 0 0 1 0 1.5H2A.75.75 0 0 1 1.25 3"),P(r,"clip-rule","evenodd"),P(t,"d","M4 3.75v9.527c0 1.34 0 2.01.268 2.601s.772 1.032 1.781 1.915l2 1.75c1.883 1.647 2.824 2.47 3.951 2.47s2.069-.823 3.951-2.47l2-1.75c1.008-.883 1.513-1.324 1.78-1.915.269-.59.269-1.26.269-2.6V3.75z"),P(t,"opacity",".5"),P(n,"fill-rule","evenodd"),P(n,"d","M7.75 14a.75.75 0 0 1 .75-.75h7a.75.75 0 0 1 0 1.5h-7a.75.75 0 0 1-.75-.75m0-5a.75.75 0 0 1 .75-.75h7a.75.75 0 0 1 0 1.5h-7A.75.75 0 0 1 7.75 9"),P(n,"clip-rule","evenodd"),tt(e,i)},m(c,s){R(c,e,s),M(e,r),M(e,t),M(e,n)},p(c,[s]){tt(e,i=Le(o,[{xmlns:"http://www.w3.org/2000/svg"},{width:"1em"},{height:"1em"},{viewBox:"0 0 24 24"},s&1&&c[0]]))},i:de,o:de,d(c){c&&w(e)}}}function Qo(l,e,r){return l.$$set=t=>{r(0,e=Q(Q({},e),ge(t)))},e=ge(e),[e]}let xo=class extends se{constructor(e){super(),ae(this,e,Qo,Ko,ie,{})}};function ei(l){let e,r,t,n,o,i,c=[{xmlns:"http://www.w3.org/2000/svg"},{width:"500"},{height:"500"},{version:"1.0"},{viewBox:"0 0 375 375"},l[0]],s={};for(let a=0;a<c.length;a+=1)s=Q(s,c[a]);return{c(){e=Ie("svg"),r=Ie("defs"),t=Ie("clipPath"),n=Ie("path"),o=Ie("g"),i=Ie("path"),this.h()},l(a){e=Ae(a,"svg",{xmlns:!0,width:!0,height:!0,version:!0,viewBox:!0});var u=B(e);r=Ae(u,"defs",{});var f=B(r);t=Ae(f,"clipPath",{id:!0});var p=B(t);n=Ae(p,"path",{d:!0}),B(n).forEach(w),p.forEach(w),f.forEach(w),o=Ae(u,"g",{"clip-path":!0});var h=B(o);i=Ae(h,"path",{d:!0}),B(i).forEach(w),h.forEach(w),u.forEach(w),this.h()},h(){P(n,"d","M25.875 26.125h323.25v322.5H25.875Zm0 0"),P(t,"id","306eb0ec9e"),P(i,"d","M208.586 26.48c-.402.204-1.063.657-1.414 1.06-.356.405-3.863 6.737-7.805 14.105-3.937 7.343-7.523 13.957-7.98 14.687-1.336 2.121-1.235 2.094-8.282 2.371l-6.238.281-1.34-.656c-1.336-.656-1.488-.86-10.504-13.855-5.05-7.243-9.421-13.528-9.75-13.953-.73-.985-2.02-1.618-3.332-1.618-1.086 0-29.648 9.489-30.632 10.172-1.465 1.031-1.77 2.242-1.493 5.93.61 7.469 1.797 22.508 2.047 25.965l.305 3.86-.734 1.44c-.707 1.387-.957 1.614-5.91 5.047-2.852 1.97-5.579 3.707-6.06 3.86-2.07.605-2.323.531-18.585-6.207-16.695-6.914-16.215-6.739-18.184-5.856-.96.453-19.722 23.774-20.101 24.985-.203.73-.203 1.21 0 1.941.199.633 3.836 5.629 10.152 13.93 8.535 11.254 9.871 13.148 10.125 14.23.356 1.64.356 1.64-2.93 9.465-2.902 6.988-3.558 7.973-5.53 8.68-.579.203-8.18 1.668-16.946 3.23-16.668 2.977-16.742 3.004-17.852 4.52-1.316 1.765-4.574 31.996-3.511 32.625.152.101 7.398 2.777 16.086 5.957s16.164 6.004 16.593 6.258c1.664.96 2.043 2.043 3.559 10.421.785 4.266 1.414 8.278 1.414 8.958 0 .785-.227 1.64-.582 2.296-.375.735-4.215 4.47-12.422 12.09-6.543 6.055-12.098 11.38-12.375 11.781-.328.532-.48 1.188-.457 2.047 0 1.16.633 2.446 6.441 13.727 3.563 6.84 6.77 12.77 7.149 13.172.351.379 1.137.832 1.715.984.984.277 2.199.05 16.843-3.254 16.52-3.734 17.098-3.812 18.942-2.953.984.48 12.73 12.594 13.437 13.856.957 1.765.907 2.27-1.668 12.312-5.933 23.14-5.808 22.637-5.48 23.723.152.554.555 1.285.86 1.636.3.356 6.109 3.762 12.902 7.57 11.187 6.286 12.476 6.942 13.511 6.942.684 0 1.493-.203 1.922-.453.426-.277 5.805-5.601 11.992-11.887 6.188-6.285 11.645-11.632 12.176-11.886 1.84-.985 2.348-.934 11.59 1.136 4.773 1.059 8.965 2.094 9.293 2.32 1.742 1.137 1.844 1.364 7.223 17.516 5.078 15.215 5.226 15.617 6.187 16.477.555.504 1.39.96 1.945 1.058 2.297.43 16.618-.476 25.758-1.64 4.14-.528 5.028-.957 5.735-2.852.226-.605 1.894-8.125 3.687-16.703 2.172-10.246 3.457-15.898 3.762-16.402.984-1.567 1.715-1.946 9.418-4.871 8.308-3.18 9.37-3.407 11.215-2.422.453.25 6.261 4.82 12.879 10.168 6.64 5.351 12.398 9.918 12.828 10.172.554.328 1.136.43 2.097.351 1.286-.074 1.567-.277 8.813-5.754 14.723-11.129 16.113-12.21 16.59-12.894.28-.352.558-1.211.61-1.89.124-1.114-.38-2.575-5.735-16.606-3.23-8.48-5.934-15.797-5.985-16.278-.254-1.742.328-2.824 4.368-8.379 2.171-2.949 4.195-5.652 4.496-5.953.882-.984 2.398-1.64 3.812-1.617.684 0 8.234.758 16.746 1.692l15.453 1.668 1.086-.481c.582-.277 1.262-.707 1.516-.984.355-.403 9.191-24.075 10.656-28.54.559-1.64.203-3.03-1.086-4.343-.504-.528-6.765-5.246-13.914-10.496-12.828-9.414-12.98-9.54-13.613-10.926l-.63-1.387.302-5.426c.406-7.093.457-7.421 1.39-8.78.758-1.087 1.34-1.415 15.48-8.509 8.106-4.062 14.9-7.543 15.13-7.718.554-.48 1.363-2.145 1.363-2.828 0-1.06-6.543-30.711-6.945-31.493-.227-.43-.809-1.035-1.34-1.386-1.059-.684.027-.606-25.582-2.246-9.824-.633-10-.684-11.488-2.094-1.086-1.035-5.633-9.59-5.81-10.953-.1-.684 0-1.516.2-2.121.203-.555 4.094-7.293 8.637-14.965 7.93-13.32 8.285-13.977 8.285-15.192-.027-.68-.176-1.511-.355-1.867-.329-.629-21.465-22.305-22.676-23.238-.38-.305-1.137-.531-2.02-.582l-1.441-.102-14.242 7.899c-7.828 4.34-14.7 8.05-15.254 8.254-1.742.605-2.88.226-7.578-2.399-4.746-2.648-5.25-3.027-5.985-4.465-.656-1.261-.629-.933-1.238-18.953-.504-14.887-.527-15.418-1.086-16.527-.934-1.895.91-1.34-24.848-7.469-4.343-1.012-8.156-1.871-8.46-1.871-.301.027-.883.18-1.313.355m-9.723 66.872c6.946.91 12.703 2.195 18.688 4.187 31.793 10.5 56.14 37.856 62.73 70.457 1.442 7.14 1.77 10.574 1.77 18.875.023 7.824-.102 9.742-1.137 16.024-4.851 29.5-24.117 55.44-51.113 68.765-10.23 5.047-19.07 7.695-31.442 9.387-3.867.531-17.957.43-22.226-.125-22.07-3.004-41.313-12.594-56.317-28.086-21.437-22.156-30.605-52.691-25-83.274 3.688-20.113 14.621-39.316 30.204-53.07 15.378-13.55 34.144-21.601 54.777-23.469 3.812-.351 15.355-.152 19.066.329m0 0"),P(o,"clip-path","url(#306eb0ec9e)"),tt(e,s)},m(a,u){R(a,e,u),M(e,r),M(r,t),M(t,n),M(e,o),M(o,i)},p(a,[u]){tt(e,s=Le(c,[{xmlns:"http://www.w3.org/2000/svg"},{width:"500"},{height:"500"},{version:"1.0"},{viewBox:"0 0 375 375"},u&1&&a[0]]))},i:de,o:de,d(a){a&&w(e)}}}function ti(l,e,r){return l.$$set=t=>{r(0,e=Q(Q({},e),ge(t)))},e=ge(e),[e]}class ri extends se{constructor(e){super(),ae(this,e,ti,ei,ie,{})}}const vn={bill_bold_duotone:xo,location_target:Fo,location_pointer:qo,location_drop:Yo,locate_home:Jo,skan:ri};function ni(l){let e;const r=l[2].default,t=ke(r,l,l[3],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&8)&&ye(t,r,n,n[3],e?Ce(r,n[3],o,null):Te(n[3]),null)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function li(l){let e,r;const t=[{name:"gauge"},l[1],{iconNode:l[0]}];let n={$$slots:{default:[ni]},$$scope:{ctx:l}};for(let o=0;o<t.length;o+=1)n=Q(n,t[o]);return e=new sr({props:n}),{c(){W(e.$$.fragment)},l(o){J(e.$$.fragment,o)},m(o,i){G(e,o,i),r=!0},p(o,[i]){const c=i&3?Le(t,[t[0],i&2&&nt(o[1]),i&1&&{iconNode:o[0]}]):{};i&8&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){r||(C(e.$$.fragment,o),r=!0)},o(o){S(e.$$.fragment,o),r=!1},d(o){Y(e,o)}}}function oi(l,e,r){let{$$slots:t={},$$scope:n}=e;const o=[["path",{d:"m12 14 4-4"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0"}]];return l.$$set=i=>{r(1,e=Q(Q({},e),ge(i))),"$$scope"in i&&r(3,n=i.$$scope)},e=ge(e),[o,e,t,n]}class ii extends se{constructor(e){super(),ae(this,e,oi,li,ie,{})}}const si=ii;function ai(l){let e;const r=l[2].default,t=ke(r,l,l[3],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&8)&&ye(t,r,n,n[3],e?Ce(r,n[3],o,null):Te(n[3]),null)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function ci(l){let e,r;const t=[{name:"paintbrush"},l[1],{iconNode:l[0]}];let n={$$slots:{default:[ai]},$$scope:{ctx:l}};for(let o=0;o<t.length;o+=1)n=Q(n,t[o]);return e=new sr({props:n}),{c(){W(e.$$.fragment)},l(o){J(e.$$.fragment,o)},m(o,i){G(e,o,i),r=!0},p(o,[i]){const c=i&3?Le(t,[t[0],i&2&&nt(o[1]),i&1&&{iconNode:o[0]}]):{};i&8&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){r||(C(e.$$.fragment,o),r=!0)},o(o){S(e.$$.fragment,o),r=!1},d(o){Y(e,o)}}}function ui(l,e,r){let{$$slots:t={},$$scope:n}=e;const o=[["path",{d:"m14.622 17.897-10.68-2.913"}],["path",{d:"M18.376 2.622a1 1 0 1 1 3.002 3.002L17.36 9.643a.5.5 0 0 0 0 .707l.944.944a2.41 2.41 0 0 1 0 3.408l-.944.944a.5.5 0 0 1-.707 0L8.354 7.348a.5.5 0 0 1 0-.707l.944-.944a2.41 2.41 0 0 1 3.408 0l.944.944a.5.5 0 0 0 .707 0z"}],["path",{d:"M9 8c-1.804 2.71-3.97 3.46-6.583 3.948a.507.507 0 0 0-.302.819l7.32 8.883a1 1 0 0 0 1.185.204C12.735 20.405 16 16.792 16 15"}]];return l.$$set=i=>{r(1,e=Q(Q({},e),ge(i))),"$$scope"in i&&r(3,n=i.$$scope)},e=ge(e),[o,e,t,n]}class fi extends se{constructor(e){super(),ae(this,e,ui,ci,ie,{})}}const di=fi;function hi(l){let e;const r=l[2].default,t=ke(r,l,l[3],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&8)&&ye(t,r,n,n[3],e?Ce(r,n[3],o,null):Te(n[3]),null)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function mi(l){let e,r;const t=[{name:"pen-off"},l[1],{iconNode:l[0]}];let n={$$slots:{default:[hi]},$$scope:{ctx:l}};for(let o=0;o<t.length;o+=1)n=Q(n,t[o]);return e=new sr({props:n}),{c(){W(e.$$.fragment)},l(o){J(e.$$.fragment,o)},m(o,i){G(e,o,i),r=!0},p(o,[i]){const c=i&3?Le(t,[t[0],i&2&&nt(o[1]),i&1&&{iconNode:o[0]}]):{};i&8&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){r||(C(e.$$.fragment,o),r=!0)},o(o){S(e.$$.fragment,o),r=!1},d(o){Y(e,o)}}}function gi(l,e,r){let{$$slots:t={},$$scope:n}=e;const o=[["path",{d:"m10 10-6.157 6.162a2 2 0 0 0-.5.833l-1.322 4.36a.5.5 0 0 0 .622.624l4.358-1.323a2 2 0 0 0 .83-.5L14 13.982"}],["path",{d:"m12.829 7.172 4.359-4.346a1 1 0 1 1 3.986 3.986l-4.353 4.353"}],["path",{d:"m2 2 20 20"}]];return l.$$set=i=>{r(1,e=Q(Q({},e),ge(i))),"$$scope"in i&&r(3,n=i.$$scope)},e=ge(e),[o,e,t,n]}class pi extends se{constructor(e){super(),ae(this,e,gi,mi,ie,{})}}const _i=pi;function bi(l){let e;const r=l[2].default,t=ke(r,l,l[3],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&8)&&ye(t,r,n,n[3],e?Ce(r,n[3],o,null):Te(n[3]),null)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function vi(l){let e,r;const t=[{name:"pencil-ruler"},l[1],{iconNode:l[0]}];let n={$$slots:{default:[bi]},$$scope:{ctx:l}};for(let o=0;o<t.length;o+=1)n=Q(n,t[o]);return e=new sr({props:n}),{c(){W(e.$$.fragment)},l(o){J(e.$$.fragment,o)},m(o,i){G(e,o,i),r=!0},p(o,[i]){const c=i&3?Le(t,[t[0],i&2&&nt(o[1]),i&1&&{iconNode:o[0]}]):{};i&8&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){r||(C(e.$$.fragment,o),r=!0)},o(o){S(e.$$.fragment,o),r=!1},d(o){Y(e,o)}}}function wi(l,e,r){let{$$slots:t={},$$scope:n}=e;const o=[["path",{d:"M13 7 8.7 2.7a2.41 2.41 0 0 0-3.4 0L2.7 5.3a2.41 2.41 0 0 0 0 3.4L7 13"}],["path",{d:"m8 6 2-2"}],["path",{d:"m18 16 2-2"}],["path",{d:"m17 11 4.3 4.3c.94.94.94 2.46 0 3.4l-2.6 2.6c-.94.94-2.46.94-3.4 0L11 17"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z"}],["path",{d:"m15 5 4 4"}]];return l.$$set=i=>{r(1,e=Q(Q({},e),ge(i))),"$$scope"in i&&r(3,n=i.$$scope)},e=ge(e),[o,e,t,n]}class ki extends se{constructor(e){super(),ae(this,e,wi,vi,ie,{})}}const yi=ki;function Ti(l){let e;const r=l[2].default,t=ke(r,l,l[3],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&8)&&ye(t,r,n,n[3],e?Ce(r,n[3],o,null):Te(n[3]),null)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function Ci(l){let e,r;const t=[{name:"ruler"},l[1],{iconNode:l[0]}];let n={$$slots:{default:[Ti]},$$scope:{ctx:l}};for(let o=0;o<t.length;o+=1)n=Q(n,t[o]);return e=new sr({props:n}),{c(){W(e.$$.fragment)},l(o){J(e.$$.fragment,o)},m(o,i){G(e,o,i),r=!0},p(o,[i]){const c=i&3?Le(t,[t[0],i&2&&nt(o[1]),i&1&&{iconNode:o[0]}]):{};i&8&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){r||(C(e.$$.fragment,o),r=!0)},o(o){S(e.$$.fragment,o),r=!1},d(o){Y(e,o)}}}function Ei(l,e,r){let{$$slots:t={},$$scope:n}=e;const o=[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z"}],["path",{d:"m14.5 12.5 2-2"}],["path",{d:"m11.5 9.5 2-2"}],["path",{d:"m8.5 6.5 2-2"}],["path",{d:"m17.5 15.5 2-2"}]];return l.$$set=i=>{r(1,e=Q(Q({},e),ge(i))),"$$scope"in i&&r(3,n=i.$$scope)},e=ge(e),[o,e,t,n]}class Si extends se{constructor(e){super(),ae(this,e,Ei,Ci,ie,{})}}const $i=Si;function Ur(l,e,r,t){const n=(l-(isNaN(e)?0:e))%t;let o=Math.abs(n)*2>=t?l+Math.sign(n)*(t-Math.abs(n)):l-n;isNaN(e)?!isNaN(r)&&o>r&&(o=Math.floor(r/t)*t):o<e?o=e:!isNaN(r)&&o>r&&(o=e+Math.floor((r-e)/t)*t);const i=t.toString(),c=i.indexOf("."),s=c>=0?i.length-c:0;if(s>0){const a=Math.pow(10,s);o=Math.round(o*a)/a}return o}function Mi(l,e,r){return Math.max(l,Math.min(e,r))}function eo(l,e){let r=0;return ko(()=>{clearTimeout(r)}),()=>{window.clearTimeout(r),r=window.setTimeout(l,e)}}function Zr(l,e){let r=0;const t=new ResizeObserver(()=>{cancelAnimationFrame(r),r=requestAnimationFrame(e)});return t.observe(l),()=>{window.cancelAnimationFrame(r),t.unobserve(l)}}function Ii(l,e=ir){let r={left:l.scrollLeft,top:l.scrollTop},t=0;return function n(){const o={left:l.scrollLeft,top:l.scrollTop},i=r.left!==o.left,c=r.top!==o.top;(i||c)&&e(),r=o,t=window.requestAnimationFrame(n)}(),()=>window.cancelAnimationFrame(t)}function wn(l,e){return l>0&&l<e}function to(l,e){return r=>{if(l[0]===l[1]||e[0]===e[1])return e[0];const t=(e[1]-e[0])/(l[1]-l[0]);return e[0]+t*(r-l[0])}}function _r(l){return l?parseInt(l,10):0}function ro(l,e){const r=l/e;return isNaN(r)?0:r}function Ar(l){const e=ro(l.viewport,l.content),r=l.scrollbar.paddingStart+l.scrollbar.paddingEnd,t=(l.scrollbar.size-r)*e;return Math.max(t,18)}function Ai(l,e,r,t="ltr"){const n=Ar(r),o=n/2,i=e||o,c=n-i,s=r.scrollbar.paddingStart+i,a=r.scrollbar.size-r.scrollbar.paddingEnd-c,u=r.content-r.viewport,f=t==="ltr"?[0,u]:[u*-1,0];return to([s,a],f)(l)}function Li(l,e,r="ltr"){const t=Ar(e),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,o=e.scrollbar.size-n,i=e.content-e.viewport,c=o-t,[s,a]=r==="ltr"?[0,i]:[i*-1,0],u=Mi(s,l,a);return to([0,i],[0,c])(u)}function Pi(l,e){const r=ze.writable(l);function t(o){const i=r.get();return e[i][o]??i}return{state:r,dispatch:o=>{r.set(t(o))}}}function lr(l){const{rootState:e,scrollbarState:r}=l;r.isVisible.set(!0);function t(a){const u=r.domRect.get();if(!u)return;const f=a.clientX-u.left,p=a.clientY-u.top;r.isHorizontal.get()?r.onDragScroll(f):r.onDragScroll(p)}function n(a){if(a.button!==0)return;const u=a.target;if(!pt(u))return;u.setPointerCapture(a.pointerId);const f=a.currentTarget;if(!pt(f))return;r.domRect.set(f.getBoundingClientRect()),r.prevWebkitUserSelect.set(document.body.style.webkitUserSelect),document.body.style.webkitUserSelect="none";const p=e.viewportEl.get();p&&(p.style.scrollBehavior="auto"),t(a)}function o(a){t(a)}function i(a){const u=a.target;if(!pt(u))return;u.hasPointerCapture(a.pointerId)&&u.releasePointerCapture(a.pointerId),document.body.style.webkitUserSelect=r.prevWebkitUserSelect.get();const f=e.viewportEl.get();f&&(f.style.scrollBehavior=""),r.domRect.set(null)}function c(a){const u=a.target,f=a.currentTarget;if(!pt(u)||!pt(f)||!f.contains(u))return;const h=r.sizes.get();if(!h)return;const b=h.content-h.viewport;r.handleWheelScroll(a,b)}function s(a){r.scrollbarEl.set(a);const u=Vt(Wt(a,"pointerdown",n),Wt(a,"pointermove",o),Wt(a,"pointerup",i),Ye(document,"wheel",c,{passive:!1})),f=At([e.contentEl],([p])=>p?Zr(p,r.handleSizeChange):ir);return{destroy(){u(),f()}}}return s}function Di(l){const e=lr(l),{rootState:r,scrollbarState:t}=l,n=eo(()=>{const i=r.viewportEl.get();if(!i)return;const c=i.offsetWidth<i.scrollWidth,s=i.offsetHeight<i.scrollHeight;t.isVisible.set(t.isHorizontal.get()?c:s)},10);function o(i){var f;const c=(f=e(i))==null?void 0:f.destroy;n();const s=[],a=r.viewportEl.get();a&&s.push(Zr(a,n));const u=r.contentEl.get();return u&&s.push(Zr(u,n)),{destroy(){s.forEach(p=>p()),c()}}}return o}function Oi(l){const e=lr(l),{rootState:r,scrollbarState:t}=l;t.isVisible.set(!1);let n;function o(){if(window.clearTimeout(n),t.isVisible.get())return;const s=r.viewportEl.get();if(!s)return;const a=s.offsetWidth<s.scrollWidth,u=s.offsetHeight<s.scrollHeight;t.isVisible.set(t.isHorizontal.get()?a:u)}function i(){n=window.setTimeout(()=>{t.isVisible.get()&&t.isVisible.set(!1)},r.options.hideDelay.get())}function c(s){var p;const a=(p=e(s))==null?void 0:p.destroy,u=s.closest("[data-melt-scroll-area]");let f=ir;return u&&(Mo()?f=Vt(Ye(u,"touchstart",o),Ye(u,"touchend",i)):Io()?f=Vt(Ye(u,"pointerenter",o),Ye(u,"mouseenter",o),Ye(u,"mouseleave",i)):f=Vt(Ye(u,"pointerenter",o),Ye(u,"pointerleave",i))),{destroy(){a==null||a(),f()}}}return c}function Ni(l){const e=lr(l),{rootState:r,scrollbarState:t}=l,n=Pi("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});At([n.state],([c])=>{c==="idle"&&window.setTimeout(()=>{n.dispatch("HIDE")},r.options.hideDelay.get()),c==="hidden"?t.isVisible.set(!1):t.isVisible.set(!0)});const o=eo(()=>n.dispatch("SCROLL_END"),100);At([r.viewportEl,t.isHorizontal],([c,s])=>{const a=s?"scrollLeft":"scrollTop";let u=ir;if(c){let f=c[a];u=Ye(c,"scroll",()=>{const h=c[a];f!==h&&(n.dispatch("SCROLL"),o()),f=h})}return()=>{u()}});function i(c){var u;const s=(u=e(c))==null?void 0:u.destroy,a=Vt(Ye(c,"pointerenter",()=>n.dispatch("POINTER_ENTER")),Ye(c,"pointerleave",()=>n.dispatch("POINTER_LEAVE")));return{destroy(){s==null||s(),a()}}}return i}function Vi(l,e){const r=e(l),{rootState:t,scrollbarState:n}=l;return _t(zt("scrollbar"),{stores:[n.sizes,t.options.dir,n.isVisible],returned:([o,i,c])=>({style:dt({position:"absolute",bottom:0,left:i==="rtl"?"var(--melt-scroll-area-corner-width)":0,right:i==="ltr"?"var(--melt-scroll-area-corner-width)":0,"--melt-scroll-area-thumb-width":`${Ar(o)}px`,visibility:c?void 0:"hidden"}),"data-state":c?"visible":"hidden"}),action:o=>{var c;const i=(c=r(o))==null?void 0:c.destroy;return t.scrollbarXEl.set(o),t.scrollbarXEnabled.set(!0),{destroy(){i==null||i(),t.scrollbarXEl.set(null)}}}})}function zi(l,e){const r=e(l),{rootState:t,scrollbarState:n}=l;return _t(zt("scrollbar"),{stores:[n.sizes,t.options.dir,n.isVisible],returned:([o,i,c])=>({style:dt({position:"absolute",top:0,right:i==="ltr"?0:void 0,left:i==="rtl"?0:void 0,bottom:"var(--melt-scroll-area-corner-height)","--melt-scroll-area-thumb-height":`${Ar(o)}px`,visibility:c?void 0:"hidden"}),"data-state":c?"visible":"hidden"}),action:o=>{var c;const i=(c=r(o))==null?void 0:c.destroy;return t.scrollbarYEl.set(o),t.scrollbarYEnabled.set(!0),{destroy(){i==null||i(),t.scrollbarYEl.set(null)}}}})}function Bi(l){switch(l){case"always":return lr;case"auto":return Di;case"hover":return Oi;case"scroll":return Ni;default:return lr}}const{name:zt}=ql("scroll-area"),Ui=["root","viewport","content","scrollbarX","scrollbarY","thumbX","thumbY"],Ri={type:"hover",hideDelay:600,dir:"ltr"};function Fi(l){const e={...Ri,...l},r=Xr(jl(e,"ids")),t=ze.writable(0),n=ze.writable(0),o=ze.writable(!1),i=ze.writable(!1),c=ze.writable(null),s=ze.writable(null),a=ze.writable(null),u=ze.writable(null),f=ze.writable(null),p=Xr({...Yl(Ui),...e.ids}),h={cornerWidth:t,cornerHeight:n,scrollbarXEnabled:o,scrollbarYEnabled:i,viewportEl:s,contentEl:a,options:r,scrollbarXEl:u,scrollbarYEl:f,scrollAreaEl:c,ids:p},b=_t(zt(),{stores:[t,n,p.root],returned:([d,y,v])=>({style:dt({position:"relative","--melt-scroll-area-corner-width":`${d}px`,"--melt-scroll-area-corner-height":`${y}px`}),id:v}),action:d=>(c.set(d),{destroy(){c.set(null)}})}),m=_t(zt("viewport"),{stores:[o,i,p.viewport],returned:([d,y,v])=>({style:dt({"scrollbar-width":"none","-ms-overflow-style":"none","-webkit-overflow-scrolling":"touch","-webkit-scrollbar":"none","overflow-x":d?"scroll":"hidden","overflow-y":y?"scroll":"hidden"}),id:v}),action:d=>{var v;const y=document.createElement("style");return y.innerHTML=`
				/* Hide scrollbars cross-browser and enable momentum scroll for touch
					devices */
				[data-melt-scroll-area-viewport] {
					scrollbar-width: none;
					-ms-overflow-style: none;
					-webkit-overflow-scrolling: touch;
				}

				[data-melt-scroll-area-viewport]::-webkit-scrollbar {
					display: none;
				}
			`,(v=d.parentElement)==null||v.insertBefore(y,d),s.set(d),{destroy(){y.remove(),s.set(null)}}}}),g=_t(zt("content"),{stores:[p.content],returned:([d])=>({style:dt({"min-width":"100%",display:"table"}),id:d}),action:d=>(a.set(d),{destroy(){a.set(null)}})});function T(d="vertical"){const y=ze.writable(d),v=ze.writable(d==="horizontal"),L=ze.writable(null),D=ze.writable(""),O=ze.writable(0),A=ze.writable(null),H=ze.writable(0),U=ze.writable(null),q=ze.writable({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),ne=ze.writable(!1),z=ze.derived(q,ue=>{const Ne=ro(ue.viewport,ue.content);return Ne>0&&Ne<1});function F(ue,Ne){return Ai(ue,O.get(),q.get(),Ne)}function j(ue,Ne){const Se=s.get();if(Se)if(v.get()){const je=Se.scrollLeft+ue.deltaY;Se.scrollLeft=je,wn(je,Ne)&&ue.preventDefault()}else{const je=Se.scrollTop+ue.deltaY;Se.scrollTop=je,wn(je,Ne)&&ue.preventDefault()}}function ee(ue){v.get()?O.set(ue.x):O.set(ue.y)}function x(){O.set(0)}function K(){const ue=s.get(),Ne=A.get();if(!ue||!Ne)return;const Se=v.get()?ue.scrollLeft:ue.scrollTop,je=Li(Se,q.get(),h.options.dir.get());H.set(je)}function te(ue){const Ne=s.get();Ne&&(v.get()?Ne.scrollLeft=F(ue,h.options.dir.get()):Ne.scrollTop=F(ue))}function ce(){const ue=pe.scrollbarEl.get();if(!ue)return;const Ne=pe.isHorizontal.get(),Se=h.viewportEl.get();Ne?pe.sizes.set({content:(Se==null?void 0:Se.scrollWidth)??0,viewport:(Se==null?void 0:Se.offsetWidth)??0,scrollbar:{size:ue.clientWidth??0,paddingStart:_r(getComputedStyle(ue).paddingLeft),paddingEnd:_r(getComputedStyle(ue).paddingRight)}}):pe.sizes.set({content:(Se==null?void 0:Se.scrollHeight)??0,viewport:(Se==null?void 0:Se.offsetHeight)??0,scrollbar:{size:ue.clientHeight??0,paddingStart:_r(getComputedStyle(ue).paddingLeft),paddingEnd:_r(getComputedStyle(ue).paddingRight)}})}const pe={isHorizontal:v,domRect:L,prevWebkitUserSelect:D,pointerOffset:O,thumbEl:A,thumbOffset:H,sizes:q,orientation:y,handleThumbDown:ee,handleThumbUp:x,onThumbPositionChange:K,onDragScroll:te,handleWheelScroll:j,hasThumb:z,scrollbarEl:U,isVisible:ne,handleSizeChange:ce},Pe=Bi(r.type.get()),ve={rootState:h,scrollbarState:pe},le=d==="horizontal"?Vi(ve,Pe):zi(ve,Pe),De=Hi(ve);return{scrollbar:le,thumb:De}}const{scrollbar:$,thumb:I}=T("horizontal"),{scrollbar:E,thumb:k}=T("vertical"),_=ji(h);return{options:r,elements:{root:b,viewport:m,content:g,corner:_,scrollbarX:$,scrollbarY:E,thumbX:I,thumbY:k}}}function Hi(l){const{scrollbarState:e,rootState:r}=l;function t(s){const a=s.target;if(!pt(a))return;const u=a.getBoundingClientRect(),f=s.clientX-u.left,p=s.clientY-u.top;e.handleThumbDown({x:f,y:p})}function n(s){e.handleThumbUp(s)}let o;function i(){if(o)return;const s=r.viewportEl.get();s&&(o=Ii(s,e.onThumbPositionChange)),e.onThumbPositionChange()}return _t(zt("thumb"),{stores:[e.hasThumb,e.isHorizontal,e.thumbOffset],returned:([s,a,u])=>({style:dt({width:"var(--melt-scroll-area-thumb-width)",height:"var(--melt-scroll-area-thumb-height)",transform:a?`translate3d(${Math.round(u)}px, 0, 0)`:`translate3d(0, ${Math.round(u)}px, 0)`}),"data-state":s?"visible":"hidden"}),action:s=>{e.thumbEl.set(s);const a=At([e.sizes],([f])=>{const p=r.viewportEl.get();return p?(e.onThumbPositionChange(),Ye(p,"scroll",i)):ir}),u=Vt(Wt(s,"pointerdown",t),Wt(s,"pointerup",n));return{destroy(){o==null||o(),u(),a()}}}})}function ji(l){const e=we(0),r=we(0),t=Qt([e,r],([u,f])=>!!u&&!!f);function n(){var f;const u=((f=l.scrollbarXEl.get())==null?void 0:f.offsetHeight)||0;l.cornerHeight.set(u),r.set(u)}function o(){var f;const u=((f=l.scrollbarYEl.get())==null?void 0:f.offsetWidth)||0;l.cornerWidth.set(u),e.set(u)}At([l.scrollbarXEl],([u])=>{u&&n()}),At([l.scrollbarYEl],([u])=>{u&&o()});const i=Qt([l.scrollbarXEl,l.scrollbarYEl],([u,f])=>!!u&&!!f),c=Qt([l.options.type,i],([u,f])=>u!=="scroll"&&f),s=Qt([c,t],([u,f])=>u&&f);return _t(zt("corner"),{stores:[e,r,l.options.dir,s],returned:([u,f,p,h])=>({style:dt({display:h?"block":"none",width:`${u}px`,height:`${f}px`,position:"absolute",right:p==="ltr"?0:void 0,left:p==="rtl"?0:void 0,bottom:0})})})}const qi={defaultValue:[],min:0,max:100,step:1,orientation:"horizontal",dir:"ltr",disabled:!1},{name:br}=ql("slider"),Wi=l=>{const e={...qi,...l},r=Xr(jl(e,"value","onValueChange","defaultValue")),{min:t,max:n,step:o,orientation:i,dir:c,disabled:s}=r,a=e.value??we(e.defaultValue),u=To(a,e==null?void 0:e.onValueChange),f=ze(we(!1)),p=ze(we(0)),h=ze(we(null)),b=Yl(["root"]),m=(d,y)=>{u.update(v=>{if(!v)return[d];if(v[y]===d)return v;const L=[...v],D=L[y]>d?-1:1;function O(){L[y]=L[y+D],L[y+D]=d;const q=g();q&&(q[y+D].focus(),h.set({thumb:q[y+D],index:y+D}))}if(D===-1&&d<L[y-1])return O(),L;if(D===1&&d>L[y+1])return O(),L;const A=t.get(),H=n.get(),U=o.get();return L[y]=Ur(d,A,H,U),L})},g=()=>{const d=zr(b.root);return d?Array.from(d.querySelectorAll('[data-melt-part="thumb"]')).filter(y=>pt(y)):null},T=Qt([t,n],([d,y])=>v=>(v-d)/(y-d)*100),$=ze.derived([i,c],([d,y])=>d==="horizontal"?y==="rtl"?"rl":"lr":y==="rtl"?"tb":"bt"),I=_t(br(),{stores:[s,i,c],returned:([d,y,v])=>({dir:v,disabled:Vr(d),"data-disabled":Vr(d),"data-orientation":y,style:d?void 0:`touch-action: ${y==="horizontal"?"pan-y":"pan-x"}`,"data-melt-id":b.root})}),E=_t(br("range"),{stores:[u,$,T],returned:([d,y,v])=>{const L=d.length>1?v(Math.min(...d)??0):0,D=100-v(Math.max(...d)??0),O={position:"absolute"};switch(y){case"lr":{O.left=`${L}%`,O.right=`${D}%`;break}case"rl":{O.right=`${L}%`,O.left=`${D}%`;break}case"bt":{O.bottom=`${L}%`,O.top=`${D}%`;break}case"tb":{O.top=`${L}%`,O.bottom=`${D}%`;break}}return{style:dt(O)}}}),k=pn(br("thumb"),{stores:[u,T,t,n,s,i,$],returned:([d,y,v,L,D,O,A])=>Array.from({length:d.length||1},(U,q)=>{p.get()<d.length&&p.update(ee=>ee+1);const z=d[q],F=`${y(z)}%`,j={position:"absolute"};switch(A){case"lr":{j.left=F,j.translate="-50% 0";break}case"rl":{j.right=F,j.translate="50% 0";break}case"bt":{j.bottom=F,j.translate="0 50%";break}case"tb":{j.top=F,j.translate="0 -50%";break}}return{role:"slider","aria-valuemin":v,"aria-valuemax":L,"aria-valuenow":z,"aria-disabled":Vr(D),"aria-orientation":O,"data-melt-part":"thumb","data-value":z,style:dt(j),tabindex:D?-1:0}}),action:d=>({destroy:Wt(d,"keydown",v=>{if(s.get())return;const L=v.currentTarget;if(!pt(L))return;const D=g();if(!(D!=null&&D.length))return;const O=D.indexOf(L);if(p.set(O),![et.ARROW_LEFT,et.ARROW_RIGHT,et.ARROW_UP,et.ARROW_DOWN,et.HOME,et.END].includes(v.key))return;v.preventDefault();const A=t.get(),H=n.get(),U=o.get(),q=u.get(),ne=i.get(),z=$.get(),F=q[O];switch(v.key){case et.HOME:{m(A,O);break}case et.END:{m(H,O);break}case et.ARROW_LEFT:{if(ne!=="horizontal")break;v.metaKey?m(z==="rl"?H:A,O):z==="rl"&&F<H?m(F+U,O):z==="lr"&&F>A&&m(F-U,O);break}case et.ARROW_RIGHT:{if(ne!=="horizontal")break;v.metaKey?m(z==="rl"?A:H,O):z==="rl"&&F>A?m(F-U,O):z==="lr"&&F<H&&m(F+U,O);break}case et.ARROW_UP:{v.metaKey?m(z==="tb"?A:H,O):z==="tb"&&F>A?m(F-U,O):z!=="tb"&&F<H&&m(F+U,O);break}case et.ARROW_DOWN:{v.metaKey?m(z==="tb"?H:A,O):z==="tb"&&F<H?m(F+U,O):z!=="tb"&&F>A&&m(F-U,O);break}}})})}),_=pn(br("tick"),{stores:[u,t,n,o,$],returned:([d,y,v,L,D])=>{const O=v-y;let A=Math.ceil(O/L);return O%L==0&&A++,Array.from({length:A},(H,U)=>{const q=`${U*(L/(v-y))*100}%`,ne=U===0,z=U===A-1,F=ne?0:z?-100:-50,j={position:"absolute"};switch(D){case"lr":{j.left=q,j.translate=`${F}% 0`;break}case"rl":{j.right=q,j.translate=`${-F}% 0`;break}case"bt":{j.bottom=q,j.translate=`0 ${-F}%`;break}case"tb":{j.top=q,j.translate=`0 ${F}%`;break}}const ee=y+U*L;return{"data-bounded":(d.length===1?ee<=d[0]:d[0]<=ee&&ee<=d[d.length-1])?!0:void 0,"data-value":ee,style:dt(j)}})}});return At([I,t,n,s,i,$,o],([d,y,v,L,D,O,A])=>{if(!yo||L)return;const H=(j,ee,x,K)=>{const ce=(j-x)/(K-x)*(v-y)+y;if(ce<y)m(y,ee);else if(ce>v)m(v,ee);else{const pe=A,Pe=y,ve=Math.floor((ce-Pe)/pe),le=Pe+ve*pe+pe/2,De=Pe+(ve+1)*pe+pe/2,ue=ce>=le&&ce<De?(ve+1)*pe+Pe:ve*pe+Pe;ue<=v&&m(ue,ee)}},U=j=>{const ee=g();if(!ee)return;ee.forEach(ce=>ce.blur());const x=ee.map(ce=>{if(D==="horizontal"){const{left:pe,right:Pe}=ce.getBoundingClientRect();return Math.abs(j.clientX-(pe+Pe)/2)}else{const{top:pe,bottom:Pe}=ce.getBoundingClientRect();return Math.abs(j.clientY-(pe+Pe)/2)}}),K=ee[x.indexOf(Math.min(...x))],te=ee.indexOf(K);return{thumb:K,index:te}},q=j=>{if(!f.get())return;j.preventDefault(),j.stopPropagation();const ee=zr(d["data-melt-id"]),x=h.get();if(!ee||!x)return;x.thumb.focus();const{left:K,right:te,top:ce,bottom:pe}=ee.getBoundingClientRect();switch(O){case"lr":{H(j.clientX,x.index,K,te);break}case"rl":{H(j.clientX,x.index,te,K);break}case"bt":{H(j.clientY,x.index,pe,ce);break}case"tb":{H(j.clientY,x.index,ce,pe);break}}},ne=j=>{if(j.button!==0)return;const ee=zr(d["data-melt-id"]),x=U(j);if(!x||!ee)return;const K=j.target;!pt(K)||!ee.contains(K)||(j.preventDefault(),h.set(x),x.thumb.focus(),f.set(!0),q(j))},z=()=>{f.set(!1)},F=Vt(Ye(document,"pointerdown",ne),Ye(document,"pointerup",z),Ye(document,"pointerleave",z),Ye(document,"pointermove",q));return()=>{F()}}),At([o,t,n,u],function([y,v,L,D]){const O=H=>Ur(H,v,L,y)===H,A=H=>Ur(H,v,L,y);D.some(H=>!O(H))&&u.update(H=>H.map(A))}),{elements:{root:I,thumbs:k,range:E,ticks:_},states:{value:u},options:r}};function Gi(l){return Object.keys(l).reduce((e,r)=>l[r]===void 0?e:`${e}${r}:${l[r]};`,"")}function Lr(){return{NAME:"scroll-area",PARTS:["scrollbar-x","scrollbar-y","thumb-x","thumb-y","viewport","content","root","corner"],SCROLLBAR_NAME:"scrollbar"}}function Yi(l){const{NAME:e,PARTS:r}=Lr(),t=Xl(e,r),n={...Fi(Wl(l)),getAttrs:t};return $r(e,n),{...n,updateOption:Gl(n.options)}}function Bt(){const{NAME:l}=Lr();return Xt(l)}function Xi(l){const{SCROLLBAR_NAME:e}=Lr();return $r(e,l)}function Zi(){const{SCROLLBAR_NAME:l}=Lr();return Xt(l)}const Ji=l=>({builder:l&8}),kn=l=>({builder:l[3]}),Ki=l=>({builder:l&8}),yn=l=>({builder:l[3]});function Qi(l){let e,r,t,n;const o=l[10].default,i=ke(o,l,l[9],kn);let c=[l[3],l[2]],s={};for(let a=0;a<c.length;a+=1)s=Q(s,c[a]);return{c(){e=N("div"),i&&i.c(),this.h()},l(a){e=V(a,"DIV",{});var u=B(e);i&&i.l(u),u.forEach(w),this.h()},h(){Be(e,s)},m(a,u){R(a,e,u),i&&i.m(e,null),l[11](e),r=!0,t||(n=rt(l[3].action(e)),t=!0)},p(a,u){i&&i.p&&(!r||u&520)&&ye(i,o,a,a[9],r?Ce(o,a[9],u,Ji):Te(a[9]),kn),Be(e,s=Le(c,[u&8&&a[3],u&4&&a[2]]))},i(a){r||(C(i,a),r=!0)},o(a){S(i,a),r=!1},d(a){a&&w(e),i&&i.d(a),l[11](null),t=!1,n()}}}function xi(l){let e;const r=l[10].default,t=ke(r,l,l[9],yn);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&520)&&ye(t,r,n,n[9],e?Ce(r,n[9],o,Ki):Te(n[9]),yn)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function es(l){let e,r,t,n;const o=[xi,Qi],i=[];function c(s,a){return s[1]?0:1}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,[a]){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function ts(l,e,r){let t,n;const o=["type","dir","hideDelay","asChild","el"];let i=Ee(e,o),c,{$$slots:s={},$$scope:a}=e,{type:u="hover"}=e,{dir:f="ltr"}=e,{hideDelay:p=600}=e,{asChild:h=!1}=e,{el:b=void 0}=e;const{elements:{root:m},updateOption:g,getAttrs:T}=Yi({type:u,dir:f,hideDelay:p});re(l,m,k=>r(8,c=k));const $=T("root"),I=Gi({overflow:"hidden"});function E(k){He[k?"unshift":"push"](()=>{b=k,r(0,b)})}return l.$$set=k=>{e=Q(Q({},e),ge(k)),r(16,i=Ee(e,o)),"type"in k&&r(5,u=k.type),"dir"in k&&r(6,f=k.dir),"hideDelay"in k&&r(7,p=k.hideDelay),"asChild"in k&&r(1,h=k.asChild),"el"in k&&r(0,b=k.el),"$$scope"in k&&r(9,a=k.$$scope)},l.$$.update=()=>{l.$$.dirty&256&&r(3,t=c),l.$$.dirty&32&&g("type",u),l.$$.dirty&64&&g("dir",f),l.$$.dirty&128&&g("hideDelay",p),r(2,n={...i,...$,style:I}),l.$$.dirty&12&&Object.assign(t,n)},[b,h,n,t,m,u,f,p,c,a,s,E]}let rs=class extends se{constructor(e){super(),ae(this,e,ts,es,ie,{type:5,dir:6,hideDelay:7,asChild:1,el:0})}};const ns=l=>({builder:l&4}),Tn=l=>({builder:l[2]}),ls=l=>({builder:l&4}),Cn=l=>({builder:l[2]});function os(l){let e,r,t,n;const o=l[7].default,i=ke(o,l,l[6],Tn);let c=[l[2]],s={};for(let a=0;a<c.length;a+=1)s=Q(s,c[a]);return{c(){e=N("div"),i&&i.c(),this.h()},l(a){e=V(a,"DIV",{});var u=B(e);i&&i.l(u),u.forEach(w),this.h()},h(){Be(e,s)},m(a,u){R(a,e,u),i&&i.m(e,null),l[8](e),r=!0,t||(n=rt(l[2].action(e)),t=!0)},p(a,u){i&&i.p&&(!r||u&68)&&ye(i,o,a,a[6],r?Ce(o,a[6],u,ns):Te(a[6]),Tn),Be(e,s=Le(c,[u&4&&a[2]]))},i(a){r||(C(i,a),r=!0)},o(a){S(i,a),r=!1},d(a){a&&w(e),i&&i.d(a),l[8](null),t=!1,n()}}}function is(l){let e;const r=l[7].default,t=ke(r,l,l[6],Cn);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&68)&&ye(t,r,n,n[6],e?Ce(r,n[6],o,ls):Te(n[6]),Cn)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function ss(l){let e,r,t,n;const o=[is,os],i=[];function c(s,a){return s[1]?0:1}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,[a]){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function as(l,e,r){let t,n;const o=["asChild","el"];let i=Ee(e,o),c,{$$slots:s={},$$scope:a}=e,{asChild:u=!1}=e,{el:f=void 0}=e;const{elements:{viewport:p},getAttrs:h}=Bt();re(l,p,g=>r(5,c=g));const b=h("viewport");function m(g){He[g?"unshift":"push"](()=>{f=g,r(0,f)})}return l.$$set=g=>{e=Q(Q({},e),ge(g)),r(11,i=Ee(e,o)),"asChild"in g&&r(1,u=g.asChild),"el"in g&&r(0,f=g.el),"$$scope"in g&&r(6,a=g.$$scope)},l.$$.update=()=>{r(4,t={...i,...b}),l.$$.dirty&32&&r(2,n=c),l.$$.dirty&20&&Object.assign(n,t)},[f,u,n,p,t,c,a,s,m]}class cs extends se{constructor(e){super(),ae(this,e,as,ss,ie,{asChild:1,el:0})}}const us=l=>({builder:l&4}),En=l=>({builder:l[2]}),fs=l=>({builder:l&4}),Sn=l=>({builder:l[2]});function ds(l){let e,r,t,n;const o=l[7].default,i=ke(o,l,l[6],En);let c=[l[2]],s={};for(let a=0;a<c.length;a+=1)s=Q(s,c[a]);return{c(){e=N("div"),i&&i.c(),this.h()},l(a){e=V(a,"DIV",{});var u=B(e);i&&i.l(u),u.forEach(w),this.h()},h(){Be(e,s)},m(a,u){R(a,e,u),i&&i.m(e,null),l[8](e),r=!0,t||(n=rt(l[2].action(e)),t=!0)},p(a,u){i&&i.p&&(!r||u&68)&&ye(i,o,a,a[6],r?Ce(o,a[6],u,us):Te(a[6]),En),Be(e,s=Le(c,[u&4&&a[2]]))},i(a){r||(C(i,a),r=!0)},o(a){S(i,a),r=!1},d(a){a&&w(e),i&&i.d(a),l[8](null),t=!1,n()}}}function hs(l){let e;const r=l[7].default,t=ke(r,l,l[6],Sn);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&68)&&ye(t,r,n,n[6],e?Ce(r,n[6],o,fs):Te(n[6]),Sn)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function ms(l){let e,r,t,n;const o=[hs,ds],i=[];function c(s,a){return s[1]?0:1}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,[a]){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function gs(l,e,r){let t,n;const o=["asChild","el"];let i=Ee(e,o),c,{$$slots:s={},$$scope:a}=e,{asChild:u=!1}=e,{el:f=void 0}=e;const{elements:{content:p},getAttrs:h}=Bt();re(l,p,g=>r(5,c=g));const b=h("content");function m(g){He[g?"unshift":"push"](()=>{f=g,r(0,f)})}return l.$$set=g=>{e=Q(Q({},e),ge(g)),r(11,i=Ee(e,o)),"asChild"in g&&r(1,u=g.asChild),"el"in g&&r(0,f=g.el),"$$scope"in g&&r(6,a=g.$$scope)},l.$$.update=()=>{r(4,t={...i,...b}),l.$$.dirty&32&&r(2,n=c),l.$$.dirty&20&&Object.assign(n,t)},[f,u,n,p,t,c,a,s,m]}class ps extends se{constructor(e){super(),ae(this,e,gs,ms,ie,{asChild:1,el:0})}}const _s=l=>({builder:l&4}),$n=l=>({builder:l[2]}),bs=l=>({builder:l&4}),Mn=l=>({builder:l[2]});function vs(l){let e,r,t,n;const o=l[7].default,i=ke(o,l,l[6],$n);let c=[l[2]],s={};for(let a=0;a<c.length;a+=1)s=Q(s,c[a]);return{c(){e=N("div"),i&&i.c(),this.h()},l(a){e=V(a,"DIV",{});var u=B(e);i&&i.l(u),u.forEach(w),this.h()},h(){Be(e,s)},m(a,u){R(a,e,u),i&&i.m(e,null),l[8](e),r=!0,t||(n=rt(l[2].action(e)),t=!0)},p(a,u){i&&i.p&&(!r||u&68)&&ye(i,o,a,a[6],r?Ce(o,a[6],u,_s):Te(a[6]),$n),Be(e,s=Le(c,[u&4&&a[2]]))},i(a){r||(C(i,a),r=!0)},o(a){S(i,a),r=!1},d(a){a&&w(e),i&&i.d(a),l[8](null),t=!1,n()}}}function ws(l){let e;const r=l[7].default,t=ke(r,l,l[6],Mn);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&68)&&ye(t,r,n,n[6],e?Ce(r,n[6],o,bs):Te(n[6]),Mn)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function ks(l){let e,r,t,n;const o=[ws,vs],i=[];function c(s,a){return s[1]?0:1}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,[a]){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function ys(l,e,r){let t,n;const o=["asChild","el"];let i=Ee(e,o),c,{$$slots:s={},$$scope:a}=e,{asChild:u=!1}=e,{el:f=void 0}=e;const{elements:{scrollbarY:p},getAttrs:h}=Bt();re(l,p,g=>r(5,c=g));const b=h("scrollbar-y");function m(g){He[g?"unshift":"push"](()=>{f=g,r(0,f)})}return l.$$set=g=>{e=Q(Q({},e),ge(g)),r(11,i=Ee(e,o)),"asChild"in g&&r(1,u=g.asChild),"el"in g&&r(0,f=g.el),"$$scope"in g&&r(6,a=g.$$scope)},l.$$.update=()=>{r(4,t={...i,...b}),l.$$.dirty&32&&r(2,n=c),l.$$.dirty&20&&Object.assign(n,t)},[f,u,n,p,t,c,a,s,m]}class Ts extends se{constructor(e){super(),ae(this,e,ys,ks,ie,{asChild:1,el:0})}}const Cs=l=>({builder:l&4}),In=l=>({builder:l[2]}),Es=l=>({builder:l&4}),An=l=>({builder:l[2]});function Ss(l){let e,r,t,n;const o=l[7].default,i=ke(o,l,l[6],In);let c=[l[2]],s={};for(let a=0;a<c.length;a+=1)s=Q(s,c[a]);return{c(){e=N("div"),i&&i.c(),this.h()},l(a){e=V(a,"DIV",{});var u=B(e);i&&i.l(u),u.forEach(w),this.h()},h(){Be(e,s)},m(a,u){R(a,e,u),i&&i.m(e,null),l[8](e),r=!0,t||(n=rt(l[2].action(e)),t=!0)},p(a,u){i&&i.p&&(!r||u&68)&&ye(i,o,a,a[6],r?Ce(o,a[6],u,Cs):Te(a[6]),In),Be(e,s=Le(c,[u&4&&a[2]]))},i(a){r||(C(i,a),r=!0)},o(a){S(i,a),r=!1},d(a){a&&w(e),i&&i.d(a),l[8](null),t=!1,n()}}}function $s(l){let e;const r=l[7].default,t=ke(r,l,l[6],An);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&68)&&ye(t,r,n,n[6],e?Ce(r,n[6],o,Es):Te(n[6]),An)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function Ms(l){let e,r,t,n;const o=[$s,Ss],i=[];function c(s,a){return s[1]?0:1}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,[a]){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function Is(l,e,r){let t,n;const o=["asChild","el"];let i=Ee(e,o),c,{$$slots:s={},$$scope:a}=e,{asChild:u=!1}=e,{el:f=void 0}=e;const{elements:{scrollbarX:p},getAttrs:h}=Bt();re(l,p,g=>r(5,c=g));const b=h("scrollbar-x");function m(g){He[g?"unshift":"push"](()=>{f=g,r(0,f)})}return l.$$set=g=>{e=Q(Q({},e),ge(g)),r(11,i=Ee(e,o)),"asChild"in g&&r(1,u=g.asChild),"el"in g&&r(0,f=g.el),"$$scope"in g&&r(6,a=g.$$scope)},l.$$.update=()=>{r(4,t={...i,...b}),l.$$.dirty&32&&r(2,n=c),l.$$.dirty&20&&Object.assign(n,t)},[f,u,n,p,t,c,a,s,m]}class As extends se{constructor(e){super(),ae(this,e,Is,Ms,ie,{asChild:1,el:0})}}const Ls=l=>({builder:l&64}),Ln=l=>({builder:l[6]}),Ps=l=>({builder:l&64}),Pn=l=>({builder:l[6]});function Ds(l){let e,r;const t=[l[2]];let n={$$slots:{default:[Ns,({builder:o})=>({6:o}),({builder:o})=>o?64:0]},$$scope:{ctx:l}};for(let o=0;o<t.length;o+=1)n=Q(n,t[o]);return e=new As({props:n}),{c(){W(e.$$.fragment)},l(o){J(e.$$.fragment,o)},m(o,i){G(e,o,i),r=!0},p(o,i){const c=i&4?Le(t,[nt(o[2])]):{};i&96&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){r||(C(e.$$.fragment,o),r=!0)},o(o){S(e.$$.fragment,o),r=!1},d(o){Y(e,o)}}}function Os(l){let e,r;const t=[l[2]];let n={$$slots:{default:[Vs,({builder:o})=>({6:o}),({builder:o})=>o?64:0]},$$scope:{ctx:l}};for(let o=0;o<t.length;o+=1)n=Q(n,t[o]);return e=new Ts({props:n}),{c(){W(e.$$.fragment)},l(o){J(e.$$.fragment,o)},m(o,i){G(e,o,i),r=!0},p(o,i){const c=i&4?Le(t,[nt(o[2])]):{};i&96&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){r||(C(e.$$.fragment,o),r=!0)},o(o){S(e.$$.fragment,o),r=!1},d(o){Y(e,o)}}}function Ns(l){let e;const r=l[4].default,t=ke(r,l,l[5],Ln);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&96)&&ye(t,r,n,n[5],e?Ce(r,n[5],o,Ls):Te(n[5]),Ln)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function Vs(l){let e;const r=l[4].default,t=ke(r,l,l[5],Pn);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&96)&&ye(t,r,n,n[5],e?Ce(r,n[5],o,Ps):Te(n[5]),Pn)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function zs(l){let e,r,t,n;const o=[Os,Ds],i=[];function c(s,a){return s[0]==="vertical"?0:1}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,[a]){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function Bs(l,e,r){const t=["orientation"];let n=Ee(e,t),o,{$$slots:i={},$$scope:c}=e,{orientation:s}=e;const a=we(s);return re(l,a,u=>r(0,o=u)),Xi(a),l.$$set=u=>{e=Q(Q({},e),ge(u)),r(2,n=Ee(e,t)),"orientation"in u&&r(3,s=u.orientation),"$$scope"in u&&r(5,c=u.$$scope)},l.$$.update=()=>{l.$$.dirty&8&&a.set(s)},[o,a,n,s,i,c]}let Us=class extends se{constructor(e){super(),ae(this,e,Bs,zs,ie,{orientation:3})}};const Rs=l=>({builder:l&4}),Dn=l=>({builder:l[2]}),Fs=l=>({builder:l&4}),On=l=>({builder:l[2]});function Hs(l){let e,r,t,n;const o=l[7].default,i=ke(o,l,l[6],Dn);let c=[l[2]],s={};for(let a=0;a<c.length;a+=1)s=Q(s,c[a]);return{c(){e=N("div"),i&&i.c(),this.h()},l(a){e=V(a,"DIV",{});var u=B(e);i&&i.l(u),u.forEach(w),this.h()},h(){Be(e,s)},m(a,u){R(a,e,u),i&&i.m(e,null),l[8](e),r=!0,t||(n=rt(l[2].action(e)),t=!0)},p(a,u){i&&i.p&&(!r||u&68)&&ye(i,o,a,a[6],r?Ce(o,a[6],u,Rs):Te(a[6]),Dn),Be(e,s=Le(c,[u&4&&a[2]]))},i(a){r||(C(i,a),r=!0)},o(a){S(i,a),r=!1},d(a){a&&w(e),i&&i.d(a),l[8](null),t=!1,n()}}}function js(l){let e;const r=l[7].default,t=ke(r,l,l[6],On);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&68)&&ye(t,r,n,n[6],e?Ce(r,n[6],o,Fs):Te(n[6]),On)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function qs(l){let e,r,t,n;const o=[js,Hs],i=[];function c(s,a){return s[1]?0:1}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,[a]){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function Ws(l,e,r){let t,n;const o=["asChild","el"];let i=Ee(e,o),c,{$$slots:s={},$$scope:a}=e,{asChild:u=!1}=e,{el:f=void 0}=e;const{elements:{thumbY:p},getAttrs:h}=Bt();re(l,p,g=>r(5,c=g));const b=h("thumb-y");function m(g){He[g?"unshift":"push"](()=>{f=g,r(0,f)})}return l.$$set=g=>{e=Q(Q({},e),ge(g)),r(11,i=Ee(e,o)),"asChild"in g&&r(1,u=g.asChild),"el"in g&&r(0,f=g.el),"$$scope"in g&&r(6,a=g.$$scope)},l.$$.update=()=>{r(4,t={...i,...b}),l.$$.dirty&32&&r(2,n=c),l.$$.dirty&20&&Object.assign(n,t)},[f,u,n,p,t,c,a,s,m]}class Gs extends se{constructor(e){super(),ae(this,e,Ws,qs,ie,{asChild:1,el:0})}}const Ys=l=>({builder:l&4}),Nn=l=>({builder:l[2]}),Xs=l=>({builder:l&4}),Vn=l=>({builder:l[2]});function Zs(l){let e,r,t,n;const o=l[7].default,i=ke(o,l,l[6],Nn);let c=[l[2]],s={};for(let a=0;a<c.length;a+=1)s=Q(s,c[a]);return{c(){e=N("div"),i&&i.c(),this.h()},l(a){e=V(a,"DIV",{});var u=B(e);i&&i.l(u),u.forEach(w),this.h()},h(){Be(e,s)},m(a,u){R(a,e,u),i&&i.m(e,null),l[8](e),r=!0,t||(n=rt(l[2].action(e)),t=!0)},p(a,u){i&&i.p&&(!r||u&68)&&ye(i,o,a,a[6],r?Ce(o,a[6],u,Ys):Te(a[6]),Nn),Be(e,s=Le(c,[u&4&&a[2]]))},i(a){r||(C(i,a),r=!0)},o(a){S(i,a),r=!1},d(a){a&&w(e),i&&i.d(a),l[8](null),t=!1,n()}}}function Js(l){let e;const r=l[7].default,t=ke(r,l,l[6],Vn);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&68)&&ye(t,r,n,n[6],e?Ce(r,n[6],o,Xs):Te(n[6]),Vn)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function Ks(l){let e,r,t,n;const o=[Js,Zs],i=[];function c(s,a){return s[1]?0:1}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,[a]){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function Qs(l,e,r){let t,n;const o=["asChild","el"];let i=Ee(e,o),c,{$$slots:s={},$$scope:a}=e,{asChild:u=!1}=e,{el:f=void 0}=e;const{elements:{thumbX:p},getAttrs:h}=Bt();re(l,p,g=>r(5,c=g));const b=h("thumb-x");function m(g){He[g?"unshift":"push"](()=>{f=g,r(0,f)})}return l.$$set=g=>{e=Q(Q({},e),ge(g)),r(11,i=Ee(e,o)),"asChild"in g&&r(1,u=g.asChild),"el"in g&&r(0,f=g.el),"$$scope"in g&&r(6,a=g.$$scope)},l.$$.update=()=>{r(4,t={...i,...b}),l.$$.dirty&32&&r(2,n=c),l.$$.dirty&20&&Object.assign(n,t)},[f,u,n,p,t,c,a,s,m]}class xs extends se{constructor(e){super(),ae(this,e,Qs,Ks,ie,{asChild:1,el:0})}}const ea=l=>({builder:l&32}),zn=l=>({builder:l[5]}),ta=l=>({builder:l&32}),Bn=l=>({builder:l[5]});function ra(l){let e,r;const t=[l[2]];let n={$$slots:{default:[la,({builder:o})=>({5:o}),({builder:o})=>o?32:0]},$$scope:{ctx:l}};for(let o=0;o<t.length;o+=1)n=Q(n,t[o]);return e=new xs({props:n}),{c(){W(e.$$.fragment)},l(o){J(e.$$.fragment,o)},m(o,i){G(e,o,i),r=!0},p(o,i){const c=i&4?Le(t,[nt(o[2])]):{};i&48&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){r||(C(e.$$.fragment,o),r=!0)},o(o){S(e.$$.fragment,o),r=!1},d(o){Y(e,o)}}}function na(l){let e,r;const t=[l[2]];let n={$$slots:{default:[oa,({builder:o})=>({5:o}),({builder:o})=>o?32:0]},$$scope:{ctx:l}};for(let o=0;o<t.length;o+=1)n=Q(n,t[o]);return e=new Gs({props:n}),{c(){W(e.$$.fragment)},l(o){J(e.$$.fragment,o)},m(o,i){G(e,o,i),r=!0},p(o,i){const c=i&4?Le(t,[nt(o[2])]):{};i&48&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){r||(C(e.$$.fragment,o),r=!0)},o(o){S(e.$$.fragment,o),r=!1},d(o){Y(e,o)}}}function la(l){let e;const r=l[3].default,t=ke(r,l,l[4],zn);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&48)&&ye(t,r,n,n[4],e?Ce(r,n[4],o,ea):Te(n[4]),zn)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function oa(l){let e;const r=l[3].default,t=ke(r,l,l[4],Bn);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&48)&&ye(t,r,n,n[4],e?Ce(r,n[4],o,ta):Te(n[4]),Bn)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function ia(l){let e,r,t,n;const o=[na,ra],i=[];function c(s,a){return s[0]==="vertical"?0:1}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,[a]){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function sa(l,e,r){const t=[];let n=Ee(e,t),o,{$$slots:i={},$$scope:c}=e;const s=Zi();return re(l,s,a=>r(0,o=a)),l.$$set=a=>{e=Q(Q({},e),ge(a)),r(2,n=Ee(e,t)),"$$scope"in a&&r(4,c=a.$$scope)},[o,s,n,i,c]}class aa extends se{constructor(e){super(),ae(this,e,sa,ia,ie,{})}}const ca=l=>({builder:l&4}),Un=l=>({builder:l[2]}),ua=l=>({builder:l&4}),Rn=l=>({builder:l[2]});function fa(l){let e,r,t,n;const o=l[7].default,i=ke(o,l,l[6],Un);let c=[l[2]],s={};for(let a=0;a<c.length;a+=1)s=Q(s,c[a]);return{c(){e=N("div"),i&&i.c(),this.h()},l(a){e=V(a,"DIV",{});var u=B(e);i&&i.l(u),u.forEach(w),this.h()},h(){Be(e,s)},m(a,u){R(a,e,u),i&&i.m(e,null),l[8](e),r=!0,t||(n=rt(l[2].action(e)),t=!0)},p(a,u){i&&i.p&&(!r||u&68)&&ye(i,o,a,a[6],r?Ce(o,a[6],u,ca):Te(a[6]),Un),Be(e,s=Le(c,[u&4&&a[2]]))},i(a){r||(C(i,a),r=!0)},o(a){S(i,a),r=!1},d(a){a&&w(e),i&&i.d(a),l[8](null),t=!1,n()}}}function da(l){let e;const r=l[7].default,t=ke(r,l,l[6],Rn);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&68)&&ye(t,r,n,n[6],e?Ce(r,n[6],o,ua):Te(n[6]),Rn)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function ha(l){let e,r,t,n;const o=[da,fa],i=[];function c(s,a){return s[1]?0:1}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,[a]){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function ma(l,e,r){let t,n;const o=["asChild","el"];let i=Ee(e,o),c,{$$slots:s={},$$scope:a}=e,{asChild:u=!1}=e,{el:f=void 0}=e;const{elements:{corner:p},getAttrs:h}=Bt();re(l,p,g=>r(5,c=g));const b=h("corner");function m(g){He[g?"unshift":"push"](()=>{f=g,r(0,f)})}return l.$$set=g=>{e=Q(Q({},e),ge(g)),r(11,i=Ee(e,o)),"asChild"in g&&r(1,u=g.asChild),"el"in g&&r(0,f=g.el),"$$scope"in g&&r(6,a=g.$$scope)},l.$$.update=()=>{r(4,t={...i,...b}),l.$$.dirty&32&&r(2,n=c),l.$$.dirty&20&&Object.assign(n,t)},[f,u,n,p,t,c,a,s,m]}class ga extends se{constructor(e){super(),ae(this,e,ma,ha,ie,{asChild:1,el:0})}}function no(){return{NAME:"slider",PARTS:["root","input","range","thumb","tick"]}}function pa(l){const{NAME:e,PARTS:r}=no(),t=Xl(e,r),n={...Wi(Wl(l)),getAttrs:t};return $r(e,n),{...n,updateOption:Gl(n.options)}}function lo(){const{NAME:l}=no();return Xt(l)}const _a=l=>({builder:l&4,ticks:l&8,thumbs:l&16}),Fn=l=>({builder:l[2],ticks:l[3],thumbs:l[4]}),ba=l=>({builder:l&4,ticks:l&8,thumbs:l&16}),Hn=l=>({builder:l[2],ticks:l[3],thumbs:l[4]});function va(l){let e,r,t,n;const o=l[19].default,i=ke(o,l,l[18],Fn);let c=[l[2],l[8]],s={};for(let a=0;a<c.length;a+=1)s=Q(s,c[a]);return{c(){e=N("span"),i&&i.c(),this.h()},l(a){e=V(a,"SPAN",{});var u=B(e);i&&i.l(u),u.forEach(w),this.h()},h(){Be(e,s)},m(a,u){R(a,e,u),i&&i.m(e,null),l[20](e),r=!0,t||(n=rt(l[2].action(e)),t=!0)},p(a,u){i&&i.p&&(!r||u&262172)&&ye(i,o,a,a[18],r?Ce(o,a[18],u,_a):Te(a[18]),Fn),Be(e,s=Le(c,[u&4&&a[2],u&256&&a[8]]))},i(a){r||(C(i,a),r=!0)},o(a){S(i,a),r=!1},d(a){a&&w(e),i&&i.d(a),l[20](null),t=!1,n()}}}function wa(l){let e;const r=l[19].default,t=ke(r,l,l[18],Hn);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&262172)&&ye(t,r,n,n[18],e?Ce(r,n[18],o,ba):Te(n[18]),Hn)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function ka(l){let e,r,t,n;const o=[wa,va],i=[];function c(s,a){return s[1]?0:1}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,[a]){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function ya(l,e,r){let t;const n=["disabled","min","max","step","orientation","dir","value","onValueChange","asChild","el"];let o=Ee(e,n),i,c,s,{$$slots:a={},$$scope:u}=e,{disabled:f=void 0}=e,{min:p=void 0}=e,{max:h=void 0}=e,{step:b=void 0}=e,{orientation:m=void 0}=e,{dir:g=void 0}=e,{value:T=void 0}=e,{onValueChange:$=void 0}=e,{asChild:I=!1}=e,{el:E=void 0}=e;const{elements:{root:k,ticks:_,thumbs:d},states:{value:y},updateOption:v,getAttrs:L}=pa({disabled:f,dir:g,min:p,max:h,step:b,orientation:m,defaultValue:T,onValueChange:({next:A})=>(T!==A&&($==null||$(A),r(9,T=A)),A)});re(l,k,A=>r(17,i=A)),re(l,_,A=>r(3,c=A)),re(l,d,A=>r(4,s=A));const D=L("root");function O(A){He[A?"unshift":"push"](()=>{E=A,r(0,E)})}return l.$$set=A=>{e=Q(Q({},e),ge(A)),r(8,o=Ee(e,n)),"disabled"in A&&r(10,f=A.disabled),"min"in A&&r(11,p=A.min),"max"in A&&r(12,h=A.max),"step"in A&&r(13,b=A.step),"orientation"in A&&r(14,m=A.orientation),"dir"in A&&r(15,g=A.dir),"value"in A&&r(9,T=A.value),"onValueChange"in A&&r(16,$=A.onValueChange),"asChild"in A&&r(1,I=A.asChild),"el"in A&&r(0,E=A.el),"$$scope"in A&&r(18,u=A.$$scope)},l.$$.update=()=>{l.$$.dirty&512&&T!==void 0&&y.set(T),l.$$.dirty&1024&&v("disabled",f),l.$$.dirty&2048&&v("min",p),l.$$.dirty&4096&&v("max",h),l.$$.dirty&8192&&v("step",b),l.$$.dirty&16384&&v("orientation",m),l.$$.dirty&32768&&v("dir",g),l.$$.dirty&131072&&r(2,t=i),l.$$.dirty&4&&Object.assign(t,D)},[E,I,t,c,s,k,_,d,o,T,f,p,h,b,m,g,$,i,u,a,O]}let Ta=class extends se{constructor(e){super(),ae(this,e,ya,ka,ie,{disabled:10,min:11,max:12,step:13,orientation:14,dir:15,value:9,onValueChange:16,asChild:1,el:0})}};const Ca=l=>({builder:l&4}),jn=l=>({builder:l[2]});function Ea(l){let e,r,t,n=[l[2],l[4]],o={};for(let i=0;i<n.length;i+=1)o=Q(o,n[i]);return{c(){e=N("span"),this.h()},l(i){e=V(i,"SPAN",{}),B(e).forEach(w),this.h()},h(){Be(e,o)},m(i,c){R(i,e,c),l[8](e),r||(t=rt(l[2].action(e)),r=!0)},p(i,c){Be(e,o=Le(n,[c&4&&i[2],c&16&&i[4]]))},i:de,o:de,d(i){i&&w(e),l[8](null),r=!1,t()}}}function Sa(l){let e;const r=l[7].default,t=ke(r,l,l[6],jn);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&68)&&ye(t,r,n,n[6],e?Ce(r,n[6],o,Ca):Te(n[6]),jn)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function $a(l){let e,r,t,n;const o=[Sa,Ea],i=[];function c(s,a){return s[1]?0:1}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,[a]){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function Ma(l,e,r){let t;const n=["asChild","el"];let o=Ee(e,n),i,{$$slots:c={},$$scope:s}=e,{asChild:a=!1}=e,{el:u=void 0}=e;const{elements:{range:f},getAttrs:p}=lo();re(l,f,m=>r(5,i=m));const h=p("range");function b(m){He[m?"unshift":"push"](()=>{u=m,r(0,u)})}return l.$$set=m=>{e=Q(Q({},e),ge(m)),r(4,o=Ee(e,n)),"asChild"in m&&r(1,a=m.asChild),"el"in m&&r(0,u=m.el),"$$scope"in m&&r(6,s=m.$$scope)},l.$$.update=()=>{l.$$.dirty&32&&r(2,t=i),l.$$.dirty&4&&Object.assign(t,h)},[u,a,t,f,o,i,s,c,b]}class Ia extends se{constructor(e){super(),ae(this,e,Ma,$a,ie,{asChild:1,el:0})}}const Aa=l=>({builder:l&4}),qn=l=>({builder:l[2]});function La(l){let e,r,t,n=[l[2],l[4]],o={};for(let i=0;i<n.length;i+=1)o=Q(o,n[i]);return{c(){e=N("span"),this.h()},l(i){e=V(i,"SPAN",{}),B(e).forEach(w),this.h()},h(){Be(e,o)},m(i,c){R(i,e,c),l[8](e),r||(t=[rt(l[2].action(e)),Me(e,"m-keydown",l[3])],r=!0)},p(i,c){Be(e,o=Le(n,[c&4&&i[2],c&16&&i[4]]))},i:de,o:de,d(i){i&&w(e),l[8](null),r=!1,vt(t)}}}function Pa(l){let e;const r=l[7].default,t=ke(r,l,l[6],qn);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&68)&&ye(t,r,n,n[6],e?Ce(r,n[6],o,Aa):Te(n[6]),qn)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function Da(l){let e,r,t,n;const o=[Pa,La],i=[];function c(s,a){return s[1]?0:1}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,[a]){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function Oa(l,e,r){let t;const n=["asChild","el","thumb"];let o=Ee(e,n),{$$slots:i={},$$scope:c}=e,{asChild:s=!1}=e,{el:a=void 0}=e,{thumb:u}=e;const{getAttrs:f}=lo(),p=Co(),h=f("thumb");function b(m){He[m?"unshift":"push"](()=>{a=m,r(0,a)})}return l.$$set=m=>{e=Q(Q({},e),ge(m)),r(4,o=Ee(e,n)),"asChild"in m&&r(1,s=m.asChild),"el"in m&&r(0,a=m.el),"thumb"in m&&r(5,u=m.thumb),"$$scope"in m&&r(6,c=m.$$scope)},l.$$.update=()=>{l.$$.dirty&32&&r(2,t=u),l.$$.dirty&4&&Object.assign(t,h)},[a,s,t,p,o,u,c,i,b]}class Na extends se{constructor(e){super(),ae(this,e,Oa,Da,ie,{asChild:1,el:0,thumb:5})}}const Va=l=>({builder:l&4}),Wn=l=>({builder:l[2]}),za=l=>({builder:l&4}),Gn=l=>({builder:l[2]});function Ba(l){let e,r,t,n;const o=l[8].default,i=ke(o,l,l[7],Wn);let c=[l[2],l[4]],s={};for(let a=0;a<c.length;a+=1)s=Q(s,c[a]);return{c(){e=N("div"),i&&i.c(),this.h()},l(a){e=V(a,"DIV",{});var u=B(e);i&&i.l(u),u.forEach(w),this.h()},h(){Be(e,s)},m(a,u){R(a,e,u),i&&i.m(e,null),l[9](e),r=!0,t||(n=rt(l[2].action(e)),t=!0)},p(a,u){i&&i.p&&(!r||u&132)&&ye(i,o,a,a[7],r?Ce(o,a[7],u,Va):Te(a[7]),Wn),Be(e,s=Le(c,[u&4&&a[2],u&16&&a[4]]))},i(a){r||(C(i,a),r=!0)},o(a){S(i,a),r=!1},d(a){a&&w(e),i&&i.d(a),l[9](null),t=!1,n()}}}function Ua(l){let e;const r=l[8].default,t=ke(r,l,l[7],Gn);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&132)&&ye(t,r,n,n[7],e?Ce(r,n[7],o,za):Te(n[7]),Gn)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function Ra(l){let e,r,t,n;const o=[Ua,Ba],i=[];function c(s,a){return s[1]?0:1}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,[a]){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function Fa(l,e,r){let t;const n=["value","asChild","el"];let o=Ee(e,n),i,{$$slots:c={},$$scope:s}=e,{value:a}=e,{asChild:u=!1}=e,{el:f=void 0}=e;const{elements:{content:p},getAttrs:h}=Eo();re(l,p,g=>r(6,i=g));const b=h("content");function m(g){He[g?"unshift":"push"](()=>{f=g,r(0,f)})}return l.$$set=g=>{e=Q(Q({},e),ge(g)),r(4,o=Ee(e,n)),"value"in g&&r(5,a=g.value),"asChild"in g&&r(1,u=g.asChild),"el"in g&&r(0,f=g.el),"$$scope"in g&&r(7,s=g.$$scope)},l.$$.update=()=>{l.$$.dirty&96&&r(2,t=i(a)),l.$$.dirty&4&&Object.assign(t,b)},[f,u,t,p,o,a,i,s,c,m]}let Ha=class extends se{constructor(e){super(),ae(this,e,Fa,Ra,ie,{value:5,asChild:1,el:0})}};function ja(l){let e;const r=l[3].default,t=ke(r,l,l[4],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&16)&&ye(t,r,n,n[4],e?Ce(r,n[4],o,null):Te(n[4]),null)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function qa(l){let e,r;const t=[{class:mt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",l[0])},{value:l[1]},l[2]];let n={$$slots:{default:[ja]},$$scope:{ctx:l}};for(let o=0;o<t.length;o+=1)n=Q(n,t[o]);return e=new Ha({props:n}),{c(){W(e.$$.fragment)},l(o){J(e.$$.fragment,o)},m(o,i){G(e,o,i),r=!0},p(o,[i]){const c=i&7?Le(t,[i&1&&{class:mt("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",o[0])},i&2&&{value:o[1]},i&4&&nt(o[2])]):{};i&16&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){r||(C(e.$$.fragment,o),r=!0)},o(o){S(e.$$.fragment,o),r=!1},d(o){Y(e,o)}}}function Wa(l,e,r){const t=["class","value"];let n=Ee(e,t),{$$slots:o={},$$scope:i}=e,{class:c=void 0}=e,{value:s}=e;return l.$$set=a=>{e=Q(Q({},e),ge(a)),r(2,n=Ee(e,t)),"class"in a&&r(0,c=a.class),"value"in a&&r(1,s=a.value),"$$scope"in a&&r(4,i=a.$$scope)},[c,s,n,o,i]}class Rr extends se{constructor(e){super(),ae(this,e,Wa,qa,ie,{class:0,value:1})}}const Jr=we([]),ft=we({showMarkerMenu:!1,showVehicleMenu:!1}),qt=we(!1),sn=we(),Ga=we(!1),Yt=we(!1);function Ya(){const{subscribe:l,set:e,update:r}=we(null);return{subscribe:l,set:e,update:r,reset:()=>e(null),setEndTime:t=>r(n=>n?{...n,endTime:t}:null),addCoordinate:t=>r(n=>n&&{...n,path:[...n.path,t]})}}function Xa(){const{subscribe:l,set:e,update:r}=we([]);return{subscribe:l,set:e,update:r,add:t=>r(n=>[...n,t]),clear:()=>e([])}}function Za(){const{subscribe:l,set:e,update:r}=we([]);return{subscribe:l,set:e,update:r,add:t=>r(n=>[...n,t]),remove:t=>r(n=>n.filter(o=>!t.some(i=>i.timestamp===o.timestamp))),clear:()=>e([])}}function Ja(){const{subscribe:l,set:e,update:r}=we([]);return{subscribe:l,set:e,update:r,add:t=>r(n=>[...n,t]),remove:t=>r(n=>n.filter(o=>o.trail_id!==t.trail_id)),clear:()=>e([])}}const at=Ya(),Er=Xa(),Et=Za(),xt=Ja(),st=we([]),it=we([]),Ka=!1,ot={controls:{showMarkerMenu:!1,showVehicleMenu:!1},showEndTrailModal:!1,trailingButtonPressed:!1,crispVisibility:!1,drawingModeEnabled:!1,currentTrail:null,coordinateBuffer:[],unsavedCoordinates:[],unsavedTrails:[],historicalTrails:[],otherActiveTrails:[]};function Qa(){ft.set(ot.controls),qt.set(ot.showEndTrailModal),sn.set(ot.trailingButtonPressed),Ga.set(ot.crispVisibility),Yt.set(ot.drawingModeEnabled),at.set(ot.currentTrail),Er.set(ot.coordinateBuffer),Et.set(ot.unsavedCoordinates),xt.set(ot.unsavedTrails),st.set(ot.historicalTrails),it.set(ot.otherActiveTrails)}const xa=async({url:l,fetch:e,depends:r})=>{Qa();const t=l.searchParams.get("field");let n=null,o=null;return["field","vehicle","marker"].forEach(i=>{const c=l.searchParams.get(i);c&&(n=i,o=c)}),{field:t,type:n,id:o}},dh=Object.freeze(Object.defineProperty({__proto__:null,load:xa,prerender:Ka},Symbol.toStringTag,{value:"Module"})),Yn=we(null),Ht=we(null);function ec(){const{subscribe:l,set:e,update:r}=we([]);function t(n,o){const i=l(n,o);return()=>{i()}}return{subscribe:t,set:e,update:r}}const Qe=ec();function tc(){const{subscribe:l,set:e,update:r}=we([],()=>()=>{});return{subscribe:l,set:e,update:r}}const rr=tc();function rc(){const{subscribe:l,set:e,update:r}=we([],()=>()=>{});return{subscribe:l,set:e,update:r}}const nr=rc(),kr=we({synchronizeMarkers:null,spinning:!1});function nc(){const{subscribe:l,set:e,update:r}=we(null);return{subscribe:l,set:e,update:r,triggerLocationMarker:()=>r(t=>Date.now())}}const Kr=nc(),oo=we(null),Qr=we(null),lc=we(!1);function Xn(l,e,r){const t=l.slice();return t[19]=e[r],t}function Zn(l){let e,r,t,n,o='<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-green-500" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>',i,c,s='<svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path></svg>',a,u,f,p,h,b,m=ht(l[1]),g=[];for(let $=0;$<m.length;$+=1)g[$]=Jn(Xn(l,m,$));const T=$=>S(g[$],1,1,()=>{g[$]=null});return{c(){e=N("div"),r=N("div"),t=N("div"),n=N("button"),n.innerHTML=o,i=X(),c=N("button"),c.innerHTML=s,a=X(),u=N("div"),f=N("div");for(let $=0;$<g.length;$+=1)g[$].c();this.h()},l($){e=V($,"DIV",{class:!0});var I=B(e);r=V(I,"DIV",{class:!0});var E=B(r);t=V(E,"DIV",{class:!0});var k=B(t);n=V(k,"BUTTON",{class:!0,"data-svelte-h":!0}),$e(n)!=="svelte-13ooeyd"&&(n.innerHTML=o),i=Z(k),c=V(k,"BUTTON",{class:!0,"data-svelte-h":!0}),$e(c)!=="svelte-7ywqrw"&&(c.innerHTML=s),k.forEach(w),a=Z(E),u=V(E,"DIV",{class:!0});var _=B(u);f=V(_,"DIV",{class:!0});var d=B(f);for(let y=0;y<g.length;y+=1)g[y].l(d);d.forEach(w),_.forEach(w),E.forEach(w),I.forEach(w),this.h()},h(){P(n,"class","flex items-center justify-center border-r border-gray-300 p-4 transition duration-200 hover:bg-green-300"),P(c,"class","flex items-center justify-center p-4 transition duration-200 hover:bg-red-300"),P(t,"class","grid grid-cols-2 bg-gray-200"),P(f,"class","grid-auto-flow grid-auto-columns grid gap-2 svelte-swoi0v"),P(u,"class","max-h-64 overflow-auto p-2"),P(r,"class","w-11/12 overflow-hidden rounded-lg border-2 border-gray-300 bg-white bg-opacity-90 text-black shadow-lg sm:w-1/2"),P(e,"class","fixed bottom-0 left-0 right-0 z-10 mb-8 flex justify-center")},m($,I){R($,e,I),M(e,r),M(r,t),M(t,n),M(t,i),M(t,c),M(r,a),M(r,u),M(u,f);for(let E=0;E<g.length;E+=1)g[E]&&g[E].m(f,null);p=!0,h||(b=[Me(n,"click",l[2]),Me(c,"click",l[3])],h=!0)},p($,I){if(I&18){m=ht($[1]);let E;for(E=0;E<m.length;E+=1){const k=Xn($,m,E);g[E]?(g[E].p(k,I),C(g[E],1)):(g[E]=Jn(k),g[E].c(),C(g[E],1),g[E].m(f,null))}for(he(),E=m.length;E<g.length;E+=1)T(E);me()}},i($){if(!p){for(let I=0;I<m.length;I+=1)C(g[I]);p=!0}},o($){g=g.filter(Boolean);for(let I=0;I<g.length;I+=1)S(g[I]);p=!1},d($){$&&w(e),or(g,$),h=!1,vt(b)}}}function oc(l){let e;return{c(){e=N("i"),this.h()},l(r){e=V(r,"I",{class:!0}),B(e).forEach(w),this.h()},h(){P(e,"class",Gr(`${l[19].class} text-3xl text-gray-700`)+" svelte-swoi0v")},m(r,t){R(r,e,t)},p:de,i:de,o:de,d(r){r&&w(e)}}}function ic(l){let e;return{c(){e=N("ion-icon"),this.h()},l(r){e=V(r,"ION-ICON",{name:!0,style:!0}),B(e).forEach(w),this.h()},h(){mo(e,"name",l[19].id),Oe(e,"font-size","32px")},m(r,t){R(r,e,t)},p:de,i:de,o:de,d(r){r&&w(e)}}}function sc(l){let e,r;return e=new Ul({props:{icon:l[19].id,size:"42px"}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p:de,i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function Jn(l){let e,r,t,n,o,i,c,s;const a=[sc,ic,oc],u=[];function f(h,b){return h[19].class.startsWith("custom-svg")?0:h[19].class.startsWith("ionic-")?1:2}t=f(l),n=u[t]=a[t](l);function p(){return l[7](l[19])}return{c(){e=N("button"),r=N("div"),n.c(),o=X(),this.h()},l(h){e=V(h,"BUTTON",{class:!0});var b=B(e);r=V(b,"DIV",{class:!0,style:!0});var m=B(r);n.l(m),m.forEach(w),o=Z(b),b.forEach(w),this.h()},h(){P(r,"class","flex transform items-center justify-center rounded-lg bg-gray-200 p-3 transition duration-200 hover:scale-125 hover:bg-gray-300"),Oe(r,"width","50px"),Oe(r,"height","45px"),P(e,"class","marker-icon focus:outline-none svelte-swoi0v")},m(h,b){R(h,e,b),M(e,r),u[t].m(r,null),M(e,o),i=!0,c||(s=Me(e,"click",p),c=!0)},p(h,b){l=h,n.p(l,b)},i(h){i||(C(n),i=!0)},o(h){S(n),i=!1},d(h){h&&w(e),u[t].d(),c=!1,s()}}}function ac(l){let e,r,t=l[0].showMarkerMenu&&Zn(l);return{c(){t&&t.c(),e=oe()},l(n){t&&t.l(n),e=oe()},m(n,o){t&&t.m(n,o),R(n,e,o),r=!0},p(n,[o]){n[0].showMarkerMenu?t?(t.p(n,o),o&1&&C(t,1)):(t=Zn(n),t.c(),C(t,1),t.m(e.parentNode,e)):t&&(he(),S(t,1,1,()=>{t=null}),me())},i(n){r||(C(t),r=!0)},o(n){S(t),r=!1},d(n){n&&w(e),t&&t.d(n)}}}function Kn(l,e){const r=new CustomEvent("handleUpdateMarkerListeners",{detail:{marker:l,id:e}});document.dispatchEvent(r)}function cc(l,e,r){let t,n,o,i;re(l,Qe,_=>r(10,t=_)),re(l,Ht,_=>r(11,n=_)),re(l,Kr,_=>r(12,o=_)),re(l,ft,_=>r(0,i=_));const{getMap:c}=Xt("map");let s,a;const u=[{id:"rock",class:"custom-svg"},{id:"tree13",class:"custom-svg"},{id:"watertank2",class:"custom-svg"},{id:"wheat2",class:"custom-svg"},{id:"kangaroo",class:"custom-svg"},{id:"electric_tower",class:"custom-svg"},{id:"gate",class:"custom-svg"},{id:"machine_pump",class:"custom-svg"},{id:"recharge_icon",class:"custom-svg"},{id:"repair_shop",class:"custom-svg"},{id:"tractor",class:"custom-svg"},{id:"silo2",class:"custom-svg"},{id:"tree_stump",class:"custom-svg"},{id:"workshop_icon",class:"custom-svg"},{id:"pin",class:"ionic-pin"},{id:"arrow-up-circle",class:"ionic-arrow-up-circle"},{id:"arrow-down-circle",class:"ionic-arrow-down-circle"},{id:"arrow-back-circle",class:"ionic-arrow-back-circle"},{id:"arrow-forward-circle",class:"ionic-arrow-forward-circle"},{id:"thumbs-down",class:"ionic-thumbs-down"},{id:"thumbs-up",class:"ionic-thumbs-up"},{id:"accessibility",class:"ionic-accessibility"},{id:"people",class:"ionic-people"},{id:"settings",class:"ionic-settings"},{id:"home",class:"ionic-home"},{id:"checkmark-circle",class:"ionic-checkmark-circle"},{id:"close-circle",class:"ionic-close-circle"},{id:"information-circle",class:"ionic-information-circle"},{id:"warning",class:"ionic-warning"},{id:"help-circle",class:"ionic-help-circle"},{id:"ban",class:"ionic-ban"},{id:"location",class:"ionic-location"},{id:"lock-closed",class:"ionic-lock-closed"},{id:"lock-open",class:"ionic-lock-open"},{id:"trash",class:"ionic-trash"},{id:"cart",class:"ionic-cart"},{id:"locate",class:"ionic-locate"},{id:"leaf",class:"ionic-leaf"},{id:"call",class:"ionic-call"},{id:"wifi",class:"ionic-wifi"},{id:"radio",class:"ionic-radio"},{id:"cloud-offline",class:"ionic-cloud-offline"},{id:"battery-charging",class:"ionic-battery-charging"},{id:"thermometer",class:"ionic-thermometer"},{id:"sunny",class:"ionic-sunny"},{id:"cloud",class:"ionic-cloud"},{id:"thunderstorm",class:"ionic-thunderstorm"},{id:"rainy",class:"ionic-rainy"},{id:"water",class:"ionic-water"},{id:"fast-food",class:"ionic-fast-food"},{id:"restaurant",class:"ionic-restaurant"},{id:"cart",class:"ionic-cart"},{id:"airplane",class:"ionic-airplane"},{id:"trail-sign",class:"ionic-trail-sign"},{id:"car",class:"ionic-car"},{id:"beer",class:"ionic-beer"},{id:"bonfire",class:"ionic-bonfire"},{id:"boat",class:"ionic-boat"},{id:"bed",class:"ionic-bed"},{id:"bicycle",class:"ionic-bicycle"},{id:"build",class:"ionic-build"},{id:"desktop",class:"ionic-desktop"},{id:"earth",class:"ionic-earth"},{id:"camera",class:"ionic-camera"},{id:"fish",class:"ionic-fish"},{id:"flame",class:"ionic-flame"},{id:"footsteps",class:"ionic-footsteps"},{id:"key",class:"ionic-key"},{id:"man",class:"ionic-man"},{id:"paw",class:"ionic-paw"},{id:"skull",class:"ionic-skull"},{id:"construct",class:"ionic-construct"},{id:"bus",class:"ionic-bus"},{id:"subway",class:"ionic-subway"},{id:"telescope",class:"ionic-telescope"},{id:"construction-truck",class:"at-construction-truck"},{id:"electric-car",class:"at-electric-car"},{id:"gasoline",class:"at-gasoline"},{id:"kg-weight",class:"at-kg-weight"},{id:"carrot",class:"at-carrot"},{id:"middle-finger",class:"at-middle-finger"},{id:"toilet-bathroom",class:"at-toilet-bathroom"},{id:"car-garage",class:"at-car-garage"},{id:"electricity-home",class:"at-electricity-home"},{id:"carrot-turnip-vegetable",class:"at-carrot-turnip-vegetable"},{id:"wheat-harvest",class:"at-wheat-harvest"},{id:"helicopter-travel",class:"at-helicopter-travel"},{id:"camper-vehicle",class:"at-camper-vehicle"},{id:"cargo-transport",class:"at-cargo-transport"},{id:"bulldozer",class:"at-bulldozer"},{id:"construction-transport",class:"at-construction-transport"},{id:"crane-truck",class:"at-crane-truck"},{id:"delivery-truck",class:"at-delivery-truck"},{id:"liquid-transportation",class:"at-liquid-transportation"},{id:"transport-truck",class:"at-transport-truck"},{id:"ladder-truck",class:"at-ladder-truck"}];let{markerPlacementEvent:f=null}=e,{markerClickEvent:p=null}=e;Xe(async()=>{await c(),document.querySelector(".map-container"),s=nr.subscribe(E),a=Kr.subscribe(_=>{_&&h()})}),gt(()=>{console.log("Destroying MarkerManager"),s&&s(),a&&a(),Qe.set([]),rr.set([]),nr.set([])});async function h(){const _=await c(),d=o;if(d){const y=new Ke.LngLat(d.longitude,d.latitude),v=gn(),L=b(y,"default",v);L.addTo(_),Qe.update(D=>[...D,{marker:L,id:v,last_confirmed:new Date().toISOString(),iconClass:"default"}]),_.flyTo({center:y,zoom:15,duration:1e3}),console.log("Marker placed at current location:",y)}else console.error("Unable to get current location")}function b(_,d,y){if(d==="default"){const D=new Ke.Marker().setLngLat(_);return D.getElement().setAttribute("data-marker-id",y),Kn(D,y),D}const v=document.createElement("div");if(v.style.width="35px",v.style.height="35px",v.setAttribute("data-marker-id",y),v.style.display="flex",v.style.justifyContent="center",v.style.alignItems="center",v.style.borderRadius="100%",v.style.backgroundColor="LightGray",v.style.opacity=.9,v.style.boxShadow="0 2px 4px rgba(0, 0, 0, 0.2)",d.startsWith("custom-svg-"))new Ul({target:v,props:{icon:d.replace("custom-svg-",""),size:"25px",color:"black"}}),v.querySelector("svg").dataset.icon=d.replace("custom-svg-","");else if(d.startsWith("ionic-")){const D=document.createElement("ion-icon");D.setAttribute("name",d.replace("ionic-","")),D.style.fontSize="28px",D.style.color="black",v.appendChild(D)}else{const D=document.createElement("i");D.className=d,D.style.fontSize="20px",D.style.color="black",D.style.fill="#ff6347",D.style.fontWeight="bold",v.appendChild(D)}const L=new Ke.Marker({element:v}).setLngLat(_);return Kn(L,y),L}async function m(_){const d=await c(),{lngLat:y}=_;if(y){if(n){const{marker:D}=n;D.remove()}const v=gn(),L=b(y,"default",v);L.setLngLat(y).addTo(d),Ht.set({marker:L,id:v}),d.flyTo({center:y,duration:1e3}),ft.update(D=>({...D,showMarkerMenu:!0})),console.log("Marker ID Placed:",v,n)}else console.error("Invalid event format. Missing lngLat property.")}function g(){if(n){const{marker:_,id:d}=n,y=new Date().toISOString(),v=t.find(H=>H.id===d);let L="default";const D=_.getElement(),O=D.querySelector("svg[data-icon]");if(O&&O.dataset.icon)L=`custom-svg-${O.dataset.icon}`;else{const H=D.querySelector("ion-icon");if(H)L=`ionic-${H.getAttribute("name")}`;else{const U=D.querySelector("i");U&&(L=U.className)}}const A={marker:_,id:d,last_confirmed:y,iconClass:L};v?(console.log("Updating existing marker:",A),Qe.update(H=>H.map(U=>U.id===d?A:U))):(console.log("Adding new marker:",A),Qe.update(H=>[...H,A])),Ht.set(null)}ft.update(_=>({..._,showMarkerMenu:!1}))}function T(){if(n){const{marker:_,id:d}=n;_.remove(),Ht.set(null);const y=t.find(v=>v.id===d);y&&(Qe.update(v=>{const L=v.filter(D=>D.id!==d);return rr.update(D=>[...D,{id:d,last_confirmed:y.last_confirmed}]),L}),console.log("Marker removed:",d))}ft.update(_=>({..._,showMarkerMenu:!1}))}async function $(_){const d=await c(),{marker:y,id:v}=_;if(Ht.set({marker:y,id:v}),console.log(`Marker selected with ID: ${v}`,n),n){const L=y.getLngLat();d.flyTo({center:L,zoom:15,duration:1e3}),ft.update(D=>({...D,showMarkerMenu:!0}))}}async function I(_){const d=await c();let y=_.id;if(n){const{marker:v,id:L}=n,D=v.getLngLat();v.remove();let O;_.class.startsWith("custom-svg")?O=b(D,`custom-svg-${y}`,L):O=b(D,_.class,L),O.addTo(d);const A={marker:O,id:L};Ht.set(A)}}async function E(_){const d=await c(),y=[];_.forEach((v,L)=>{const{markerData:D}=v,{id:O,marker_data:A,last_confirmed:H,iconClass:U}=D;if(v.action==="add"||v.action==="update"){const{geometry:q,properties:ne}=A,{coordinates:z}=q,F=new Ke.LngLat(z[0],z[1]),j=U||ne.icon,ee=b(F,j,O);ee.setLngLat(F).addTo(d),v.action==="add"?Qe.update(x=>[...x,{marker:ee,id:O,last_confirmed:H,iconClass:j}]):Qe.update(x=>x.map(K=>K.id===O?{marker:ee,id:O,last_confirmed:H,iconClass:j}:K)),y.push(L)}else if(v.action==="delete"){const q=t.find(ne=>ne.id===O);if(q){const{marker:ne}=q;ne.remove(),Qe.update(z=>z.filter(F=>F.id!==O)),console.log("Marker removed:",D)}y.push(L)}}),y.length>0&&nr.update(v=>v.filter((L,D)=>!y.includes(D)))}const k=_=>I(_);return l.$$set=_=>{"markerPlacementEvent"in _&&r(5,f=_.markerPlacementEvent),"markerClickEvent"in _&&r(6,p=_.markerClickEvent)},l.$$.update=()=>{l.$$.dirty&32&&f&&m(f),l.$$.dirty&64&&p&&$(p)},[i,u,g,T,I,f,p,k]}class uc extends se{constructor(e){super(),ae(this,e,cc,ac,ie,{markerPlacementEvent:5,markerClickEvent:6})}}const fc=(l,e)=>{const r=l[e];return r?typeof r=="function"?r():Promise.resolve(r):new Promise((t,n)=>{(typeof queueMicrotask=="function"?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+e)))})};function dc(){const{subscribe:l,set:e,update:r}=we({id:null,coordinates:null,last_update:null,is_trailing:!1,vehicle_marker:{type:"simpleTractor",color:"red",size:"25px",swath:12,path:()=>wo(()=>import("../chunks/v4.3c2c735a.js").then(t=>t.a),["..\\chunks\\v4.3c2c735a.js","..\\chunks\\scheduler.0ff5556b.js","..\\chunks\\index.e3d1f712.js","..\\chunks\\spread.8a54911c.js","..\\chunks\\Icon.c7f64379.js","..\\chunks\\each.1577e3f3.js","..\\assets\\Loader.aa8c585a.css"],import.meta.url)},heading:0});return{subscribe:l,set:e,update:r,updateVehicleMarker:t=>{r(n=>({...n,vehicle_marker:{...n.vehicle_marker,...t,path:()=>fc(Object.assign({}),`../components/SVG/${t.type}.svelte`)}}))}}}const $t=dc(),ct=we(!1),io=we([]),vr=we([]),yr=we([]),hc=we([]);function Qn(l,e,r){const t=l.slice();return t[5]=e[r],t}function xn(l){let e,r;return e=new Na({props:{thumb:l[5],class:"border-primary bg-background ring-offset-background focus-visible:ring-ring block h-5 w-5 rounded-full border-2 transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,n){const o={};n&16&&(o.thumb=t[5]),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function mc(l){let e,r,t,n,o;r=new Ia({props:{class:"bg-primary absolute h-full"}});let i=ht(l[4]),c=[];for(let a=0;a<i.length;a+=1)c[a]=xn(Qn(l,i,a));const s=a=>S(c[a],1,1,()=>{c[a]=null});return{c(){e=N("span"),W(r.$$.fragment),t=X();for(let a=0;a<c.length;a+=1)c[a].c();n=oe(),this.h()},l(a){e=V(a,"SPAN",{class:!0});var u=B(e);J(r.$$.fragment,u),u.forEach(w),t=Z(a);for(let f=0;f<c.length;f+=1)c[f].l(a);n=oe(),this.h()},h(){P(e,"class","bg-secondary relative h-2 w-full grow overflow-hidden rounded-full")},m(a,u){R(a,e,u),G(r,e,null),R(a,t,u);for(let f=0;f<c.length;f+=1)c[f]&&c[f].m(a,u);R(a,n,u),o=!0},p(a,u){if(u&16){i=ht(a[4]);let f;for(f=0;f<i.length;f+=1){const p=Qn(a,i,f);c[f]?(c[f].p(p,u),C(c[f],1)):(c[f]=xn(p),c[f].c(),C(c[f],1),c[f].m(n.parentNode,n))}for(he(),f=i.length;f<c.length;f+=1)s(f);me()}},i(a){if(!o){C(r.$$.fragment,a);for(let u=0;u<i.length;u+=1)C(c[u]);o=!0}},o(a){S(r.$$.fragment,a),c=c.filter(Boolean);for(let u=0;u<c.length;u+=1)S(c[u]);o=!1},d(a){a&&(w(e),w(t),w(n)),Y(r),or(c,a)}}}function gc(l){let e,r,t;const n=[{class:mt("relative flex w-full touch-none select-none items-center",l[1])},l[2]];function o(c){l[3](c)}let i={$$slots:{default:[mc,({thumbs:c})=>({4:c}),({thumbs:c})=>c?16:0]},$$scope:{ctx:l}};for(let c=0;c<n.length;c+=1)i=Q(i,n[c]);return l[0]!==void 0&&(i.value=l[0]),e=new Ta({props:i}),He.push(()=>Ir(e,"value",o)),{c(){W(e.$$.fragment)},l(c){J(e.$$.fragment,c)},m(c,s){G(e,c,s),t=!0},p(c,[s]){const a=s&6?Le(n,[s&2&&{class:mt("relative flex w-full touch-none select-none items-center",c[1])},s&4&&nt(c[2])]):{};s&272&&(a.$$scope={dirty:s,ctx:c}),!r&&s&1&&(r=!0,a.value=c[0],Mr(()=>r=!1)),e.$set(a)},i(c){t||(C(e.$$.fragment,c),t=!0)},o(c){S(e.$$.fragment,c),t=!1},d(c){Y(e,c)}}}function pc(l,e,r){const t=["class","value"];let n=Ee(e,t),{class:o=void 0}=e,{value:i=[0]}=e;function c(s){i=s,r(0,i)}return l.$$set=s=>{e=Q(Q({},e),ge(s)),r(2,n=Ee(e,t)),"class"in s&&r(1,o=s.class),"value"in s&&r(0,i=s.value)},[i,o,n,c]}class _c extends se{constructor(e){super(),ae(this,e,pc,gc,ie,{class:1,value:0})}}function bc(l){let e,r,t;const n=l[2].default,o=ke(n,l,l[3],null);return r=new aa({props:{class:mt("bg-border relative rounded-full",l[1]==="vertical"&&"flex-1")}}),{c(){o&&o.c(),e=X(),W(r.$$.fragment)},l(i){o&&o.l(i),e=Z(i),J(r.$$.fragment,i)},m(i,c){o&&o.m(i,c),R(i,e,c),G(r,i,c),t=!0},p(i,c){o&&o.p&&(!t||c&8)&&ye(o,n,i,i[3],t?Ce(n,i[3],c,null):Te(i[3]),null);const s={};c&2&&(s.class=mt("bg-border relative rounded-full",i[1]==="vertical"&&"flex-1")),r.$set(s)},i(i){t||(C(o,i),C(r.$$.fragment,i),t=!0)},o(i){S(o,i),S(r.$$.fragment,i),t=!1},d(i){i&&w(e),o&&o.d(i),Y(r,i)}}}function vc(l){let e,r;return e=new Us({props:{orientation:l[1],class:mt("flex touch-none select-none transition-colors",l[1]==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-px",l[1]==="horizontal"&&"h-2.5 w-full border-t border-t-transparent p-px",l[0]),$$slots:{default:[bc]},$$scope:{ctx:l}}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,[n]){const o={};n&2&&(o.orientation=t[1]),n&3&&(o.class=mt("flex touch-none select-none transition-colors",t[1]==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-px",t[1]==="horizontal"&&"h-2.5 w-full border-t border-t-transparent p-px",t[0])),n&10&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function wc(l,e,r){let{$$slots:t={},$$scope:n}=e,{class:o=void 0}=e,{orientation:i="vertical"}=e;return l.$$set=c=>{"class"in c&&r(0,o=c.class),"orientation"in c&&r(1,i=c.orientation),"$$scope"in c&&r(3,n=c.$$scope)},[o,i,t,n]}class so extends se{constructor(e){super(),ae(this,e,wc,vc,ie,{class:0,orientation:1})}}function kc(l){let e;const r=l[5].default,t=ke(r,l,l[6],null);return{c(){t&&t.c()},l(n){t&&t.l(n)},m(n,o){t&&t.m(n,o),e=!0},p(n,o){t&&t.p&&(!e||o&64)&&ye(t,r,n,n[6],e?Ce(r,n[6],o,null):Te(n[6]),null)},i(n){e||(C(t,n),e=!0)},o(n){S(t,n),e=!1},d(n){t&&t.d(n)}}}function yc(l){let e,r;return e=new ps({props:{$$slots:{default:[kc]},$$scope:{ctx:l}}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,n){const o={};n&64&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function el(l){let e,r;return e=new so({props:{orientation:"vertical",class:l[3]}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,n){const o={};n&8&&(o.class=t[3]),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function tl(l){let e,r;return e=new so({props:{orientation:"horizontal",class:l[2]}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,n){const o={};n&4&&(o.class=t[2]),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function Tc(l){let e,r,t,n,o,i;e=new cs({props:{class:"h-full w-full rounded-[inherit]",$$slots:{default:[yc]},$$scope:{ctx:l}}});let c=(l[1]==="vertical"||l[1]==="both")&&el(l),s=(l[1]==="horizontal"||l[1]==="both")&&tl(l);return o=new ga({}),{c(){W(e.$$.fragment),r=X(),c&&c.c(),t=X(),s&&s.c(),n=X(),W(o.$$.fragment)},l(a){J(e.$$.fragment,a),r=Z(a),c&&c.l(a),t=Z(a),s&&s.l(a),n=Z(a),J(o.$$.fragment,a)},m(a,u){G(e,a,u),R(a,r,u),c&&c.m(a,u),R(a,t,u),s&&s.m(a,u),R(a,n,u),G(o,a,u),i=!0},p(a,u){const f={};u&64&&(f.$$scope={dirty:u,ctx:a}),e.$set(f),a[1]==="vertical"||a[1]==="both"?c?(c.p(a,u),u&2&&C(c,1)):(c=el(a),c.c(),C(c,1),c.m(t.parentNode,t)):c&&(he(),S(c,1,1,()=>{c=null}),me()),a[1]==="horizontal"||a[1]==="both"?s?(s.p(a,u),u&2&&C(s,1)):(s=tl(a),s.c(),C(s,1),s.m(n.parentNode,n)):s&&(he(),S(s,1,1,()=>{s=null}),me())},i(a){i||(C(e.$$.fragment,a),C(c),C(s),C(o.$$.fragment,a),i=!0)},o(a){S(e.$$.fragment,a),S(c),S(s),S(o.$$.fragment,a),i=!1},d(a){a&&(w(r),w(t),w(n)),Y(e,a),c&&c.d(a),s&&s.d(a),Y(o,a)}}}function Cc(l){let e,r;const t=[l[4],{class:mt("relative overflow-hidden",l[0])}];let n={$$slots:{default:[Tc]},$$scope:{ctx:l}};for(let o=0;o<t.length;o+=1)n=Q(n,t[o]);return e=new rs({props:n}),{c(){W(e.$$.fragment)},l(o){J(e.$$.fragment,o)},m(o,i){G(e,o,i),r=!0},p(o,[i]){const c=i&17?Le(t,[i&16&&nt(o[4]),i&1&&{class:mt("relative overflow-hidden",o[0])}]):{};i&78&&(c.$$scope={dirty:i,ctx:o}),e.$set(c)},i(o){r||(C(e.$$.fragment,o),r=!0)},o(o){S(e.$$.fragment,o),r=!1},d(o){Y(e,o)}}}function Ec(l,e,r){const t=["class","orientation","scrollbarXClasses","scrollbarYClasses"];let n=Ee(e,t),{$$slots:o={},$$scope:i}=e,{class:c=void 0}=e,{orientation:s="vertical"}=e,{scrollbarXClasses:a=""}=e,{scrollbarYClasses:u=""}=e;return l.$$set=f=>{e=Q(Q({},e),ge(f)),r(4,n=Ee(e,t)),"class"in f&&r(0,c=f.class),"orientation"in f&&r(1,s=f.orientation),"scrollbarXClasses"in f&&r(2,a=f.scrollbarXClasses),"scrollbarYClasses"in f&&r(3,u=f.scrollbarYClasses),"$$scope"in f&&r(6,i=f.$$scope)},[c,s,a,u,n,o,i]}class an extends se{constructor(e){super(),ae(this,e,Ec,Cc,ie,{class:0,orientation:1,scrollbarXClasses:2,scrollbarYClasses:3})}}function rl(l,e,r){const t=l.slice();return t[28]=e[r],t}function nl(l,e,r){const t=l.slice();return t[31]=e[r],t}function ll(l,e,r){const t=l.slice();return t[34]=e[r],t}function Sc(l){let e;return{c(){e=_e("Vehicles")},l(r){e=be(r,"Vehicles")},m(r,t){R(r,e,t)},d(r){r&&w(e)}}}function $c(l){let e;return{c(){e=_e("Colors")},l(r){e=be(r,"Colors")},m(r,t){R(r,e,t)},d(r){r&&w(e)}}}function Mc(l){let e;return{c(){e=_e("Swath")},l(r){e=be(r,"Swath")},m(r,t){R(r,e,t)},d(r){r&&w(e)}}}function Ic(l){let e,r,t,n,o,i;return e=new Br({props:{value:"vehicles",class:"rounded-md px-4 py-2 text-gray-700 transition-all duration-200 hover:bg-gray-200 data-[state=active]:bg-white data-[state=active]:shadow-md",$$slots:{default:[Sc]},$$scope:{ctx:l}}}),t=new Br({props:{value:"colors",class:"rounded-md px-4 py-2 text-gray-700 transition-all duration-200 hover:bg-gray-200 data-[state=active]:bg-white data-[state=active]:shadow-md",$$slots:{default:[$c]},$$scope:{ctx:l}}}),o=new Br({props:{value:"swath",class:"rounded-md px-4 py-2 text-gray-700 transition-all duration-200 hover:bg-gray-200 data-[state=active]:bg-white data-[state=active]:shadow-md",$$slots:{default:[Mc]},$$scope:{ctx:l}}}),{c(){W(e.$$.fragment),r=X(),W(t.$$.fragment),n=X(),W(o.$$.fragment)},l(c){J(e.$$.fragment,c),r=Z(c),J(t.$$.fragment,c),n=Z(c),J(o.$$.fragment,c)},m(c,s){G(e,c,s),R(c,r,s),G(t,c,s),R(c,n,s),G(o,c,s),i=!0},p(c,s){const a={};s[1]&64&&(a.$$scope={dirty:s,ctx:c}),e.$set(a);const u={};s[1]&64&&(u.$$scope={dirty:s,ctx:c}),t.$set(u);const f={};s[1]&64&&(f.$$scope={dirty:s,ctx:c}),o.$set(f)},i(c){i||(C(e.$$.fragment,c),C(t.$$.fragment,c),C(o.$$.fragment,c),i=!0)},o(c){S(e.$$.fragment,c),S(t.$$.fragment,c),S(o.$$.fragment,c),i=!1},d(c){c&&(w(r),w(n)),Y(e,c),Y(t,c),Y(o,c)}}}function Ac(l){let e,r,t;var n=It[l[34].type];function o(i,c){return{props:{bodyColor:i[34].bodyColor,size:"100%"}}}return n&&(e=Mt(n,o(l))),{c(){e&&W(e.$$.fragment),r=X()},l(i){e&&J(e.$$.fragment,i),r=Z(i)},m(i,c){e&&G(e,i,c),R(i,r,c),t=!0},p(i,c){if(c[0]&8&&n!==(n=It[i[34].type])){if(e){he();const s=e;S(s.$$.fragment,1,0,()=>{Y(s,1)}),me()}n?(e=Mt(n,o(i)),W(e.$$.fragment),C(e.$$.fragment,1),G(e,r.parentNode,r)):e=null}else if(n){const s={};c[0]&8&&(s.bodyColor=i[34].bodyColor),e.$set(s)}},i(i){t||(e&&C(e.$$.fragment,i),t=!0)},o(i){e&&S(e.$$.fragment,i),t=!1},d(i){i&&w(r),e&&Y(e,i)}}}function ol(l){let e,r;function t(){return l[18](l[34])}return e=new Gt({props:{variant:"outline",class:"h-24 w-24 border-2 p-2",$$slots:{default:[Ac]},$$scope:{ctx:l}}}),e.$on("click",t),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,o){G(e,n,o),r=!0},p(n,o){l=n;const i={};o[0]&8|o[1]&64&&(i.$$scope={dirty:o,ctx:l}),e.$set(i)},i(n){r||(C(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){Y(e,n)}}}function Lc(l){let e,r,t=ht(l[3]),n=[];for(let i=0;i<t.length;i+=1)n[i]=ol(ll(l,t,i));const o=i=>S(n[i],1,1,()=>{n[i]=null});return{c(){e=N("div");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=V(i,"DIV",{class:!0});var c=B(e);for(let s=0;s<n.length;s+=1)n[s].l(c);c.forEach(w),this.h()},h(){P(e,"class","grid-container p-4 svelte-1it14s8")},m(i,c){R(i,e,c);for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(e,null);r=!0},p(i,c){if(c[0]&264){t=ht(i[3]);let s;for(s=0;s<t.length;s+=1){const a=ll(i,t,s);n[s]?(n[s].p(a,c),C(n[s],1)):(n[s]=ol(a),n[s].c(),C(n[s],1),n[s].m(e,null))}for(he(),s=t.length;s<n.length;s+=1)o(s);me()}},i(i){if(!r){for(let c=0;c<t.length;c+=1)C(n[c]);r=!0}},o(i){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)S(n[c]);r=!1},d(i){i&&w(e),or(n,i)}}}function Pc(l){let e,r;return e=new an({props:{class:"h-full",type:"auto",$$slots:{default:[Lc]},$$scope:{ctx:l}}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,n){const o={};n[0]&8|n[1]&64&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function il(l){let e,r;function t(){return l[19](l[31])}return e=new Gt({props:{variant:"outline",class:"h-24 w-24 border-2 p-2",style:"background-color: "+l[31]+";"}}),e.$on("click",t),{c(){W(e.$$.fragment)},l(n){J(e.$$.fragment,n)},m(n,o){G(e,n,o),r=!0},p(n,o){l=n},i(n){r||(C(e.$$.fragment,n),r=!0)},o(n){S(e.$$.fragment,n),r=!1},d(n){Y(e,n)}}}function Dc(l){let e,r,t=ht(l[9]),n=[];for(let i=0;i<t.length;i+=1)n[i]=il(nl(l,t,i));const o=i=>S(n[i],1,1,()=>{n[i]=null});return{c(){e=N("div");for(let i=0;i<n.length;i+=1)n[i].c();this.h()},l(i){e=V(i,"DIV",{class:!0});var c=B(e);for(let s=0;s<n.length;s+=1)n[s].l(c);c.forEach(w),this.h()},h(){P(e,"class","grid-container p-4 svelte-1it14s8")},m(i,c){R(i,e,c);for(let s=0;s<n.length;s+=1)n[s]&&n[s].m(e,null);r=!0},p(i,c){if(c[0]&4608){t=ht(i[9]);let s;for(s=0;s<t.length;s+=1){const a=nl(i,t,s);n[s]?(n[s].p(a,c),C(n[s],1)):(n[s]=il(a),n[s].c(),C(n[s],1),n[s].m(e,null))}for(he(),s=t.length;s<n.length;s+=1)o(s);me()}},i(i){if(!r){for(let c=0;c<t.length;c+=1)C(n[c]);r=!0}},o(i){n=n.filter(Boolean);for(let c=0;c<n.length;c+=1)S(n[c]);r=!1},d(i){i&&w(e),or(n,i)}}}function Oc(l){let e,r;return e=new an({props:{class:"h-full",type:"auto",$$slots:{default:[Dc]},$$scope:{ctx:l}}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,n){const o={};n[1]&64&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function Nc(l){let e,r;return e=new Ao({props:{class:"h-4 w-4"}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p:de,i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function Vc(l){let e,r,t;return r=new Gt({props:{variant:"ghost",size:"icon",class:"ml-2",$$slots:{default:[Nc]},$$scope:{ctx:l}}}),r.$on("click",l[20]),{c(){e=_e(`Swath Width
                        `),W(r.$$.fragment)},l(n){e=be(n,`Swath Width
                        `),J(r.$$.fragment,n)},m(n,o){R(n,e,o),G(r,n,o),t=!0},p(n,o){const i={};o[1]&64&&(i.$$scope={dirty:o,ctx:n}),r.$set(i)},i(n){t||(C(r.$$.fragment,n),t=!0)},o(n){S(r.$$.fragment,n),t=!1},d(n){n&&w(e),Y(r,n)}}}function zc(l){let e,r;return e=new Hl({props:{class:"flex items-center",$$slots:{default:[Vc]},$$scope:{ctx:l}}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,n){const o={};n[1]&64&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function sl(l){let e,r,t,n,o,i;function c(){return l[21](l[28])}return{c(){e=N("button"),r=_e(l[28]),t=_e(`m
                          `),this.h()},l(s){e=V(s,"BUTTON",{class:!0});var a=B(e);r=be(a,l[28]),t=be(a,`m
                          `),a.forEach(w),this.h()},h(){P(e,"class",n="rounded-full px-3 py-1 text-sm "+(l[2].swath===l[28]?"bg-primary text-white":"bg-gray-200"))},m(s,a){R(s,e,a),M(e,r),M(e,t),o||(i=Me(e,"click",c),o=!0)},p(s,a){l=s,a[0]&4&&n!==(n="rounded-full px-3 py-1 text-sm "+(l[2].swath===l[28]?"bg-primary text-white":"bg-gray-200"))&&P(e,"class",n)},d(s){s&&w(e),o=!1,i()}}}function Bc(l){let e,r,t,n,o,i,c,s,a=l[1][0]+"",u,f,p,h=ht([4,8,10,12,24,36]),b=[];for(let m=0;m<6;m+=1)b[m]=sl(rl(l,h,m));return n=new Zl({props:{class:"h-5 w-5"}}),i=new _c({props:{value:l[1],onValueChange:l[7],min:2,max:50,step:1,class:"flex-grow [&_[role=slider]]:h-5 [&_[role=slider]]:w-5 [&_[role=slider]]:bg-gray-100 [&_[role=slider]]:shadow-[inset_-2px_-2px_5px_rgba(255,255,255,0.7),inset_2px_2px_5px_rgba(0,0,0,0.1)] [&_[role=track]]:h-2 [&_[role=track]]:bg-gray-200 [&_[role=track]]:shadow-[inset_1px_1px_3px_rgba(0,0,0,0.1),inset_-1px_-1px_3px_rgba(255,255,255,0.7)]"}}),{c(){e=N("div");for(let m=0;m<6;m+=1)b[m].c();r=X(),t=N("div"),W(n.$$.fragment),o=X(),W(i.$$.fragment),c=X(),s=N("span"),u=_e(a),f=_e("m"),this.h()},l(m){e=V(m,"DIV",{class:!0});var g=B(e);for(let I=0;I<6;I+=1)b[I].l(g);g.forEach(w),r=Z(m),t=V(m,"DIV",{class:!0});var T=B(t);J(n.$$.fragment,T),o=Z(T),J(i.$$.fragment,T),c=Z(T),s=V(T,"SPAN",{class:!0});var $=B(s);u=be($,a),f=be($,"m"),$.forEach(w),T.forEach(w),this.h()},h(){P(e,"class","mb-4 grid grid-cols-3 gap-2"),P(s,"class","font-semibold"),P(t,"class","flex items-center space-x-2")},m(m,g){R(m,e,g);for(let T=0;T<6;T+=1)b[T]&&b[T].m(e,null);R(m,r,g),R(m,t,g),G(n,t,null),M(t,o),G(i,t,null),M(t,c),M(t,s),M(s,u),M(s,f),p=!0},p(m,g){if(g[0]&132){h=ht([4,8,10,12,24,36]);let $;for($=0;$<6;$+=1){const I=rl(m,h,$);b[$]?b[$].p(I,g):(b[$]=sl(I),b[$].c(),b[$].m(e,null))}for(;$<6;$+=1)b[$].d(1)}const T={};g[0]&2&&(T.value=m[1]),i.$set(T),(!p||g[0]&2)&&a!==(a=m[1][0]+"")&&Fe(u,a)},i(m){p||(C(n.$$.fragment,m),C(i.$$.fragment,m),p=!0)},o(m){S(n.$$.fragment,m),S(i.$$.fragment,m),p=!1},d(m){m&&(w(e),w(r),w(t)),or(b,m),Y(n),Y(i)}}}function Uc(l){let e,r,t,n;return e=new Rl({props:{class:"flex items-center",$$slots:{default:[zc]},$$scope:{ctx:l}}}),t=new Fl({props:{$$slots:{default:[Bc]},$$scope:{ctx:l}}}),{c(){W(e.$$.fragment),r=X(),W(t.$$.fragment)},l(o){J(e.$$.fragment,o),r=Z(o),J(t.$$.fragment,o)},m(o,i){G(e,o,i),R(o,r,i),G(t,o,i),n=!0},p(o,i){const c={};i[1]&64&&(c.$$scope={dirty:i,ctx:o}),e.$set(c);const s={};i[0]&6|i[1]&64&&(s.$$scope={dirty:i,ctx:o}),t.$set(s)},i(o){n||(C(e.$$.fragment,o),C(t.$$.fragment,o),n=!0)},o(o){S(e.$$.fragment,o),S(t.$$.fragment,o),n=!1},d(o){o&&w(r),Y(e,o),Y(t,o)}}}function Rc(l){let e,r,t;return r=new Yr({props:{$$slots:{default:[Uc]},$$scope:{ctx:l}}}),{c(){e=N("div"),W(r.$$.fragment),this.h()},l(n){e=V(n,"DIV",{class:!0});var o=B(e);J(r.$$.fragment,o),o.forEach(w),this.h()},h(){P(e,"class","space-y-4 p-4")},m(n,o){R(n,e,o),G(r,e,null),t=!0},p(n,o){const i={};o[0]&6|o[1]&64&&(i.$$scope={dirty:o,ctx:n}),r.$set(i)},i(n){t||(C(r.$$.fragment,n),t=!0)},o(n){S(r.$$.fragment,n),t=!1},d(n){n&&w(e),Y(r)}}}function Fc(l){let e,r;return e=new an({props:{class:"h-full",type:"auto",$$slots:{default:[Rc]},$$scope:{ctx:l}}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,n){const o={};n[0]&6|n[1]&64&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function Hc(l){let e,r,t,n,o,i,c,s,a;return e=new $o({props:{class:"grid w-full grid-cols-3 gap-1",$$slots:{default:[Ic]},$$scope:{ctx:l}}}),n=new Rr({props:{value:"vehicles",class:"h-full",$$slots:{default:[Pc]},$$scope:{ctx:l}}}),i=new Rr({props:{value:"colors",class:"h-full",$$slots:{default:[Oc]},$$scope:{ctx:l}}}),s=new Rr({props:{value:"swath",class:"h-full",$$slots:{default:[Fc]},$$scope:{ctx:l}}}),{c(){W(e.$$.fragment),r=X(),t=N("div"),W(n.$$.fragment),o=X(),W(i.$$.fragment),c=X(),W(s.$$.fragment),this.h()},l(u){J(e.$$.fragment,u),r=Z(u),t=V(u,"DIV",{class:!0});var f=B(t);J(n.$$.fragment,f),o=Z(f),J(i.$$.fragment,f),c=Z(f),J(s.$$.fragment,f),f.forEach(w),this.h()},h(){P(t,"class","flex-grow overflow-hidden")},m(u,f){G(e,u,f),R(u,r,f),R(u,t,f),G(n,t,null),M(t,o),G(i,t,null),M(t,c),G(s,t,null),a=!0},p(u,f){const p={};f[1]&64&&(p.$$scope={dirty:f,ctx:u}),e.$set(p);const h={};f[0]&8|f[1]&64&&(h.$$scope={dirty:f,ctx:u}),n.$set(h);const b={};f[1]&64&&(b.$$scope={dirty:f,ctx:u}),i.$set(b);const m={};f[0]&6|f[1]&64&&(m.$$scope={dirty:f,ctx:u}),s.$set(m)},i(u){a||(C(e.$$.fragment,u),C(n.$$.fragment,u),C(i.$$.fragment,u),C(s.$$.fragment,u),a=!0)},o(u){S(e.$$.fragment,u),S(n.$$.fragment,u),S(i.$$.fragment,u),S(s.$$.fragment,u),a=!1},d(u){u&&(w(r),w(t)),Y(e,u),Y(n),Y(i),Y(s)}}}function jc(l){let e,r;return e=new So({props:{value:l[4],onValueChange:l[22],class:"rounded-lg bg-gray-100 p-1 shadow-inner",$$slots:{default:[Hc]},$$scope:{ctx:l}}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,n){const o={};n[0]&16&&(o.value=t[4]),n[0]&16&&(o.onValueChange=t[22]),n[0]&14|n[1]&64&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function qc(l){let e=l[2].type+"",r;return{c(){r=_e(e)},l(t){r=be(t,e)},m(t,n){R(t,r,n)},p(t,n){n[0]&4&&e!==(e=t[2].type+"")&&Fe(r,e)},d(t){t&&w(r)}}}function Wc(l){let e,r;return e=new Hl({props:{class:"max-w-full break-words px-2 text-xl font-semibold",$$slots:{default:[qc]},$$scope:{ctx:l}}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,n){const o={};n[0]&4|n[1]&64&&(o.$$scope={dirty:n,ctx:t}),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function Gc(l){let e,r,t,n,o;e=new ln({props:{class:"absolute right-2 top-2 h-4 w-4 text-gray-400"}});var i=It[l[2].type];function c(s,a){return{props:{bodyColor:s[2].bodyColor,size:`${s[2].size*1.8}px`}}}return i&&(t=Mt(i,c(l))),{c(){W(e.$$.fragment),r=X(),t&&W(t.$$.fragment),n=oe()},l(s){J(e.$$.fragment,s),r=Z(s),t&&J(t.$$.fragment,s),n=oe()},m(s,a){G(e,s,a),R(s,r,a),t&&G(t,s,a),R(s,n,a),o=!0},p(s,a){if(a[0]&4&&i!==(i=It[s[2].type])){if(t){he();const u=t;S(u.$$.fragment,1,0,()=>{Y(u,1)}),me()}i?(t=Mt(i,c(s)),W(t.$$.fragment),C(t.$$.fragment,1),G(t,n.parentNode,n)):t=null}else if(i){const u={};a[0]&4&&(u.bodyColor=s[2].bodyColor),a[0]&4&&(u.size=`${s[2].size*1.8}px`),t.$set(u)}},i(s){o||(C(e.$$.fragment,s),t&&C(t.$$.fragment,s),o=!0)},o(s){S(e.$$.fragment,s),t&&S(t.$$.fragment,s),o=!1},d(s){s&&(w(r),w(n)),Y(e,s),t&&Y(t,s)}}}function Yc(l){let e,r,t,n,o,i=l[2].bodyColor+"",c,s;return e=new ln({props:{class:"absolute right-2 top-2 h-4 w-4 text-gray-400"}}),t=new di({props:{class:"mb-2 h-5 w-5"}}),{c(){W(e.$$.fragment),r=X(),W(t.$$.fragment),n=X(),o=N("span"),c=_e(i)},l(a){J(e.$$.fragment,a),r=Z(a),J(t.$$.fragment,a),n=Z(a),o=V(a,"SPAN",{});var u=B(o);c=be(u,i),u.forEach(w)},m(a,u){G(e,a,u),R(a,r,u),G(t,a,u),R(a,n,u),R(a,o,u),M(o,c),s=!0},p(a,u){(!s||u[0]&4)&&i!==(i=a[2].bodyColor+"")&&Fe(c,i)},i(a){s||(C(e.$$.fragment,a),C(t.$$.fragment,a),s=!0)},o(a){S(e.$$.fragment,a),S(t.$$.fragment,a),s=!1},d(a){a&&(w(r),w(n),w(o)),Y(e,a),Y(t,a)}}}function Xc(l){let e,r,t,n,o,i=l[1][0]+"",c,s,a;return e=new ln({props:{class:"absolute right-2 top-2 h-4 w-4 text-gray-400"}}),t=new Zl({props:{class:"mb-2 h-5 w-5"}}),{c(){W(e.$$.fragment),r=X(),W(t.$$.fragment),n=X(),o=N("span"),c=_e(i),s=_e("m")},l(u){J(e.$$.fragment,u),r=Z(u),J(t.$$.fragment,u),n=Z(u),o=V(u,"SPAN",{});var f=B(o);c=be(f,i),s=be(f,"m"),f.forEach(w)},m(u,f){G(e,u,f),R(u,r,f),G(t,u,f),R(u,n,f),R(u,o,f),M(o,c),M(o,s),a=!0},p(u,f){(!a||f[0]&2)&&i!==(i=u[1][0]+"")&&Fe(c,i)},i(u){a||(C(e.$$.fragment,u),C(t.$$.fragment,u),a=!0)},o(u){S(e.$$.fragment,u),S(t.$$.fragment,u),a=!1},d(u){u&&(w(r),w(n),w(o)),Y(e,u),Y(t,u)}}}function Zc(l){let e,r,t,n,o,i,c;return e=new Gt({props:{variant:"outline",class:"relative flex h-40 w-full items-center justify-center",$$slots:{default:[Gc]},$$scope:{ctx:l}}}),e.$on("click",l[23]),n=new Gt({props:{variant:"outline",class:"relative flex h-20 flex-col items-center justify-center",$$slots:{default:[Yc]},$$scope:{ctx:l}}}),n.$on("click",l[24]),i=new Gt({props:{variant:"outline",class:"relative flex h-20 flex-col items-center justify-center",$$slots:{default:[Xc]},$$scope:{ctx:l}}}),i.$on("click",l[25]),{c(){W(e.$$.fragment),r=X(),t=N("div"),W(n.$$.fragment),o=X(),W(i.$$.fragment),this.h()},l(s){J(e.$$.fragment,s),r=Z(s),t=V(s,"DIV",{class:!0});var a=B(t);J(n.$$.fragment,a),o=Z(a),J(i.$$.fragment,a),a.forEach(w),this.h()},h(){P(t,"class","grid grid-cols-2 gap-4")},m(s,a){G(e,s,a),R(s,r,a),R(s,t,a),G(n,t,null),M(t,o),G(i,t,null),c=!0},p(s,a){const u={};a[0]&4|a[1]&64&&(u.$$scope={dirty:a,ctx:s}),e.$set(u);const f={};a[0]&4|a[1]&64&&(f.$$scope={dirty:a,ctx:s}),n.$set(f);const p={};a[0]&2|a[1]&64&&(p.$$scope={dirty:a,ctx:s}),i.$set(p)},i(s){c||(C(e.$$.fragment,s),C(n.$$.fragment,s),C(i.$$.fragment,s),c=!0)},o(s){S(e.$$.fragment,s),S(n.$$.fragment,s),S(i.$$.fragment,s),c=!1},d(s){s&&(w(r),w(t)),Y(e,s),Y(n),Y(i)}}}function Jc(l){let e,r,t,n;return e=new Rl({props:{class:"pb-2 text-center",$$slots:{default:[Wc]},$$scope:{ctx:l}}}),t=new Fl({props:{class:"space-y-4",$$slots:{default:[Zc]},$$scope:{ctx:l}}}),{c(){W(e.$$.fragment),r=X(),W(t.$$.fragment)},l(o){J(e.$$.fragment,o),r=Z(o),J(t.$$.fragment,o)},m(o,i){G(e,o,i),R(o,r,i),G(t,o,i),n=!0},p(o,i){const c={};i[0]&4|i[1]&64&&(c.$$scope={dirty:i,ctx:o}),e.$set(c);const s={};i[0]&22|i[1]&64&&(s.$$scope={dirty:i,ctx:o}),t.$set(s)},i(o){n||(C(e.$$.fragment,o),C(t.$$.fragment,o),n=!0)},o(o){S(e.$$.fragment,o),S(t.$$.fragment,o),n=!1},d(o){o&&w(r),Y(e,o),Y(t,o)}}}function Kc(l){let e,r,t,n,o,i,c,s,a,u,f="Cancel",p,h,b,m,g,T,$,I;return n=new Yr({props:{class:"h-full overflow-hidden border-2 border-gray-300",$$slots:{default:[jc]},$$scope:{ctx:l}}}),c=new Yr({props:{class:"h-full w-full",$$slots:{default:[Jc]},$$scope:{ctx:l}}}),{c(){e=N("div"),r=N("div"),t=N("div"),W(n.$$.fragment),o=X(),i=N("div"),W(c.$$.fragment),s=X(),a=N("div"),u=N("button"),u.textContent=f,p=X(),h=N("button"),b=_e("Confirm"),this.h()},l(E){e=V(E,"DIV",{class:!0,style:!0});var k=B(e);r=V(k,"DIV",{class:!0});var _=B(r);t=V(_,"DIV",{class:!0});var d=B(t);J(n.$$.fragment,d),d.forEach(w),o=Z(_),i=V(_,"DIV",{class:!0});var y=B(i);J(c.$$.fragment,y),y.forEach(w),_.forEach(w),s=Z(k),a=V(k,"DIV",{class:!0});var v=B(a);u=V(v,"BUTTON",{class:!0,"data-svelte-h":!0}),$e(u)!=="svelte-15xc6ca"&&(u.textContent=f),p=Z(v),h=V(v,"BUTTON",{class:!0});var L=B(h);b=be(L,"Confirm"),L.forEach(w),v.forEach(w),k.forEach(w),this.h()},h(){P(t,"class","flex w-full flex-grow flex-col overflow-hidden sm:w-1/2 sm:pr-4"),P(i,"class","mt-4 flex w-full flex-col sm:mt-0 sm:w-1/2 sm:pl-4"),P(r,"class","flex flex-grow flex-col overflow-hidden text-black sm:flex-row"),P(u,"class","btn mr-2 flex-1"),P(h,"class","btn btn-primary ml-2 flex-1"),h.disabled=m=!l[6],P(a,"class","mt-6 flex"),P(e,"class","fixed bottom-0 left-0 right-0 z-20 flex transform flex-col rounded-t-lg bg-white p-6 shadow-lg transition-transform duration-300 sm:p-8"),P(e,"style",g=l[5]?"height: 100%;":"height: 60vh;"),St(e,"translate-y-full",!l[0]),St(e,"translate-y-0",l[0])},m(E,k){R(E,e,k),M(e,r),M(r,t),G(n,t,null),M(r,o),M(r,i),G(c,i,null),M(e,s),M(e,a),M(a,u),M(a,p),M(a,h),M(h,b),T=!0,$||(I=[Me(u,"click",l[11]),Me(h,"click",l[10])],$=!0)},p(E,k){const _={};k[0]&30|k[1]&64&&(_.$$scope={dirty:k,ctx:E}),n.$set(_);const d={};k[0]&22|k[1]&64&&(d.$$scope={dirty:k,ctx:E}),c.$set(d),(!T||k[0]&64&&m!==(m=!E[6]))&&(h.disabled=m),(!T||k[0]&32&&g!==(g=E[5]?"height: 100%;":"height: 60vh;"))&&P(e,"style",g),(!T||k[0]&1)&&St(e,"translate-y-full",!E[0]),(!T||k[0]&1)&&St(e,"translate-y-0",E[0])},i(E){T||(C(n.$$.fragment,E),C(c.$$.fragment,E),T=!0)},o(E){S(n.$$.fragment,E),S(c.$$.fragment,E),T=!1},d(E){E&&w(e),Y(n),Y(c),$=!1,vt(I)}}}function al(l){return l[Math.floor(Math.random()*l.length)]}function Qc(l,e){const r=l.filter(n=>!e.includes(n));if(r.length===0)return e.length=0,al(l);const t=al(r);return e.push(t),t}function xc(l,e,r){let t,n,o,i;const c=nn();let{showMenu:s=!1}=e,{currentVehicleType:a}=e,{currentVehicleSize:u}=e,{currentVehicleColor:f}=e,{currentVehicleSwath:p}=e,h="vehicles",b=[],m=[12];function g(U){const q=Array.isArray(U)?U[0]:U;r(1,m=[q]),r(2,o={...o,swath:q})}function T(U){r(2,o={...U}),r(1,m=[U.swath||12])}let $=!1;const I=["Red","Blue","Green","Yellow","Orange","Purple","SkyBlue","LightGreen","HotPink"];Xe(()=>{const U=()=>{r(5,$=window.innerWidth<640)};return U(),window.addEventListener("resize",U),r(3,t=t.map(q=>q.type===a?{...q,size:u||60,bodyColor:f,swath:p}:{...q,bodyColor:Qc(I,b)})),()=>{window.removeEventListener("resize",U)}});function E(){fe.success(`Selected Vehicle: [${o.bodyColor} ${o.type}]`),c("vehicleSelected",{...o,size:o.size,swath:m[0]}),c("closeMenu")}function k(){c("closeMenu")}function _(U){r(2,o={...o,bodyColor:U})}const d=U=>T(U),y=U=>_(U),v=()=>{fe.info("About Swath Width",{description:"Swath width is the area covered by your vehicle in one pass. Proper swath setting ensures correct trailing visuals.",duration:7e3})},L=U=>g(U),D=U=>r(4,h=U),O=()=>r(4,h="vehicles"),A=()=>r(4,h="colors"),H=()=>r(4,h="swath");return l.$$set=U=>{"showMenu"in U&&r(0,s=U.showMenu),"currentVehicleType"in U&&r(13,a=U.currentVehicleType),"currentVehicleSize"in U&&r(14,u=U.currentVehicleSize),"currentVehicleColor"in U&&r(15,f=U.currentVehicleColor),"currentVehicleSwath"in U&&r(16,p=U.currentVehicleSwath)},l.$$.update=()=>{l.$$.dirty[0]&8200&&r(17,n=t.find(U=>U.type===a)||t[0]),l.$$.dirty[0]&196608&&r(2,o={...n,swath:p||n.swath}),l.$$.dirty[0]&6&&o.swath!==m[0]&&r(1,m=[o.swath]),l.$$.dirty[0]&131076&&r(6,i=o.type!==n.type||o.bodyColor!==n.bodyColor||o.size!==n.size||o.swath!==n.swath)},r(3,t=[{type:"FourWheelDriveTractor",bodyColor:"green",size:60,swath:4},{type:"TowBetweenSeeder",bodyColor:"red",size:60,swath:12},{type:"TowBehindSeeder",bodyColor:"red",size:60,swath:12},{type:"TowBehindSeederTracks",bodyColor:"red",size:60,swath:12},{type:"TowBehindBoomspray",bodyColor:"red",size:60,swath:36},{type:"SelfPropelledBoomspray",bodyColor:"red",size:60,swath:36},{type:"ThreePointBoomspray",bodyColor:"red",size:60,swath:36},{type:"FarmUte",bodyColor:"red",size:60,swath:4},{type:"FrontWheelChaserBin",bodyColor:"red",size:60,swath:12},{type:"FourWheelDriveChaserBin",bodyColor:"red",size:60,swath:12},{type:"HeaderDuals",bodyColor:"red",size:60,swath:12},{type:"HeaderSingles",bodyColor:"red",size:60,swath:12},{type:"HeaderTracks",bodyColor:"red",size:60,swath:12},{type:"SelfPropelledSwather",bodyColor:"red",size:60,swath:12},{type:"Spreader",bodyColor:"red",size:60,swath:12},{type:"Truck",bodyColor:"red",size:60,swath:4},{type:"CabOverTruck",bodyColor:"red",size:60,swath:4},{type:"CabOverRoadTrain",bodyColor:"red",size:60,swath:4},{type:"Baler",bodyColor:"red",size:60,swath:12},{type:"Mower",bodyColor:"red",size:60,swath:12},{type:"SelfPropelledMower",bodyColor:"red",size:60,swath:12},{type:"Telehandler",bodyColor:"red",size:60,swath:12},{type:"Loader",bodyColor:"red",size:60,swath:4},{type:"SimpleTractor",bodyColor:"red",size:60,swath:4},{type:"Pointer",bodyColor:"green",size:60,swath:4},{type:"CombineHarvester",bodyColor:"yellow",size:60,swath:12},{type:"Excavator",bodyColor:"orange",size:60,swath:4},{type:"Tractor",bodyColor:"green",size:60,swath:4},{type:"WheelLoader",bodyColor:"yellow",size:60,swath:4},{type:"WorkCar",bodyColor:"red",size:60,swath:4},{type:"Airplane",bodyColor:"blue",size:60,swath:50}]),[s,m,o,t,h,$,i,g,T,I,E,k,_,a,u,f,p,n,d,y,v,L,D,O,A,H]}class eu extends se{constructor(e){super(),ae(this,e,xc,Kc,ie,{showMenu:0,currentVehicleType:13,currentVehicleSize:14,currentVehicleColor:15,currentVehicleSwath:16},null,[-1,-1])}}function tu(l){let e,r;return e=new yi({props:{size:24}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function ru(l){let e,r;return e=new _i({props:{size:24}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function nu(l){let e;return{c(){e=_e("Loading...")},l(r){e=be(r,"Loading...")},m(r,t){R(r,e,t)},p:de,i:de,o:de,d(r){r&&w(e)}}}function lu(l){let e,r,t;var n=l[3];function o(i,c){return{props:{bodyColor:i[0].vehicle_marker.bodyColor,size:i[0].vehicle_marker.size,swath:i[0].vehicle_marker.swath}}}return n&&(e=Mt(n,o(l))),{c(){e&&W(e.$$.fragment),r=oe()},l(i){e&&J(e.$$.fragment,i),r=oe()},m(i,c){e&&G(e,i,c),R(i,r,c),t=!0},p(i,c){if(c&8&&n!==(n=i[3])){if(e){he();const s=e;S(s.$$.fragment,1,0,()=>{Y(s,1)}),me()}n?(e=Mt(n,o(i)),W(e.$$.fragment),C(e.$$.fragment,1),G(e,r.parentNode,r)):e=null}else if(n){const s={};c&1&&(s.bodyColor=i[0].vehicle_marker.bodyColor),c&1&&(s.size=i[0].vehicle_marker.size),c&1&&(s.swath=i[0].vehicle_marker.swath),e.$set(s)}},i(i){t||(e&&C(e.$$.fragment,i),t=!0)},o(i){e&&S(e.$$.fragment,i),t=!1},d(i){i&&w(r),e&&Y(e,i)}}}function ou(l){let e,r,t,n;return{c(){e=Ie("svg"),r=Ie("title"),t=_e("trail"),n=Ie("path"),this.h()},l(o){e=Ae(o,"svg",{fill:!0,width:!0,height:!0,viewBox:!0,version:!0,xmlns:!0});var i=B(e);r=Ae(i,"title",{});var c=B(r);t=be(c,"trail"),c.forEach(w),n=Ae(i,"path",{d:!0,class:!0}),B(n).forEach(w),i.forEach(w),this.h()},h(){P(n,"d","M30.165 30.887c-1.604 0.076-21.522-0.043-21.522-0.043-12.101-12.151 18.219-16.173-0.521-26.154l-1.311 1.383-1.746-4.582 5.635 0.439-1.128 1.267c23.438 6.83-3.151 19.631 20.594 27.69v0z"),P(n,"class","svelte-4bliug"),P(e,"fill","currentColor"),P(e,"width","36px"),P(e,"height","36px"),P(e,"viewBox","0 0 32 32"),P(e,"version","1.1"),P(e,"xmlns","http://www.w3.org/2000/svg")},m(o,i){R(o,e,i),M(e,r),M(r,t),M(e,n)},p:de,d(o){o&&w(e)}}}function iu(l){let e,r,t,n,o;return{c(){e=Ie("svg"),r=Ie("title"),t=_e("trail"),n=Ie("path"),this.h()},l(i){e=Ae(i,"svg",{class:!0,fill:!0,width:!0,height:!0,viewBox:!0,version:!0,xmlns:!0});var c=B(e);r=Ae(c,"title",{});var s=B(r);t=be(s,"trail"),s.forEach(w),n=Ae(c,"path",{d:!0,class:!0}),B(n).forEach(w),c.forEach(w),this.h()},h(){P(n,"d","M30.165 30.887c-1.604 0.076-21.522-0.043-21.522-0.043-12.101-12.151 18.219-16.173-0.521-26.154l-1.311 1.383-1.746-4.582 5.635 0.439-1.128 1.267c23.438 6.83-3.151 19.631 20.594 27.69v0z"),P(n,"class","svelte-4bliug"),P(e,"class",o=Gr(l[6]?"animate-trail":"")+" svelte-4bliug"),P(e,"fill","currentColor"),P(e,"width","36px"),P(e,"height","36px"),P(e,"viewBox","0 0 32 32"),P(e,"version","1.1"),P(e,"xmlns","http://www.w3.org/2000/svg")},m(i,c){R(i,e,c),M(e,r),M(r,t),M(e,n)},p(i,c){c&64&&o!==(o=Gr(i[6]?"animate-trail":"")+" svelte-4bliug")&&P(e,"class",o)},d(i){i&&w(e)}}}function cl(l){let e,r;return e=new eu({props:{showMenu:l[1].showVehicleMenu,currentVehicleType:l[0].vehicle_marker.type,currentVehicleSize:l[0].vehicle_marker.size,currentVehicleColor:l[0].vehicle_marker.bodyColor,currentVehicleSwath:l[0].vehicle_marker.swath}}),e.$on("closeMenu",l[15]),e.$on("vehicleSelected",l[16]),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,n){const o={};n&2&&(o.showMenu=t[1].showVehicleMenu),n&1&&(o.currentVehicleType=t[0].vehicle_marker.type),n&1&&(o.currentVehicleSize=t[0].vehicle_marker.size),n&1&&(o.currentVehicleColor=t[0].vehicle_marker.bodyColor),n&1&&(o.currentVehicleSwath=t[0].vehicle_marker.swath),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function su(l){let e,r,t,n,o,i,c,s,a,u,f,p,h,b,m,g,T,$,I,E,k,_,d,y,v,L,D,O,A,H,U,q,ne,z;const F=[ru,tu],j=[];function ee(le,De){return le[5]?0:1}b=ee(l),m=j[b]=F[b](l),$=new vn.location_drop({props:{width:"48",height:"48",fill:"currentColor"}}),k=new vn.locate_home({props:{width:"40",height:"40",fill:"currentColor"}});const x=[lu,nu],K=[];function te(le,De){return le[3]?0:1}v=te(l),L=K[v]=x[v](l);function ce(le,De){return le[6]?iu:ou}let pe=ce(l),Pe=pe(l),ve=l[2]&&cl(l);return{c(){e=N("div"),r=N("button"),t=Ie("svg"),n=Ie("path"),o=X(),i=N("div"),c=N("button"),s=Ie("svg"),a=Ie("path"),f=X(),p=N("div"),h=N("button"),m.c(),g=X(),T=N("button"),W($.$$.fragment),I=X(),E=N("button"),W(k.$$.fragment),_=X(),d=N("button"),y=N("div"),L.c(),D=X(),O=N("button"),Pe.c(),U=X(),ve&&ve.c(),this.h()},l(le){e=V(le,"DIV",{});var De=B(e);r=V(De,"BUTTON",{class:!0});var ue=B(r);t=Ae(ue,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var Ne=B(t);n=Ae(Ne,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0,class:!0}),B(n).forEach(w),Ne.forEach(w),ue.forEach(w),o=Z(De),i=V(De,"DIV",{class:!0});var Se=B(i);c=V(Se,"BUTTON",{class:!0});var je=B(c);s=Ae(je,"svg",{xmlns:!0,class:!0,fill:!0,viewBox:!0,stroke:!0});var Zt=B(s);a=Ae(Zt,"path",{"stroke-linecap":!0,"stroke-linejoin":!0,"stroke-width":!0,d:!0,class:!0}),B(a).forEach(w),Zt.forEach(w),je.forEach(w),f=Z(Se),p=V(Se,"DIV",{class:!0});var Je=B(p);h=V(Je,"BUTTON",{class:!0});var wt=B(h);m.l(wt),wt.forEach(w),g=Z(Je),T=V(Je,"BUTTON",{class:!0});var Lt=B(T);J($.$$.fragment,Lt),Lt.forEach(w),I=Z(Je),E=V(Je,"BUTTON",{class:!0});var Ut=B(E);J(k.$$.fragment,Ut),Ut.forEach(w),_=Z(Je),d=V(Je,"BUTTON",{class:!0});var Rt=B(d);y=V(Rt,"DIV",{class:!0});var lt=B(y);L.l(lt),lt.forEach(w),Rt.forEach(w),D=Z(Je),O=V(Je,"BUTTON",{class:!0});var ut=B(O);Pe.l(ut),ut.forEach(w),Je.forEach(w),Se.forEach(w),U=Z(De),ve&&ve.l(De),De.forEach(w),this.h()},h(){P(n,"stroke-linecap","round"),P(n,"stroke-linejoin","round"),P(n,"stroke-width","2"),P(n,"d","M10 19l-7-7m0 0l7-7m-7 7h18"),P(n,"class","svelte-4bliug"),P(t,"xmlns","http://www.w3.org/2000/svg"),P(t,"class","h-6 w-6"),P(t,"fill","none"),P(t,"viewBox","0 0 24 24"),P(t,"stroke","currentColor"),P(r,"class","top-button "+Tt+" btn btn-circle btn-lg absolute left-4 top-4 z-10 bg-white bg-opacity-50 hover:bg-opacity-100 svelte-4bliug"),P(a,"stroke-linecap","round"),P(a,"stroke-linejoin","round"),P(a,"stroke-width","2"),P(a,"d","M19 9l-7 7-7-7"),P(a,"class","svelte-4bliug"),P(s,"xmlns","http://www.w3.org/2000/svg"),P(s,"class",u="h-8 w-8 transition-transform duration-300 "+(l[4]?"rotate-180":"")),P(s,"fill","none"),P(s,"viewBox","0 0 24 24"),P(s,"stroke","currentColor"),P(c,"class","top-button "+Tt+" btn btn-circle btn-lg mb-3 bg-white hover:bg-opacity-90 svelte-4bliug"),P(h,"class","menu-button "+Tt+" btn btn-circle btn-lg bg-white hover:bg-opacity-90 svelte-4bliug"),P(T,"class","menu-button "+Tt+" btn btn-circle btn-lg bg-white text-sm hover:bg-opacity-90 svelte-4bliug"),P(E,"class","menu-button "+Tt+" btn btn-circle btn-lg bg-white hover:bg-opacity-90 svelte-4bliug"),P(y,"class","flex h-full w-full items-center justify-center"),P(d,"class","menu-button "+Tt+" btn btn-circle btn-lg bg-white hover:bg-opacity-90 svelte-4bliug"),P(O,"class",A="menu-button "+Tt+" btn btn-circle btn-lg bg-white hover:bg-opacity-90 "+(l[6]?"trailing-active":"")+" relative svelte-4bliug"),P(p,"class",H="flex origin-top flex-col space-y-3 transition-all duration-700 ease-in-out "+(l[4]?"scale-100 opacity-90":"h-50 scale-0 overflow-hidden opacity-0")),P(i,"class","fixed right-4 top-4 z-20 flex flex-col items-end")},m(le,De){R(le,e,De),M(e,r),M(r,t),M(t,n),M(e,o),M(e,i),M(i,c),M(c,s),M(s,a),M(i,f),M(i,p),M(p,h),j[b].m(h,null),M(p,g),M(p,T),G($,T,null),M(p,I),M(p,E),G(k,E,null),M(p,_),M(p,d),M(d,y),K[v].m(y,null),M(p,D),M(p,O),Pe.m(O,null),M(e,U),ve&&ve.m(e,null),q=!0,ne||(z=[Me(r,"click",l[9]),Me(c,"click",l[10]),Me(h,"click",l[13]),Me(T,"click",l[11]),Me(E,"click",l[12]),Me(d,"click",l[8]),Me(O,"click",l[7])],ne=!0)},p(le,[De]){(!q||De&16&&u!==(u="h-8 w-8 transition-transform duration-300 "+(le[4]?"rotate-180":"")))&&P(s,"class",u);let ue=b;b=ee(le),b!==ue&&(he(),S(j[ue],1,1,()=>{j[ue]=null}),me(),m=j[b],m||(m=j[b]=F[b](le),m.c()),C(m,1),m.m(h,null));let Ne=v;v=te(le),v===Ne?K[v].p(le,De):(he(),S(K[Ne],1,1,()=>{K[Ne]=null}),me(),L=K[v],L?L.p(le,De):(L=K[v]=x[v](le),L.c()),C(L,1),L.m(y,null)),pe===(pe=ce(le))&&Pe?Pe.p(le,De):(Pe.d(1),Pe=pe(le),Pe&&(Pe.c(),Pe.m(O,null))),(!q||De&64&&A!==(A="menu-button "+Tt+" btn btn-circle btn-lg bg-white hover:bg-opacity-90 "+(le[6]?"trailing-active":"")+" relative svelte-4bliug"))&&P(O,"class",A),(!q||De&16&&H!==(H="flex origin-top flex-col space-y-3 transition-all duration-700 ease-in-out "+(le[4]?"scale-100 opacity-90":"h-50 scale-0 overflow-hidden opacity-0")))&&P(p,"class",H),le[2]?ve?(ve.p(le,De),De&4&&C(ve,1)):(ve=cl(le),ve.c(),C(ve,1),ve.m(e,null)):ve&&(he(),S(ve,1,1,()=>{ve=null}),me())},i(le){q||(C(m),C($.$$.fragment,le),C(k.$$.fragment,le),C(L),C(ve),q=!0)},o(le){S(m),S($.$$.fragment,le),S(k.$$.fragment,le),S(L),S(ve),q=!1},d(le){le&&w(e),j[b].d(),Y($),Y(k),K[v].d(),Pe.d(),ve&&ve.d(),ne=!1,vt(z)}}}let Tt="skan";function au(l,e,r){let t,n,o,i;re(l,Yt,k=>r(5,t=k)),re(l,$t,k=>r(0,n=k)),re(l,kr,k=>r(18,k)),re(l,ft,k=>r(1,o=k)),re(l,ct,k=>r(6,i=k)),Xe(async()=>{console.log("Mounting ButtonSection"),setTimeout(()=>{r(4,b=!0)},200)});let{isSatelliteView:c=!0}=e,s=!1,a;const u=nn();function f(){sn.update(k=>!k),i?fe.info("Preparing to end trail recording..."):fe.info("Initiating trail recording...")}function p(){r(2,s=!s),console.log("Set vehicleMenuVisibility to",s),ft.update(k=>{const _={...k,showVehicleMenu:s};return console.log("Updated controlStore:",_),_})}function h(){u("backToDashboard")}let b=!1;function m(){r(4,b=!b)}function g(){const k=n.coordinates;k?Kr.set(k):fe.error("Unable to get your current location")}function T(){u("locateHome")}function $(){Bl(Yt,t=!t,t)}const I=()=>{ft.update(k=>({...k,showVehicleMenu:!1}))},E=k=>{$t.update(_=>({..._,vehicle_marker:k.detail})),ft.update(_=>({..._,showVehicleMenu:!1}))};return l.$$set=k=>{"isSatelliteView"in k&&r(14,c=k.isSatelliteView)},l.$$.update=()=>{l.$$.dirty&1&&n.vehicle_marker&&n.vehicle_marker.type&&r(3,a=It[n.vehicle_marker.type]||It.simpleTractor),l.$$.dirty&2&&r(2,s=o.showVehicleMenu)},[n,o,s,a,b,t,i,f,p,h,m,g,T,$,c,I,E]}class cu extends se{constructor(e){super(),ae(this,e,au,su,ie,{isSatelliteView:14})}}const uu=500,fu=5;function du(l,e,r){let t;re(l,Yt,d=>r(3,t=d));let{map:n}=e;const o=nn();let i=null,c=null,s=[],a=!0,u=!1;function f(d){if(!a)return;const y=d.target;y.style.cursor="pointer"}function p(d){if(!a)return;const y=d.target;y.style.cursor=""}function h(d){if(!a)return;d.stopPropagation();const y=d.target.closest(".mapboxgl-marker");if(y){const v=s.find(L=>L.marker.getElement()===y);if(v){const{marker:L,id:D}=v;o("markerClick",{marker:L,id:D})}else console.log("No matching marker found in confirmedMarkers array")}else console.log("No marker element found")}function b(d){if(!a)return;d.stopPropagation(),d.preventDefault(),clearTimeout(i);const y=d.target.closest(".mapboxgl-marker");if(y){const v=s.find(L=>L.marker.getElement()===y);if(v){const{marker:L,id:D}=v;o("markerClick",{marker:L,id:D})}}}function m(d){if(!a)return;const y=d.lngLat||d.target.getLngLat();y?o("markerPlacement",{lngLat:y}):console.error("Invalid event format. Missing lngLat property.")}function g(d){!a||d.originalEvent.target.closest(".mapboxgl-marker")||(clearTimeout(i),c={x:d.originalEvent.clientX||d.originalEvent.touches[0].clientX,y:d.originalEvent.clientY||d.originalEvent.touches[0].clientY},i=setTimeout(()=>{m(d),i=null},uu))}function T(d){if(a&&c){const y=d.originalEvent.touches?d.originalEvent.touches[0]:d.originalEvent,v=y.clientX-c.x,L=y.clientY-c.y;Math.sqrt(v*v+L*L)>fu&&(clearTimeout(i),i=null,c=null)}}function $(d){a&&(clearTimeout(i),i=null,c=null)}function I(d,y){const v=d.getElement();v.removeEventListener("mouseenter",f),v.removeEventListener("mouseleave",p),v.removeEventListener("click",h),v.removeEventListener("touchstart",b),v.removeAttribute("data-listeners-added"),v.addEventListener("mouseenter",f),v.addEventListener("mouseleave",p),v.addEventListener("click",h),v.addEventListener("touchstart",b),v.setAttribute("data-listeners-added","true");const L=s.findIndex(D=>D.id===y);L!==-1?s=s.map((D,O)=>O===L?{marker:d,id:y}:D):s=[...s,{marker:d,id:y}]}function E(d){const{marker:y,id:v}=d.detail;I(y,v)}function k(){!n||u||(n.on("mousedown",g),n.on("touchstart",g),n.on("drag",T),n.on("mouseup",$),document.addEventListener("handleUpdateMarkerListeners",E),r(2,u=!0))}function _(){!n||!u||(n.off("mousedown",g),n.off("touchstart",g),n.off("drag",T),n.off("mouseup",$),document.removeEventListener("handleUpdateMarkerListeners",E),r(2,u=!1))}return Xe(()=>{a&&!u&&k()}),gt(()=>{_()}),l.$$set=d=>{"map"in d&&r(0,n=d.map)},l.$$.update=()=>{l.$$.dirty&14&&t!==void 0&&(r(1,a=!t),a&&!u?k():!a&&u&&_())},[n,a,u,t]}class hu extends se{constructor(e){super(),ae(this,e,du,null,ie,{map:0})}}var mu=typeof global=="object"&&global&&global.Object===Object&&global;const gu=mu;var pu=typeof self=="object"&&self&&self.Object===Object&&self,_u=gu||pu||Function("return this")();const ao=_u;var bu=ao.Symbol;const Sr=bu;var co=Object.prototype,vu=co.hasOwnProperty,wu=co.toString,Kt=Sr?Sr.toStringTag:void 0;function ku(l){var e=vu.call(l,Kt),r=l[Kt];try{l[Kt]=void 0;var t=!0}catch{}var n=wu.call(l);return t&&(e?l[Kt]=r:delete l[Kt]),n}var yu=Object.prototype,Tu=yu.toString;function Cu(l){return Tu.call(l)}var Eu="[object Null]",Su="[object Undefined]",ul=Sr?Sr.toStringTag:void 0;function $u(l){return l==null?l===void 0?Su:Eu:ul&&ul in Object(l)?ku(l):Cu(l)}function Mu(l){return l!=null&&typeof l=="object"}var Iu="[object Symbol]";function Au(l){return typeof l=="symbol"||Mu(l)&&$u(l)==Iu}var Lu=/\s/;function Pu(l){for(var e=l.length;e--&&Lu.test(l.charAt(e)););return e}var Du=/^\s+/;function Ou(l){return l&&l.slice(0,Pu(l)+1).replace(Du,"")}function xr(l){var e=typeof l;return l!=null&&(e=="object"||e=="function")}var fl=0/0,Nu=/^[-+]0x[0-9a-f]+$/i,Vu=/^0b[01]+$/i,zu=/^0o[0-7]+$/i,Bu=parseInt;function dl(l){if(typeof l=="number")return l;if(Au(l))return fl;if(xr(l)){var e=typeof l.valueOf=="function"?l.valueOf():l;l=xr(e)?e+"":e}if(typeof l!="string")return l===0?l:+l;l=Ou(l);var r=Vu.test(l);return r||zu.test(l)?Bu(l.slice(2),r?2:8):Nu.test(l)?fl:+l}var Uu=function(){return ao.Date.now()};const Fr=Uu;var Ru="Expected a function",Fu=Math.max,Hu=Math.min;function ju(l,e,r){var t,n,o,i,c,s,a=0,u=!1,f=!1,p=!0;if(typeof l!="function")throw new TypeError(Ru);e=dl(e)||0,xr(r)&&(u=!!r.leading,f="maxWait"in r,o=f?Fu(dl(r.maxWait)||0,e):o,p="trailing"in r?!!r.trailing:p);function h(_){var d=t,y=n;return t=n=void 0,a=_,i=l.apply(y,d),i}function b(_){return a=_,c=setTimeout(T,e),u?h(_):i}function m(_){var d=_-s,y=_-a,v=e-d;return f?Hu(v,o-y):v}function g(_){var d=_-s,y=_-a;return s===void 0||d>=e||d<0||f&&y>=o}function T(){var _=Fr();if(g(_))return $(_);c=setTimeout(T,m(_))}function $(_){return c=void 0,p&&t?h(_):(t=n=void 0,i)}function I(){c!==void 0&&clearTimeout(c),a=0,t=s=n=c=void 0}function E(){return c===void 0?i:$(Fr())}function k(){var _=Fr(),d=g(_);if(t=arguments,n=this,s=_,d){if(c===void 0)return b(s);if(f)return clearTimeout(c),c=setTimeout(T,e),h(s)}return c===void 0&&(c=setTimeout(T,e)),i}return k.cancel=I,k.flush=E,k}function qu(l,e,r){let t,n,o,i;re(l,Qe,k=>r(7,t=k)),re(l,rr,k=>r(8,n=k)),re(l,Jl,k=>r(9,o=k)),re(l,on,k=>r(10,i=k));let c,s,a=!1,u,f,p,{map:h}=e;Xe(()=>{f=i.master_map_id,p=i.id,s=ju(g,500),u=Ve.channel("map_markers_changes").on("postgres_changes",{event:"*",schema:"public",table:"map_markers",filter:`master_map_id=eq.${f}`},async k=>{var O,A;if(k.new.update_user_id===p){console.log("Skipping synchronization, update made by current user");return}let _="Another user";const d=o.connected_profiles.find(H=>H.id===k.new.update_user_id);if(d)_=d.full_name;else{const{data:H}=await Ve.from("profiles").select("full_name").eq("id",k.new.update_user_id).single();H&&(_=H.full_name)}const y=k.eventType,v=((A=(O=k.new.marker_data)==null?void 0:O.properties)==null?void 0:A.icon)||"unknown",L=k.new.marker_data.geometry.coordinates,D=k.new.deleted===!0;m(_,y,v,D,L),a||s()}).subscribe(),g(),c=Qe.subscribe(k=>{a||s()}),kr.update(k=>({...k,synchronizeMarkers:g}))}),gt(()=>{console.log("Destroying MapStateSaver"),s.cancel(),c&&c(),u&&Ve.removeChannel(u),console.log("Removing all markers from the map"),Qe.update(k=>(k.forEach(({marker:_})=>{_.remove()}),[])),Qe.set([]),rr.set([]),nr.set([])});function b(k,_,d){let y="",v="";switch(k){case"add":y="Marker Added",v=`You added a new ${_} marker`,fe.info(y,{description:v});break;case"update":d?(y="Marker Deleted",v=`You removed a ${_} marker`,fe.warning(y,{description:v})):(y="Marker Updated",v=`You updated a marker to ${_}`,fe.info(y,{description:v}));break}}function m(k,_,d,y,v){let L="",D="";switch(_){case"INSERT":L="Marker Added",D=`${k} added a new ${d} marker`,fe.info(L,{description:D,action:{label:"Locate",onClick:()=>{h.flyTo({center:v,zoom:15,duration:1e3})}}});break;case"UPDATE":y?(L="Marker Deleted",D=`${k} removed a ${d} marker`,fe.warning(L,{description:D})):(L="Marker Updated",D=`${k} updated a marker to ${d}`,fe.info(L,{description:D,action:{label:"Locate",onClick:()=>{h.flyTo({center:v,zoom:15,duration:1e3})}}}));break}}async function g(k){if(a){console.log("Synchronization already in progress. Skipping.");return}if(a=!0,kr.update(_=>({..._,spinning:!0})),!p){console.error("User not authenticated"),fe.error("User not authenticated");return}try{const _=await I(),d=t;let{localMarkersToBeAdded:y,localMarkersToBeUpdated:v,localMarkersToBeDeleted:L,serverMarkersToBeAdded:D,serverMarkersToBeUpdated:O,serverMarkersToBeDeleted:A}=T(d,_);const H=[...y.map(U=>({action:"add",markerData:U})),...v.map(U=>({action:"update",markerData:U})),...L.map(U=>({action:"delete",markerData:U}))];nr.set(H),await $({serverMarkersToBeAdded:D,serverMarkersToBeUpdated:O,serverMarkersToBeDeleted:A}),E(),k&&fe.success(k)}catch(_){console.error("Error synchronizing markers:",_);let d="Synchronization Error",y=_.message||"Error synchronizing markers";_.message==="No master map assigned"&&(d="Map Assignment Error"),fe.error(d,{description:_.details||y,action:{label:"Reload",onClick:()=>{window.location.reload()}}})}a=!1,kr.update(_=>({..._,spinning:!1}))}function T(k,_){let d=[],y=[],v=[],L=[],D=[],O=[];for(const A of k){const H=_.find(U=>U.id===A.id);if(H)H.deleted?new Date(A.last_confirmed)>new Date(H.deleted_at)?(D.push(A),b("update",A.iconClass,!1)):v.push(A):new Date(H.last_confirmed)>new Date(A.last_confirmed)?y.push(H):new Date(A.last_confirmed)>new Date(H.last_confirmed)&&(D.push(A),b("update",A.iconClass,!1));else if(!n.find(q=>q.id===A.id)){let q=A.iconClass||"default";L.push({...A,iconClass:q}),b("add",A.iconClass,!1)}}for(const A of _){const H=k.find(q=>q.id===A.id),U=n.find(q=>q.id===A.id);!H&&!A.deleted&&!U&&d.push(A)}for(const A of n){const H=_.find(U=>U.id===A.id);H&&new Date(A.last_confirmed)>=new Date(H.last_confirmed)&&(O.push(H),b("update",H.iconClass,!0))}return{localMarkersToBeAdded:d,localMarkersToBeUpdated:y,localMarkersToBeDeleted:v,serverMarkersToBeAdded:L,serverMarkersToBeUpdated:D,serverMarkersToBeDeleted:O}}async function $({serverMarkersToBeAdded:k,serverMarkersToBeUpdated:_,serverMarkersToBeDeleted:d}){if(!f)throw new Error("No master map assigned");if(k.length>0){const y=k.map(L=>{const{marker:D,id:O,last_confirmed:A,iconClass:H}=L,q={type:"Feature",geometry:{type:"Point",coordinates:D.getLngLat().toArray()},properties:{icon:H,id:O}};return{master_map_id:f,id:O,marker_data:q,last_confirmed:A,update_user_id:p}}),{error:v}=await Ve.from("map_markers").insert(y);if(v)throw new Error("Failed to add markers to server")}if(_.length>0){const y=_.map(L=>{const{marker:D,id:O,last_confirmed:A,iconClass:H}=L,q={type:"Feature",geometry:{type:"Point",coordinates:D.getLngLat().toArray()},properties:{icon:H,id:O}};return{id:O,marker_data:q,last_confirmed:A,update_user_id:p}}),{error:v}=await Ve.from("map_markers").upsert(y,{onConflict:"id"});if(v)throw new Error("Failed to update markers on server")}if(d.length>0){const y=d.map(L=>({id:L.id,deleted:!0,deleted_at:new Date().toISOString()})),{error:v}=await Ve.from("map_markers").upsert(y,{onConflict:"id"});if(v)throw new Error("Failed to delete markers on server");rr.update(L=>L.filter(D=>!d.some(O=>O.id===D.id)))}}async function I(){if(!f)throw new Error("No master map assigned");const{data:k,error:_}=await Ve.from("map_markers").select("id, marker_data, last_confirmed, deleted, deleted_at").eq("master_map_id",f);if(_)throw new Error("Failed to retrieve latest markers from server");return k.map(d=>({...d,iconClass:d.marker_data.properties.icon}))}function E(){const k=t;if(k.length>0){const _=new po.LngLatBounds;k.forEach(({marker:d})=>{_.extend(d.getLngLat())}),Qr.set(_)}else Qr.set(null)}return l.$$set=k=>{"map"in k&&r(0,h=k.map)},[h]}class Wu extends se{constructor(e){super(),ae(this,e,qu,null,ie,{map:0})}}function hl(l){let e;return{c(){e=N("div"),this.h()},l(r){e=V(r,"DIV",{class:!0,style:!0}),B(e).forEach(w),this.h()},h(){P(e,"class","pulse-circle animate-pulse"),Oe(e,"width",l[1]),Oe(e,"height",l[1]),Oe(e,"border-radius","50%"),Oe(e,"background-color",l[0]),Oe(e,"box-shadow","0 0 0 10px "+l[0]),Oe(e,"position","absolute"),Oe(e,"top","50%"),Oe(e,"left","50%"),Oe(e,"transform","translate(-50%, -50%)"),Oe(e,"z-index","0")},m(r,t){R(r,e,t)},p(r,t){t&2&&Oe(e,"width",r[1]),t&2&&Oe(e,"height",r[1]),t&1&&Oe(e,"background-color",r[0]),t&1&&Oe(e,"box-shadow","0 0 0 10px "+r[0])},d(r){r&&w(e)}}}function Gu(l){let e,r,t,n;var o=l[6];function i(s,a){return{props:{bodyColor:s[3],size:s[2],swath:s[4]}}}o&&(r=Mt(o,i(l)));let c=l[5]&&hl(l);return{c(){e=N("div"),r&&W(r.$$.fragment),t=X(),c&&c.c(),this.h()},l(s){e=V(s,"DIV",{class:!0,style:!0});var a=B(e);r&&J(r.$$.fragment,a),t=Z(a),c&&c.l(a),a.forEach(w),this.h()},h(){P(e,"class","user-marker"),Oe(e,"position","relative"),Oe(e,"display","inline-block")},m(s,a){R(s,e,a),r&&G(r,e,null),M(e,t),c&&c.m(e,null),n=!0},p(s,[a]){if(a&64&&o!==(o=s[6])){if(r){he();const u=r;S(u.$$.fragment,1,0,()=>{Y(u,1)}),me()}o?(r=Mt(o,i(s)),W(r.$$.fragment),C(r.$$.fragment,1),G(r,e,t)):r=null}else if(o){const u={};a&8&&(u.bodyColor=s[3]),a&4&&(u.size=s[2]),a&16&&(u.swath=s[4]),r.$set(u)}s[5]?c?c.p(s,a):(c=hl(s),c.c(),c.m(e,null)):c&&(c.d(1),c=null)},i(s){n||(r&&C(r.$$.fragment,s),n=!0)},o(s){r&&S(r.$$.fragment,s),n=!1},d(s){s&&w(e),r&&Y(r),c&&c.d()}}}function Yu(l,e,r){let t,{pulseColor:n="rgba(172, 172, 230, 0.8)"}=e,{pulseSize:o="40px"}=e,{vehicleSize:i="60px"}=e,{userVehicle:c="tractor"}=e,{vehicleColor:s="yellow"}=e,{vehicleSwath:a=12}=e,{showPulse:u=!0}=e;return l.$$set=f=>{"pulseColor"in f&&r(0,n=f.pulseColor),"pulseSize"in f&&r(1,o=f.pulseSize),"vehicleSize"in f&&r(2,i=f.vehicleSize),"userVehicle"in f&&r(7,c=f.userVehicle),"vehicleColor"in f&&r(3,s=f.vehicleColor),"vehicleSwath"in f&&r(4,a=f.vehicleSwath),"showPulse"in f&&r(5,u=f.showPulse)},l.$$.update=()=>{l.$$.dirty&128&&r(6,t=It[c]||It.tractor)},[n,o,i,s,a,u,t,c]}class Xu extends se{constructor(e){super(),ae(this,e,Yu,Gu,ie,{pulseColor:0,pulseSize:1,vehicleSize:2,userVehicle:7,vehicleColor:3,vehicleSwath:4,showPulse:5})}}function Zu(l){let e,r;return e=new si({props:{size:20}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function Ju(l){let e,r;return e=new Kl({props:{size:20,color:"black"}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function ml(l){let e,r,t,n,o,i="km/h";return{c(){e=N("div"),r=N("div"),t=_e(l[0]),n=X(),o=N("div"),o.textContent=i,this.h()},l(c){e=V(c,"DIV",{class:!0,style:!0});var s=B(e);r=V(s,"DIV",{class:!0});var a=B(r);t=be(a,l[0]),a.forEach(w),n=Z(s),o=V(s,"DIV",{class:!0,"data-svelte-h":!0}),$e(o)!=="svelte-11stotl"&&(o.textContent=i),s.forEach(w),this.h()},h(){P(r,"class","text-2xl font-bold"),P(o,"class","text-xs opacity-80"),P(e,"class","speed-fade-in fixed bottom-4 left-1/2 z-50 flex -translate-x-1/2 flex-col items-center rounded-lg bg-black/70 px-5 py-2.5 text-white backdrop-blur svelte-1p8pmuw"),Oe(e,"min-width","min-content")},m(c,s){R(c,e,s),M(e,r),M(r,t),M(e,n),M(e,o)},p(c,s){s&1&&Fe(t,c[0])},d(c){c&&w(e)}}}function Ku(l){let e,r,t,n,o,i,c,s,a;const u=[Ju,Zu],f=[];function p(b,m){return b[1]?0:1}r=p(l),t=f[r]=u[r](l);let h=l[1]&&ml(l);return{c(){e=N("button"),t.c(),o=X(),h&&h.c(),i=oe(),this.h()},l(b){e=V(b,"BUTTON",{class:!0,style:!0,"aria-label":!0});var m=B(e);t.l(m),m.forEach(w),o=Z(b),h&&h.l(b),i=oe(),this.h()},h(){P(e,"class","btn btn-circle fixed bottom-20 left-6 z-50 flex h-10 w-10 items-center justify-center border-none bg-black/70 text-white backdrop-blur transition-all hover:scale-110 hover:bg-black/90"),Oe(e,"background",l[1]?"rgba(255, 255, 255, 0.9)":""),P(e,"aria-label",n=l[1]?"Hide speed":"Show speed"),St(e,"text-black",l[1])},m(b,m){R(b,e,m),f[r].m(e,null),R(b,o,m),h&&h.m(b,m),R(b,i,m),c=!0,s||(a=Me(e,"click",l[2]),s=!0)},p(b,[m]){let g=r;r=p(b),r!==g&&(he(),S(f[g],1,1,()=>{f[g]=null}),me(),t=f[r],t||(t=f[r]=u[r](b),t.c()),C(t,1),t.m(e,null)),(!c||m&2)&&Oe(e,"background",b[1]?"rgba(255, 255, 255, 0.9)":""),(!c||m&2&&n!==(n=b[1]?"Hide speed":"Show speed"))&&P(e,"aria-label",n),(!c||m&2)&&St(e,"text-black",b[1]),b[1]?h?h.p(b,m):(h=ml(b),h.c(),h.m(i.parentNode,i)):h&&(h.d(1),h=null)},i(b){c||(C(t),c=!0)},o(b){S(t),c=!1},d(b){b&&(w(e),w(o),w(i)),f[r].d(),h&&h.d(b),s=!1,a()}}}const Qu=30;function gl(l,e,r,t){const n=l.getLngLat(),o=l.getRotation(),i=e-n.lng,c=r-n.lat;let s=t-o;s>180?s-=360:s<-180&&(s+=360);const a=1e3,u=performance.now();function f(p){const h=p-u,b=Math.min(h/a,1),m=b<.5?2*b*b:-1+(4-2*b)*b,g=n.lng+i*m,T=n.lat+c*m,$=o+s*m;l.setLngLat([g,T]).setRotation($),h<a&&requestAnimationFrame(f)}requestAnimationFrame(f)}function xu(l,e,r){let t,n,o;re(l,ct,v=>r(16,t=v)),re(l,$t,v=>r(17,n=v)),re(l,Po,v=>r(18,o=v));let{map:i}=e,{disableAutoZoom:c=!1}=e,s,a,u=0,f=[],p=0,h=!1,b,m,g=null,T=null,$=null;function I(){r(1,h=!h)}Xe(()=>{console.log("Mounting VehicleTracker");const v=o.data.session;v&&v.user.id,s=new Ke.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0,showAccuracyCircle:!0,showUserLocation:!1,className:"custom-geolocate-control",fitBoundsOptions:{maxZoom:16}}),i.addControl(s,"bottom-right"),i.on("load",()=>{c||s.trigger()}),s.on("geolocate",L=>{console.log("Received geolocate event:",L);const{coords:D}=L;d(D)}),b=$t.subscribe(L=>{L.coordinates,k(L.vehicle_marker)}),m=yr.subscribe(E)}),gt(()=>{console.log("Unmounting VehicleTracker"),a&&a.remove(),b&&b(),m&&m()});function E(v){v.forEach(L=>{const{coordinates:D,heading:O,vehicle_marker:A,vehicle_id:H,update_types:U,is_trailing:q,last_update:ne,full_name:z}=L,[F,j]=D.slice(1,-1).split(",").map(parseFloat),ee=f.findIndex(x=>x.getElement().getAttribute("data-vehicle-id")===H);if(ee!==-1){const x=f[ee];if(U.includes("vehicle_marker_changed")){x.remove();const K=new Ke.Marker({element:_(A,!1,H),pitchAlignment:"map",rotationAlignment:"map"});K.setLngLat([F,j]).setRotation(O).addTo(i),f[ee]=K}(U.includes("position_changed")||U.includes("heading_changed"))&&gl(x,F,j,O)}else{const x=new Ke.Marker({element:_(A,!1,H),pitchAlignment:"map",rotationAlignment:"map"});x.setLngLat([F,j]).setRotation(O).addTo(i),f.push(x)}io.update(x=>{const K=x.findIndex(te=>te.vehicle_id===H);if(K!==-1){const te=x[K];U.includes("trailing_status_changed")&&!U.includes("new_vehicle")&&fe.info("Trailing Status Changed",{description:`${z}'s ${A.type} has ${q?"started":"stopped"} trailing`,action:{label:"Locate",onClick:()=>{i.flyTo({center:[F,j],zoom:15,duration:1e3})}}}),x[K]={...te,...L}}else x.push(L);return x})})}function k(v){if(!(a&&$&&v.type===$.type&&v.bodyColor===$.bodyColor&&v.size===$.size&&v.swath===$.swath)&&(a&&a.remove(),a=new Ke.Marker({element:_(v,!0),pitchAlignment:"map",rotationAlignment:"map"}),n.coordinates)){const{latitude:L,longitude:D}=n.coordinates;a.setLngLat([D,L]).addTo(i),$={...v}}}function _(v,L=!1,D=null){const O=document.createElement("div");return O.setAttribute("data-vehicle-id",D),new Xu({target:O,props:{pulseColor:"rgba(172, 172, 230, 0.8)",pulseSize:"40px",vehicleSize:v.size,userVehicle:v.type,vehicleColor:v.bodyColor,vehicleSwath:v.swath,showPulse:L}}),O}function d(v){const{latitude:L,longitude:D,heading:O,speed:A}=v;r(0,p=A?Math.round(A*3.6):0);const H=Date.now(),U={coordinates:{latitude:L,longitude:D},last_update:H,vehicle_marker:n.vehicle_marker},q=O!==null?Math.round(O):O;y(H,U,q)}function y(v,L,D){if(v-u>=Qu){const{coordinates:O}=L,{bodyColor:A,swath:H}=L.vehicle_marker,{latitude:U,longitude:q}=O;if(t){const ne={coordinates:{latitude:U,longitude:q},timestamp:v,color:A,swath:H};console.log("Saving location data:",ne),hc.update(z=>[...z,ne]),Er.set({coordinates:{latitude:U,longitude:q},timestamp:v})}if(!g||g.latitude!==U||g.longitude!==q||T!==D){let ne="";if(!g)ne+="Initial coordinates. ";else{if(g.latitude!==U){const z=U-g.latitude;ne+=`Latitude changed by ${z.toFixed(6)}. `}if(g.longitude!==q){const z=q-g.longitude;ne+=`Longitude changed by ${z.toFixed(6)}. `}}if(T!==D){const z=D-T;ne+=`Heading changed by ${z.toFixed(2)}°.`}console.log("Changes detected:",ne),$t.update(z=>({...z,coordinates:L.coordinates,last_update:L.last_update,vehicle_marker:L.vehicle_marker,heading:D})),a&&a.getLngLat()&&gl(a,q,U,D),g={latitude:U,longitude:q},T=D}u=v}}return l.$$set=v=>{"map"in v&&r(3,i=v.map),"disableAutoZoom"in v&&r(4,c=v.disableAutoZoom)},[p,h,I,i,c]}class ef extends se{constructor(e){super(),ae(this,e,xu,Ku,ie,{map:3,disableAutoZoom:4})}}const tf=1e4;function Hr(l,e){return l.map(t=>{const n=e.find(i=>i.vehicle_id===t.vehicle_id),o={vehicle_id:t.vehicle_id,coordinates:t.coordinates,heading:t.heading,vehicle_marker:t.vehicle_marker,is_trailing:t.is_trailing,last_update:t.last_update,full_name:t.full_name||(n==null?void 0:n.full_name),update_types:[]};if(!n)o.update_types.push("new_vehicle");else{const i=JSON.stringify(t.vehicle_marker)!==JSON.stringify(n.vehicle_marker),c=t.coordinates!==n.coordinates,s=t.heading!==n.heading,a=t.is_trailing!==n.is_trailing,u=t.last_update!==n.last_update;i&&o.update_types.push("vehicle_marker_changed"),c&&o.update_types.push("position_changed"),s&&o.update_types.push("heading_changed"),a&&o.update_types.push("trailing_status_changed"),u&&o.update_types.push("last_update_changed")}return o}).filter(t=>t.update_types.length>0)}function rf(l,e,r){let t,n,o,i;re(l,io,m=>r(4,t=m)),re(l,vr,m=>r(5,n=m)),re(l,on,m=>r(6,o=m)),re(l,ct,m=>r(7,i=m));let c=null,s,a=0,u=null;async function f(m){const{data:g,error:T}=await Ve.from("vehicle_state").select("*").eq("vehicle_id",m).single();return T?(console.error("Error fetching user vehicle data:",T),null):g}async function p(m,g){const{data:T,error:$}=await Ve.from("vehicle_state").select(`
          *,
          profiles:vehicle_id (full_name)
        `).eq("master_map_id",m);return console.log("Vehicles:",T),$?(console.error("Error retrieving initial vehicle data:",$),[]):T.filter(I=>I.vehicle_id!==g).map(I=>({...I,full_name:I.profiles.full_name}))}async function h(m){const g=o.id,T=o.master_map_id,{coordinates:$,last_update:I,heading:E,vehicle_marker:k}=m;if(!$){console.warn("Coordinates not available. Skipping vehicle state update.");return}const _={vehicle_id:g,master_map_id:T,coordinates:`(${$.longitude},${$.latitude})`,last_update:new Date(I).toISOString(),is_trailing:i,vehicle_marker:k,heading:E!==null?E:null};try{await c.send({type:"broadcast",event:"vehicle_update",payload:_})}catch(d){console.error("Error broadcasting vehicle state:",d)}}async function b(m,g=!1){const T=o.id,$=o.master_map_id,{coordinates:I,last_update:E,heading:k,vehicle_marker:_}=m;if(!I){console.warn("Coordinates not available. Skipping database update.");return}const d=u&&(JSON.stringify(m.vehicle_marker)!==JSON.stringify(u.vehicle_marker)||m.is_trailing!==u.is_trailing),y=Date.now();if(!(g||d||a===0||y-a>=tf))return;const L={vehicle_id:T,master_map_id:$,coordinates:`(${I.longitude},${I.latitude})`,last_update:new Date(E).toISOString(),is_trailing:i,vehicle_marker:_,heading:k!==null?k:null},{data:D,error:O}=await Ve.from("vehicle_state").upsert(L).single();O?console.error("Error updating vehicle state in database:",O):(console.log("Database updated successfully"),a=y),u={...m}}return Xe(async()=>{console.log("Initializing VehicleStateSynchronizer");const m=o.id,g=o.master_map_id,T=await f(m);if(T){const[E,k]=T.coordinates.slice(1,-1).split(",").map(parseFloat);$t.update(_=>({..._,...T,coordinates:{latitude:k,longitude:E}}))}const $=await p(g,m);console.log("Initial vehicle data:",$),vr.set($);const I=Hr(n,t);yr.set(I),c=Ve.channel(`vehicle_updates_${g}`).on("broadcast",{event:"vehicle_update"},E=>{if(E.payload.vehicle_id!==m){vr.update(_=>{const d=_.findIndex(y=>y.vehicle_id===E.payload.vehicle_id);return d!==-1?_[d]={..._[d],...E.payload,full_name:_[d].full_name}:(console.log("pushing new vehicle",E.payload),_.push(E.payload)),_});const k=Hr(n,t);yr.set(k)}}).on("postgres_changes",{event:"*",schema:"public",table:"vehicle_state",filter:`master_map_id=eq.${g}`},E=>{if(E.new.vehicle_id!==m){vr.update(_=>{const d=_.findIndex(y=>y.vehicle_id===E.new.vehicle_id);return d!==-1?_[d]={..._[d],...E.new,full_name:_[d].full_name}:(console.log("pushing new vehicle from DB change",E.new),_.push(E.new)),_});const k=Hr(n,t);yr.set(k)}}).subscribe(),s=$t.subscribe(async E=>{console.log("Broadcasting vehicle state:",E),await h(E),await b(E)}),lc.set(!0)}),gt(()=>{c&&Ve.removeChannel(c),s&&s()}),[]}class nf extends se{constructor(e){super(),ae(this,e,rf,null,ie,{})}}function en(l){if(!l)throw new Error("coord is required");if(!Array.isArray(l)){if(l.type==="Feature"&&l.geometry!==null&&l.geometry.type==="Point")return[...l.geometry.coordinates];if(l.type==="Point")return[...l.coordinates]}if(Array.isArray(l)&&l.length>=2&&!Array.isArray(l[0])&&!Array.isArray(l[1]))return[...l];throw new Error("coord must be GeoJSON Point or an Array of numbers")}function lf(l){return l.type==="Feature"?l.geometry:l}function of(l,e,r={}){var t=en(l),n=en(e),o=pr(n[1]-t[1]),i=pr(n[0]-t[0]),c=pr(t[1]),s=pr(n[1]),a=Math.pow(Math.sin(o/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(c)*Math.cos(s);return Do(2*Math.atan2(Math.sqrt(a),Math.sqrt(1-a)),r.units)}function sf(l,e={}){if(l.bbox!=null&&e.recompute!==!0)return l.bbox;const r=[1/0,1/0,-1/0,-1/0];return wr(l,t=>{r[0]>t[0]&&(r[0]=t[0]),r[1]>t[1]&&(r[1]=t[1]),r[2]<t[0]&&(r[2]=t[0]),r[3]<t[1]&&(r[3]=t[1])}),r}const bt=11102230246251565e-32,Ge=134217729,af=(3+8*bt)*bt;function jr(l,e,r,t,n){let o,i,c,s,a=e[0],u=t[0],f=0,p=0;u>a==u>-a?(o=a,a=e[++f]):(o=u,u=t[++p]);let h=0;if(f<l&&p<r)for(u>a==u>-a?(i=a+o,c=o-(i-a),a=e[++f]):(i=u+o,c=o-(i-u),u=t[++p]),o=i,c!==0&&(n[h++]=c);f<l&&p<r;)u>a==u>-a?(i=o+a,s=i-o,c=o-(i-s)+(a-s),a=e[++f]):(i=o+u,s=i-o,c=o-(i-s)+(u-s),u=t[++p]),o=i,c!==0&&(n[h++]=c);for(;f<l;)i=o+a,s=i-o,c=o-(i-s)+(a-s),a=e[++f],o=i,c!==0&&(n[h++]=c);for(;p<r;)i=o+u,s=i-o,c=o-(i-s)+(u-s),u=t[++p],o=i,c!==0&&(n[h++]=c);return(o!==0||h===0)&&(n[h++]=o),h}function cf(l,e){let r=e[0];for(let t=1;t<l;t++)r+=e[t];return r}function ar(l){return new Float64Array(l)}const uf=(3+16*bt)*bt,ff=(2+12*bt)*bt,df=(9+64*bt)*bt*bt,jt=ar(4),pl=ar(8),_l=ar(12),bl=ar(16),Ze=ar(4);function hf(l,e,r,t,n,o,i){let c,s,a,u,f,p,h,b,m,g,T,$,I,E,k,_,d,y;const v=l-n,L=r-n,D=e-o,O=t-o;E=v*O,p=Ge*v,h=p-(p-v),b=v-h,p=Ge*O,m=p-(p-O),g=O-m,k=b*g-(E-h*m-b*m-h*g),_=D*L,p=Ge*D,h=p-(p-D),b=D-h,p=Ge*L,m=p-(p-L),g=L-m,d=b*g-(_-h*m-b*m-h*g),T=k-d,f=k-T,jt[0]=k-(T+f)+(f-d),$=E+T,f=$-E,I=E-($-f)+(T-f),T=I-_,f=I-T,jt[1]=I-(T+f)+(f-_),y=$+T,f=y-$,jt[2]=$-(y-f)+(T-f),jt[3]=y;let A=cf(4,jt),H=ff*i;if(A>=H||-A>=H||(f=l-v,c=l-(v+f)+(f-n),f=r-L,a=r-(L+f)+(f-n),f=e-D,s=e-(D+f)+(f-o),f=t-O,u=t-(O+f)+(f-o),c===0&&s===0&&a===0&&u===0)||(H=df*i+af*Math.abs(A),A+=v*u+O*c-(D*a+L*s),A>=H||-A>=H))return A;E=c*O,p=Ge*c,h=p-(p-c),b=c-h,p=Ge*O,m=p-(p-O),g=O-m,k=b*g-(E-h*m-b*m-h*g),_=s*L,p=Ge*s,h=p-(p-s),b=s-h,p=Ge*L,m=p-(p-L),g=L-m,d=b*g-(_-h*m-b*m-h*g),T=k-d,f=k-T,Ze[0]=k-(T+f)+(f-d),$=E+T,f=$-E,I=E-($-f)+(T-f),T=I-_,f=I-T,Ze[1]=I-(T+f)+(f-_),y=$+T,f=y-$,Ze[2]=$-(y-f)+(T-f),Ze[3]=y;const U=jr(4,jt,4,Ze,pl);E=v*u,p=Ge*v,h=p-(p-v),b=v-h,p=Ge*u,m=p-(p-u),g=u-m,k=b*g-(E-h*m-b*m-h*g),_=D*a,p=Ge*D,h=p-(p-D),b=D-h,p=Ge*a,m=p-(p-a),g=a-m,d=b*g-(_-h*m-b*m-h*g),T=k-d,f=k-T,Ze[0]=k-(T+f)+(f-d),$=E+T,f=$-E,I=E-($-f)+(T-f),T=I-_,f=I-T,Ze[1]=I-(T+f)+(f-_),y=$+T,f=y-$,Ze[2]=$-(y-f)+(T-f),Ze[3]=y;const q=jr(U,pl,4,Ze,_l);E=c*u,p=Ge*c,h=p-(p-c),b=c-h,p=Ge*u,m=p-(p-u),g=u-m,k=b*g-(E-h*m-b*m-h*g),_=s*a,p=Ge*s,h=p-(p-s),b=s-h,p=Ge*a,m=p-(p-a),g=a-m,d=b*g-(_-h*m-b*m-h*g),T=k-d,f=k-T,Ze[0]=k-(T+f)+(f-d),$=E+T,f=$-E,I=E-($-f)+(T-f),T=I-_,f=I-T,Ze[1]=I-(T+f)+(f-_),y=$+T,f=y-$,Ze[2]=$-(y-f)+(T-f),Ze[3]=y;const ne=jr(q,_l,4,Ze,bl);return bl[ne-1]}function mf(l,e,r,t,n,o){const i=(e-o)*(r-n),c=(l-n)*(t-o),s=i-c,a=Math.abs(i+c);return Math.abs(s)>=uf*a?s:-hf(l,e,r,t,n,o,a)}function gf(l,e){var r,t,n=0,o,i,c,s,a,u,f,p=l[0],h=l[1],b=e.length;for(r=0;r<b;r++){t=0;var m=e[r],g=m.length-1;if(u=m[0],u[0]!==m[g][0]&&u[1]!==m[g][1])throw new Error("First and last coordinates in a ring must be the same");for(i=u[0]-p,c=u[1]-h,t;t<g;t++){if(f=m[t+1],s=f[0]-p,a=f[1]-h,c===0&&a===0){if(s<=0&&i>=0||i<=0&&s>=0)return 0}else if(a>=0&&c<=0||a<=0&&c>=0){if(o=mf(i,s,c,a,0,0),o===0)return 0;(o>0&&a>0&&c<=0||o<0&&a<=0&&c>0)&&n++}u=f,c=a,i=s}}return n%2!==0}function tn(l,e,r={}){if(!l)throw new Error("point is required");if(!e)throw new Error("polygon is required");const t=en(l),n=lf(e),o=n.type,i=e.bbox;let c=n.coordinates;if(i&&pf(t,i)===!1)return!1;o==="Polygon"&&(c=[c]);let s=!1;for(var a=0;a<c.length;++a){const u=gf(t,c[a]);if(u===0)return!r.ignoreBoundary;u&&(s=!0)}return s}function pf(l,e){return e[0]<=l[0]&&e[1]<=l[1]&&e[2]>=l[0]&&e[3]>=l[1]}function rn(l,e={}){const r=sf(l),t=(r[0]+r[2])/2,n=(r[1]+r[3])/2;return tr([t,n],e.properties,e)}function _f(l){if(!l)throw new Error("geojson is required");switch(l.type){case"Feature":return uo(l);case"FeatureCollection":return bf(l);case"Point":case"LineString":case"Polygon":case"MultiPoint":case"MultiLineString":case"MultiPolygon":case"GeometryCollection":return cn(l);default:throw new Error("unknown GeoJSON type")}}function uo(l){const e={type:"Feature"};return Object.keys(l).forEach(r=>{switch(r){case"type":case"properties":case"geometry":return;default:e[r]=l[r]}}),e.properties=fo(l.properties),l.geometry==null?e.geometry=null:e.geometry=cn(l.geometry),e}function fo(l){const e={};return l&&Object.keys(l).forEach(r=>{const t=l[r];typeof t=="object"?t===null?e[r]=null:Array.isArray(t)?e[r]=t.map(n=>n):e[r]=fo(t):e[r]=t}),e}function bf(l){const e={type:"FeatureCollection"};return Object.keys(l).forEach(r=>{switch(r){case"type":case"features":return;default:e[r]=l[r]}}),e.features=l.features.map(r=>uo(r)),e}function cn(l){const e={type:l.type};return l.bbox&&(e.bbox=l.bbox),l.type==="GeometryCollection"?(e.geometries=l.geometries.map(r=>cn(r)),e):(e.coordinates=ho(l.coordinates),e)}function ho(l){const e=l;return typeof e[0]!="object"?e.slice():e.map(r=>ho(r))}function vf(l){const e=[];return l.type==="FeatureCollection"?Ql(l,function(r){wr(r,function(t){e.push(tr(t,r.properties))})}):l.type==="Feature"?wr(l,function(r){e.push(tr(r,l.properties))}):wr(l,function(r){e.push(tr(r))}),Cr(e)}var wf=Object.defineProperty,kf=Object.defineProperties,yf=Object.getOwnPropertyDescriptors,vl=Object.getOwnPropertySymbols,Tf=Object.prototype.hasOwnProperty,Cf=Object.prototype.propertyIsEnumerable,wl=(l,e,r)=>e in l?wf(l,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):l[e]=r,kl=(l,e)=>{for(var r in e||(e={}))Tf.call(e,r)&&wl(l,r,e[r]);if(vl)for(var r of vl(e))Cf.call(e,r)&&wl(l,r,e[r]);return l},yl=(l,e)=>kf(l,yf(e));function Ef(l,e,r={}){if(!l)throw new Error("targetPoint is required");if(!e)throw new Error("points is required");let t=1/0,n=0;Ql(e,(i,c)=>{const s=of(l,i,r);s<t&&(n=c,t=s)});const o=_f(e.features[n]);return yl(kl({},o),{properties:yl(kl({},o.properties),{featureIndex:n,distanceToPoint:t})})}function Tl(l){const e=Sf(l),r=rn(e);let t=!1,n=0;for(;!t&&n<e.features.length;){const o=e.features[n].geometry;let i,c,s,a,u,f,p=!1;if(o.type==="Point")r.geometry.coordinates[0]===o.coordinates[0]&&r.geometry.coordinates[1]===o.coordinates[1]&&(t=!0);else if(o.type==="MultiPoint"){let h=!1,b=0;for(;!h&&b<o.coordinates.length;)r.geometry.coordinates[0]===o.coordinates[b][0]&&r.geometry.coordinates[1]===o.coordinates[b][1]&&(t=!0,h=!0),b++}else if(o.type==="LineString"){let h=0;for(;!p&&h<o.coordinates.length-1;)i=r.geometry.coordinates[0],c=r.geometry.coordinates[1],s=o.coordinates[h][0],a=o.coordinates[h][1],u=o.coordinates[h+1][0],f=o.coordinates[h+1][1],Cl(i,c,s,a,u,f)&&(p=!0,t=!0),h++}else if(o.type==="MultiLineString"){let h=0;for(;h<o.coordinates.length;){p=!1;let b=0;const m=o.coordinates[h];for(;!p&&b<m.length-1;)i=r.geometry.coordinates[0],c=r.geometry.coordinates[1],s=m[b][0],a=m[b][1],u=m[b+1][0],f=m[b+1][1],Cl(i,c,s,a,u,f)&&(p=!0,t=!0),b++;h++}}else(o.type==="Polygon"||o.type==="MultiPolygon")&&tn(r,o)&&(t=!0);n++}if(t)return r;{const o=Cr([]);for(let i=0;i<e.features.length;i++)o.features=o.features.concat(vf(e.features[i]).features);return tr(Ef(r,o).geometry.coordinates)}}function Sf(l){return l.type!=="FeatureCollection"?l.type!=="Feature"?Cr([Oo(l)]):Cr([l]):l}function Cl(l,e,r,t,n,o){const i=Math.sqrt((n-r)*(n-r)+(o-t)*(o-t)),c=Math.sqrt((l-r)*(l-r)+(e-t)*(e-t)),s=Math.sqrt((n-l)*(n-l)+(o-e)*(o-e));return i===c+s}function $f(l,e,r){let t;re(l,Jr,s=>r(1,t=s));let{map:n}=e;function o(s){if(console.log("Calculating bounding box for",s.length,"fields"),s.length===0)return console.warn("No fields to calculate bounding box"),null;const a=new Ke.LngLatBounds;return s.forEach((u,f)=>{(u.boundary.type==="Polygon"?u.boundary.coordinates[0]:u.boundary.coordinates.flat(1)).forEach(([h,b],m)=>{if(isNaN(h)||isNaN(b)){console.warn(`Invalid coordinate at field ${f}, coordinate ${m}: [${h}, ${b}]`);return}a.extend(new Ke.LngLat(h,b))})}),a.isEmpty()?(console.warn("Unable to calculate valid bounding box"),null):(console.log("Calculated bounding box:",a.toArray()),a)}function i(){if(n.getLayer("fields-labels")){const s=n.getZoom();n.removeLayer("fields-labels"),n.addLayer({id:"fields-labels",type:"symbol",source:"label-points",layout:{"text-field":["get","name"],"text-anchor":"center","symbol-sort-key":-1,"text-font":["DIN Pro Bold","Arial Unicode MS Bold"],"text-size":["interpolate",["linear"],["zoom"],10,0,11,8,13,12,15,28,17,48,19,96,20,120],"text-allow-overlap":!0,"text-ignore-placement":!1},paint:{"text-color":"#ffffff","text-halo-color":"#000000","text-halo-width":2}}),n.setZoom(s)}}function c(){const s=Nt(Jr);if(console.log("Loading fields from",t),s.length>0){const a={type:"FeatureCollection",features:s.map((p,h)=>({type:"Feature",geometry:p.boundary,properties:{id:h,area:p.area,name:p.name}}))},u={type:"FeatureCollection",features:s.flatMap((p,h)=>{try{if(p.boundary.type==="Polygon"){const b=_n(p.boundary.coordinates),m=rn(b);return[{type:"Feature",geometry:(tn(m.geometry.coordinates,b)?m:Tl(b)).geometry,properties:{id:h,name:p.name}}]}else return p.boundary.type==="MultiPolygon"?p.boundary.coordinates.map(b=>{const m=_n(b),g=rn(m);return{type:"Feature",geometry:(tn(g.geometry.coordinates,m)?g:Tl(m)).geometry,properties:{id:h,name:p.name}}}):(console.warn(`Invalid geometry type for field ${h}: ${p.boundary.type}`),[])}catch(b){return console.warn(`Error processing field ${h}:`,b),[]}}).filter(p=>p!==null)};n.addSource("fields",{type:"geojson",data:a}),n.addSource("label-points",{type:"geojson",data:u}),n.addLayer({id:"fields-fill",type:"fill",source:"fields",paint:{"fill-color":"#0080ff","fill-opacity":.2}}),n.addLayer({id:"fields-outline",type:"line",source:"fields",paint:{"line-color":"#bfffbf","line-opacity":.5,"line-width":2}}),n.addLayer({id:"fields-labels",type:"symbol",source:"label-points",layout:{"text-field":["get","name"],"text-anchor":"center","symbol-sort-key":-1,"text-font":["DIN Pro Bold","Arial Unicode MS Bold"],"text-size":["interpolate",["linear"],["zoom"],10,0,11,8,13,12,15,28,17,48,19,96,20,120],"text-allow-overlap":!0,"text-ignore-placement":!1},paint:{"text-color":"#ffffff","text-halo-color":"#000000","text-halo-width":2}}),setTimeout(()=>{i()},1e4),setTimeout(()=>{i()},2e4);const f=o(s);f?(oo.set(f.toArray()),console.log("Stored field bounding box")):console.warn("Unable to calculate valid bounding box")}}return Xe(()=>{if(!n){console.error("Map is not available");return}return console.log("MapFields component mounted"),n.loaded()?c():n.on("load",c),()=>{n.off("load",c)}}),l.$$set=s=>{"map"in s&&r(0,n=s.map)},[n]}class Mf extends se{constructor(e){super(),ae(this,e,$f,null,ie,{map:0})}}const If=300;function El(l,e){return l.reduce((r,t)=>{const n=t[e];return r[n]||(r[n]=[]),r[n].push(t),r},{})}const qr={async loadMapTrails(l){var e;try{console.log("Loading trail data for master map ID:",l);const{data:r}=await Ve.auth.getSession();if(!((e=r==null?void 0:r.session)!=null&&e.user))throw console.error("No authenticated user session"),new Error("Authentication required");const t=r.session.user.id;if(!l)throw console.error("No master map ID provided"),new Error("Master map ID is required");const n=Date.now()-If*24*60*60*1e3;console.log("Fetching user trail data...");const{data:o,error:i}=await Ve.from("trail_data").select("*").eq("master_map_id",l).eq("vehicle_id",t).gte("timestamp",n).order("timestamp",{ascending:!0});if(i)throw console.error("Error fetching user trail data:",i),i;console.log(`Retrieved ${(o==null?void 0:o.length)||0} user trail data points`),console.log("Fetching other users' trail data...");const{data:c,error:s}=await Ve.rpc("get_other_trail_data",{p_master_map_id:l,p_user_id:t,p_retention_timestamp:n});if(s)throw console.error("Error fetching other trail data:",s),s;console.log(`Retrieved ${(c==null?void 0:c.length)||0} other trail data points`);const a=El(o||[],"vehicle_id"),u=El(c||[],"vehicle_id");return{user:a,other:u}}catch(r){return console.error("Error in loadMapTrails:",r),{error:!0,message:r.message||"An error occurred while loading trail data",user:{},other:{}}}},async checkOpenTrails(l,e){var r;try{console.log(`Checking open trails for vehicle ${l}`);const{data:t}=await Ve.auth.getSession();if(!((r=t==null?void 0:t.session)!=null&&r.user))throw console.error("No authenticated user session"),new Error("Authentication required");if(!l)throw new Error("Missing vehicle_id");const{data:n,error:o}=await Ve.rpc("handle_open_trails",{p_vehicle_id:l,p_close_stale_trails:!0,p_notify_on_close:!0,p_timeout_minutes:e||30});if(o)throw console.error("Error checking open trails:",o),o;const{most_recent_trail:i,processed_trails:c,stale_trail_closed:s,last_activity:a}=n;if(s)return console.log("Trail was closed due to being stale, considering all trails inactive"),{openTrail:null,trailData:null,processedTrails:c,staleTrailClosed:s,lastActivity:a};if(i&&!s){console.log(`Fetching data for active trail ${i.id}`);const{data:u,error:f}=await Ve.from("trail_stream").select("coordinate, timestamp").eq("trail_id",i.id).order("timestamp",{ascending:!0});if(f)throw new Error(`Failed to fetch trail data: ${f.message}`);const p=u.map(h=>({coordinates:{latitude:h.coordinate.coordinates[1],longitude:h.coordinate.coordinates[0]},timestamp:new Date(h.timestamp).getTime()}));return{openTrail:i,trailData:p,processedTrails:c,staleTrailClosed:s,lastActivity:a}}return console.log("No active trails found"),{openTrail:null,trailData:null,processedTrails:c,staleTrailClosed:s,lastActivity:a}}catch(t){return console.error("Error in checkOpenTrails:",t),{error:!0,message:t.message||"An unexpected error occurred while checking open trails"}}},async checkOtherActiveTrails(l,e){var r;try{console.log(`Checking other active trails for operation ${l}`);const{data:t}=await Ve.auth.getSession();if(!((r=t==null?void 0:t.session)!=null&&r.user))throw console.error("No authenticated user session"),new Error("Authentication required");if(!l||!e)throw new Error("Missing required parameters");const{data:n,error:o}=await Ve.from("trails").select(`
                    id,
                    vehicle_id,
                    operation_id,
                    start_time,
                    end_time,
                    trail_color,
                    trail_width
                    `).eq("operation_id",l).neq("vehicle_id",e).is("end_time",null).order("start_time",{ascending:!1});if(o)throw o;const i=n.reduce((a,u)=>(a[u.vehicle_id]||(a[u.vehicle_id]=[]),a[u.vehicle_id].push(u),a),{}),c=[],s=[];for(const[a,u]of Object.entries(i)){if(u.length===0)continue;const[f,...p]=u;if(p.length>0){console.log(`Found ${p.length} additional open trails for vehicle ${a}`);for(const h of p){console.log(`Processing trail ${h.id} for vehicle ${a} (started at ${h.start_time})`);try{const{data:b,error:m}=await Ve.rpc("process_and_close_trail",{p_trail_id:h.id});if(m)throw m;b.deleted?console.log(`Deleted trail ${h.id} - ${b.reason}`):console.log(`Successfully closed trail ${h.id}`)}catch(b){const m=`Error processing trail ${h.id}: ${b.message}`;console.error(m),c.push(m)}}}try{const{data:h,error:b}=await Ve.from("trail_stream").select("coordinate, timestamp").eq("trail_id",f.id).order("timestamp",{ascending:!0});if(b){b.code==="57014"?c.push(`Timeout error while loading trail data for vehicle ${a}`):c.push(`Error loading trail data for vehicle ${a}: ${b.message}`);continue}const m=h.map(g=>({coordinates:{latitude:g.coordinate.coordinates[1],longitude:g.coordinate.coordinates[0]},timestamp:new Date(g.timestamp).getTime()}));s.push({...f,trailData:m})}catch(h){c.push(`Error processing trail data for vehicle ${a}: ${h.message}`)}}return{activeTrails:s,errors:c.length>0?c:void 0}}catch(t){return console.error("Error in checkOtherActiveTrails:",t),{error:!0,message:t.message||"Failed to fetch active trails",code:t==null?void 0:t.code}}},async getOperationTrails(l){var e;try{console.log(`Fetching completed trails for operation ${l}`);const{data:r}=await Ve.auth.getSession();if(!((e=r==null?void 0:r.session)!=null&&e.user))throw console.error("No authenticated user session"),new Error("Authentication required");if(!l)throw new Error("Missing operation_id");const{data:t,error:n}=await Ve.from("trails").select(`
                    id,
                    vehicle_id,
                    operation_id,
                    start_time,
                    end_time,
                    trail_color,
                    trail_width,
                    path
                    `).eq("operation_id",l).not("end_time","is",null).order("start_time",{ascending:!0});if(n)throw n;return{trails:(t==null?void 0:t.map(i=>{let c;try{typeof i.path=="string"?c=_o.Geometry.parse(Buffer.from(i.path,"hex")).toGeoJSON():typeof i.path=="object"?c=i.path:(console.error("Unexpected path format:",i.path),c=null)}catch(s){console.error("Error parsing path:",s),c=null}return{...i,path:c}}))||[]}}catch(r){return console.error("Error in getOperationTrails:",r),{error:!0,message:r.message||"Failed to fetch operation trails"}}}};function Sl(l){let e,r,t,n,o,i="Close",c,s,a;const u=[Lf,Af],f=[];function p(h,b){return h[5]?0:1}return r=p(l),t=f[r]=u[r](l),{c(){e=N("div"),t.c(),n=X(),o=N("label"),o.textContent=i,this.h()},l(h){e=V(h,"DIV",{class:!0});var b=B(e);t.l(b),n=Z(b),o=V(b,"LABEL",{class:!0,for:!0,"data-svelte-h":!0}),$e(o)!=="svelte-jlumqq"&&(o.textContent=i),b.forEach(w),this.h()},h(){P(o,"class","modal-backdrop"),P(o,"for","end-trail-modal"),P(e,"class","modal modal-open")},m(h,b){R(h,e,b),f[r].m(e,null),M(e,n),M(e,o),c=!0,s||(a=Me(o,"click",l[7]),s=!0)},p(h,b){let m=r;r=p(h),r===m?f[r].p(h,b):(he(),S(f[m],1,1,()=>{f[m]=null}),me(),t=f[r],t?t.p(h,b):(t=f[r]=u[r](h),t.c()),C(t,1),t.m(e,n))},i(h){c||(C(t),c=!0)},o(h){S(t),c=!1},d(h){h&&w(e),f[r].d(),s=!1,a()}}}function Af(l){let e,r,t="End Trail Submission",n,o,i,c,s="Start Time (UTC):",a,u=new Date(l[2].start_time).toUTCString()+"",f,p,h,b,m="Current Time (UTC):",g,T=l[1].toUTCString()+"",$,I,E,k,_="Duration:",d,y,v,L,D,O="Raw Time Difference (ms):",A,H,U,q,ne,z="Trail Color:",F,j,ee,x=l[2].trail_color+"",K,te,ce,pe,Pe="Trail Width:",ve,le=l[2].trail_width+"",De,ue,Ne,Se,je,Zt="Number of Coordinates:",Je,wt=l[2].path.length+"",Lt,Ut,Rt,lt,ut,Pt,Pr,Dt,kt,un="Submit Trail",Dr,yt,fn="Continue",xe,Or,dn,qe=l[6].length>0&&$l(l);return Pt=new xl({props:{size:20}}),{c(){e=N("div"),r=N("h3"),r.textContent=t,n=X(),o=N("div"),i=N("p"),c=N("strong"),c.textContent=s,a=X(),f=_e(u),p=X(),h=N("p"),b=N("strong"),b.textContent=m,g=X(),$=_e(T),I=X(),E=N("p"),k=N("strong"),k.textContent=_,d=X(),y=_e(l[4]),v=X(),L=N("p"),D=N("strong"),D.textContent=O,A=X(),H=_e(l[0]),U=X(),q=N("p"),ne=N("strong"),ne.textContent=z,F=X(),j=N("span"),ee=X(),K=_e(x),te=X(),ce=N("p"),pe=N("strong"),pe.textContent=Pe,ve=X(),De=_e(le),ue=_e("px"),Ne=X(),Se=N("p"),je=N("strong"),je.textContent=Zt,Je=X(),Lt=_e(wt),Ut=X(),qe&&qe.c(),Rt=X(),lt=N("div"),ut=N("button"),W(Pt.$$.fragment),Pr=X(),Dt=N("div"),kt=N("button"),kt.textContent=un,Dr=X(),yt=N("button"),yt.textContent=fn,this.h()},l(Ue){e=V(Ue,"DIV",{class:!0});var Re=B(e);r=V(Re,"H3",{class:!0,"data-svelte-h":!0}),$e(r)!=="svelte-3agsw4"&&(r.textContent=t),n=Z(Re),o=V(Re,"DIV",{class:!0});var We=B(o);i=V(We,"P",{});var cr=B(i);c=V(cr,"STRONG",{"data-svelte-h":!0}),$e(c)!=="svelte-1ygkz80"&&(c.textContent=s),a=Z(cr),f=be(cr,u),cr.forEach(w),p=Z(We),h=V(We,"P",{});var ur=B(h);b=V(ur,"STRONG",{"data-svelte-h":!0}),$e(b)!=="svelte-65n9tn"&&(b.textContent=m),g=Z(ur),$=be(ur,T),ur.forEach(w),I=Z(We),E=V(We,"P",{});var fr=B(E);k=V(fr,"STRONG",{"data-svelte-h":!0}),$e(k)!=="svelte-1on1bp8"&&(k.textContent=_),d=Z(fr),y=be(fr,l[4]),fr.forEach(w),v=Z(We),L=V(We,"P",{});var dr=B(L);D=V(dr,"STRONG",{"data-svelte-h":!0}),$e(D)!=="svelte-1wg6fgl"&&(D.textContent=O),A=Z(dr),H=be(dr,l[0]),dr.forEach(w),U=Z(We),q=V(We,"P",{});var Ft=B(q);ne=V(Ft,"STRONG",{"data-svelte-h":!0}),$e(ne)!=="svelte-1au0zqn"&&(ne.textContent=z),F=Z(Ft),j=V(Ft,"SPAN",{class:!0,style:!0}),B(j).forEach(w),ee=Z(Ft),K=be(Ft,x),Ft.forEach(w),te=Z(We),ce=V(We,"P",{});var Jt=B(ce);pe=V(Jt,"STRONG",{"data-svelte-h":!0}),$e(pe)!=="svelte-1uw2qy2"&&(pe.textContent=Pe),ve=Z(Jt),De=be(Jt,le),ue=be(Jt,"px"),Jt.forEach(w),Ne=Z(We),Se=V(We,"P",{});var hr=B(Se);je=V(hr,"STRONG",{"data-svelte-h":!0}),$e(je)!=="svelte-kcko15"&&(je.textContent=Zt),Je=Z(hr),Lt=be(hr,wt),hr.forEach(w),Ut=Z(We),qe&&qe.l(We),We.forEach(w),Rt=Z(Re),lt=V(Re,"DIV",{class:!0});var mr=B(lt);ut=V(mr,"BUTTON",{class:!0});var hn=B(ut);J(Pt.$$.fragment,hn),hn.forEach(w),Pr=Z(mr),Dt=V(mr,"DIV",{});var gr=B(Dt);kt=V(gr,"BUTTON",{class:!0,"data-svelte-h":!0}),$e(kt)!=="svelte-160kdpc"&&(kt.textContent=un),Dr=Z(gr),yt=V(gr,"BUTTON",{class:!0,"data-svelte-h":!0}),$e(yt)!=="svelte-txagx3"&&(yt.textContent=fn),gr.forEach(w),mr.forEach(w),Re.forEach(w),this.h()},h(){P(r,"class","text-lg font-bold"),P(j,"class","inline-block h-4 w-4"),Oe(j,"background-color",l[2].trail_color),P(o,"class","py-4"),P(ut,"class","btn btn-square btn-error"),P(kt,"class","btn btn-primary ml-2"),P(yt,"class","btn ml-2"),P(lt,"class","modal-action flex justify-between"),P(e,"class","modal-box")},m(Ue,Re){R(Ue,e,Re),M(e,r),M(e,n),M(e,o),M(o,i),M(i,c),M(i,a),M(i,f),M(o,p),M(o,h),M(h,b),M(h,g),M(h,$),M(o,I),M(o,E),M(E,k),M(E,d),M(E,y),M(o,v),M(o,L),M(L,D),M(L,A),M(L,H),M(o,U),M(o,q),M(q,ne),M(q,F),M(q,j),M(q,ee),M(q,K),M(o,te),M(o,ce),M(ce,pe),M(ce,ve),M(ce,De),M(ce,ue),M(o,Ne),M(o,Se),M(Se,je),M(Se,Je),M(Se,Lt),M(o,Ut),qe&&qe.m(o,null),M(e,Rt),M(e,lt),M(lt,ut),G(Pt,ut,null),M(lt,Pr),M(lt,Dt),M(Dt,kt),M(Dt,Dr),M(Dt,yt),xe=!0,Or||(dn=[Me(ut,"click",l[8]),Me(kt,"click",l[11]),Me(yt,"click",l[7])],Or=!0)},p(Ue,Re){(!xe||Re&4)&&u!==(u=new Date(Ue[2].start_time).toUTCString()+"")&&Fe(f,u),(!xe||Re&2)&&T!==(T=Ue[1].toUTCString()+"")&&Fe($,T),(!xe||Re&16)&&Fe(y,Ue[4]),(!xe||Re&1)&&Fe(H,Ue[0]),(!xe||Re&4)&&Oe(j,"background-color",Ue[2].trail_color),(!xe||Re&4)&&x!==(x=Ue[2].trail_color+"")&&Fe(K,x),(!xe||Re&4)&&le!==(le=Ue[2].trail_width+"")&&Fe(De,le),(!xe||Re&4)&&wt!==(wt=Ue[2].path.length+"")&&Fe(Lt,wt),Ue[6].length>0?qe?qe.p(Ue,Re):(qe=$l(Ue),qe.c(),qe.m(o,null)):qe&&(qe.d(1),qe=null)},i(Ue){xe||(C(Pt.$$.fragment,Ue),xe=!0)},o(Ue){S(Pt.$$.fragment,Ue),xe=!1},d(Ue){Ue&&w(e),qe&&qe.d(),Y(Pt),Or=!1,vt(dn)}}}function Lf(l){let e,r,t="Confirm Delete Trail",n,o,i=`<p>Are you sure you want to delete this trail? This action cannot be
            undone.</p>`,c,s,a,u="Confirm Delete",f,p,h="Cancel",b,m;return{c(){e=N("div"),r=N("h3"),r.textContent=t,n=X(),o=N("div"),o.innerHTML=i,c=X(),s=N("div"),a=N("button"),a.textContent=u,f=X(),p=N("button"),p.textContent=h,this.h()},l(g){e=V(g,"DIV",{class:!0});var T=B(e);r=V(T,"H3",{class:!0,"data-svelte-h":!0}),$e(r)!=="svelte-1bidisu"&&(r.textContent=t),n=Z(T),o=V(T,"DIV",{class:!0,"data-svelte-h":!0}),$e(o)!=="svelte-1teiw7t"&&(o.innerHTML=i),c=Z(T),s=V(T,"DIV",{class:!0});var $=B(s);a=V($,"BUTTON",{class:!0,"data-svelte-h":!0}),$e(a)!=="svelte-1m4fmxi"&&(a.textContent=u),f=Z($),p=V($,"BUTTON",{class:!0,"data-svelte-h":!0}),$e(p)!=="svelte-1a5gsau"&&(p.textContent=h),$.forEach(w),T.forEach(w),this.h()},h(){P(r,"class","text-lg font-bold text-red-600"),P(o,"class","py-4"),P(a,"class","btn btn-error"),P(p,"class","btn"),P(s,"class","modal-action"),P(e,"class","modal-box")},m(g,T){R(g,e,T),M(e,r),M(e,n),M(e,o),M(e,c),M(e,s),M(s,a),M(s,f),M(s,p),b||(m=[Me(a,"click",l[10]),Me(p,"click",l[9])],b=!0)},p:de,i:de,o:de,d(g){g&&w(e),b=!1,vt(m)}}}function $l(l){let e,r,t,n=l[6].length+"",o,i;return{c(){e=N("div"),r=N("p"),t=_e("There are "),o=_e(n),i=_e(" unsaved trails pending sync"),this.h()},l(c){e=V(c,"DIV",{class:!0});var s=B(e);r=V(s,"P",{class:!0});var a=B(r);t=be(a,"There are "),o=be(a,n),i=be(a," unsaved trails pending sync"),a.forEach(w),s.forEach(w),this.h()},h(){P(r,"class","text-yellow-800"),P(e,"class","mt-4 rounded bg-yellow-100 p-4")},m(c,s){R(c,e,s),M(e,r),M(r,t),M(r,o),M(r,i)},p(c,s){s&64&&n!==(n=c[6].length+"")&&Fe(o,n)},d(c){c&&w(e)}}}function Pf(l){let e,r,t=l[3]&&l[2]&&Sl(l);return{c(){t&&t.c(),e=oe()},l(n){t&&t.l(n),e=oe()},m(n,o){t&&t.m(n,o),R(n,e,o),r=!0},p(n,[o]){n[3]&&n[2]?t?(t.p(n,o),o&12&&C(t,1)):(t=Sl(n),t.c(),C(t,1),t.m(e.parentNode,e)):t&&(he(),S(t,1,1,()=>{t=null}),me())},i(n){r||(C(t),r=!0)},o(n){S(t),r=!1},d(n){n&&w(e),t&&t.d(n)}}}function Df(l){const e=Math.floor(l/36e5),r=Math.floor(l%36e5/6e4),t=Math.floor(l%6e4/1e3);return`${e}h ${r}m ${t}s`}function Of(l,e,r){let t,n,o;re(l,at,k=>r(2,t=k)),re(l,xt,k=>r(6,n=k)),re(l,qt,k=>r(3,o=k));let i,c,s,a,u=!1;async function f(k,_="POST",d={}){var L,D;const y=Nt(Ot);if(!((L=y==null?void 0:y.user)!=null&&L.id)){await Tr();const O=Nt(Ot);if(!((D=O==null?void 0:O.user)!=null&&D.id))throw new Error("Authentication required")}const v=Nt(Ot);return fetch(k,{method:_,headers:{"Content-Type":"application/json",Authorization:`Bearer ${v.access_token}`},body:_!=="GET"?JSON.stringify(d):void 0})}Xe(async()=>{await Tr(),n.length>0&&h()}),gt(()=>{a&&clearInterval(a)});async function p(k){try{const _=await f("/api/map-trails/delete-trail","POST",{trail_id:k});if(!_.ok)throw new Error(`HTTP error! status: ${_.status}`);await _.json(),fe.success("Trail deleted successfully"),at.set(null),ct.set(!1),qt.set(!1),r(5,u=!1)}catch(_){console.error("Error deleting trail:",_),fe.error("Failed to delete trail")}}function h(){a=setInterval(b,3e4)}async function b(){if(!n.length){clearInterval(a);return}console.log("Attempting to sync unsaved trails:",n.length);for(const k of n)try{const _=await f("/api/map-trails/close-trail","POST",k);if(!_.ok)throw new Error(`HTTP error! status: ${_.status}`);await _.json(),xt.remove(k),Et.clear(),fe.success(`Successfully synced trail ${k.trail_id}`)}catch(_){console.error(`Error syncing trail: ${_.message}`),!_.message.includes("Failed to fetch")&&!_.message.includes("ERR_INTERNET_DISCONNECTED")&&(xt.remove(k),fe.error(`Failed to sync trail ${k.trail_id}: ${_.message}`))}n.length===0&&clearInterval(a)}function m(){qt.set(!1),ct.set(!0),r(5,u=!1)}function g(){r(5,u=!0)}function T(){r(5,u=!1)}async function $(){t&&await p(t.id)}async function I(){if(!t){fe.error("No active trail to close");return}console.log("Submitting trail data:",t);const k=t.path.map(d=>({latitude:d.coordinates.latitude,longitude:d.coordinates.longitude,timestamp:d.timestamp}));if(k.length===0||k.length===1){const d=k.length===0?"empty trail":"trail with only one coordinate";fe.info(`Deleting ${d}`),await p(t.id);return}const _={trail_id:t.id,vehicle_id:t.vehicle_id,operation_id:t.operation_id,path:k,trail_color:t.trail_color,trail_width:t.trail_width};try{const d=await f("/api/map-trails/close-trail","POST",_),y=await d.json();if(!d.ok)throw new Error(y.error||"Failed to close trail");const v={type:"LineString",coordinates:k.map(D=>[D.longitude,D.latitude])},L={...y.trail,path:v};st.update(D=>[...D,L]),fe.success("Trail closed successfully"),console.log("Trail closed successfully:",y),Et.clear(),at.set(null),ct.set(!1)}catch(d){console.error("Error closing trail:",d),d.message.includes("Failed to fetch")||d.message.includes("ERR_INTERNET_DISCONNECTED")?(fe.error("Device appears to be offline. Trail will be saved when connection is restored."),xt.add(_),h()):fe.error(`Error closing trail: ${d.message}`),at.set(null),ct.set(!1)}qt.set(!1)}function E(){console.log("End trail event received in EndTrailModal"),qt.set(!0)}return l.$$.update=()=>{l.$$.dirty&15&&o&&t&&(r(1,s=new Date),r(0,i=s.getTime()-new Date(t.start_time).getTime()),r(4,c=Df(i)))},[i,s,t,o,c,u,n,m,g,T,$,I,E]}class Nf extends se{constructor(e){super(),ae(this,e,Of,Pf,ie,{triggerEndTrail:12})}get triggerEndTrail(){return this.$$.ctx[12]}}const Vf=l=>({}),Ml=l=>({calculateZoomDependentWidth:l[1],generateTrailIds:Ct,deleteTrail:l[2]});function zf(l){let e,r;const t=l[11].default,n=ke(t,l,l[10],Ml);return{c(){e=_e(`svelte Copy\r
`),n&&n.c()},l(o){e=be(o,`svelte Copy\r
`),n&&n.l(o)},m(o,i){R(o,e,i),n&&n.m(o,i),r=!0},p(o,[i]){n&&n.p&&(!r||i&1024)&&ye(n,t,o,o[10],r?Ce(t,o[10],i,Vf):Te(o[10]),Ml)},i(o){r||(C(n,o),r=!0)},o(o){S(n,o),r=!1},d(o){o&&w(e),n&&n.d(o)}}}function Ct(l){return{sourceId:`trail-source-${l}`,layerId:`trail-layer-${l}`,highlightLayerId:`trail-highlight-${l}`,highlightBackgroundLayerId:`trail-highlight-bg-${l}`}}function Il(l){const e="type"in l?l:er(l);return{type:"Feature",properties:{},geometry:e}}function er(l){return{type:"LineString",coordinates:[...l].sort((r,t)=>r.timestamp-t.timestamp).map(r=>[r.coordinates.longitude,r.coordinates.latitude])}}function Bf(l,e,r){let t,n;re(l,st,I=>r(14,t=I)),re(l,at,I=>r(15,n=I));let{$$slots:o={},$$scope:i}=e;const c={MULTIPLIER:1,MIN_ZOOM:10,MAX_ZOOM:24,MIN_POWER:-6,MAX_POWER:8,DEFAULT_OPACITY:.5,LOAD_DELAY:10};let{map:s}=e,a=0;function u(I,E=1){return["interpolate",["exponential",2],["zoom"],c.MIN_ZOOM,["*",I*c.MULTIPLIER*E,["^",2,c.MIN_POWER]],c.MAX_ZOOM,["*",I*c.MULTIPLIER*E,["^",2,c.MAX_POWER]]]}function f(I){const{sourceId:E,layerId:k,highlightLayerId:_,highlightBackgroundLayerId:d}=Ct(I);[_,d,k].forEach(v=>{s.getLayer(v)&&s.removeLayer(v)}),s.getSource(E)&&s.removeSource(E)}async function p(I){try{if(!(await Vo("/api/map-trails/delete-trail","POST",{trail_id:I})).ok)throw fe.error("Failed to delete trail"),new Error("Failed to delete trail");return st.update(k=>k.filter(_=>_.id!==I)),fe.success("Trail deleted"),!0}catch(E){return console.error("Error deleting trail:",E),fe.error("Error deleting trail"),!1}}function h(I){const{sourceId:E,layerId:k}=Ct(I.id),_=u(I.trail_width||3,1);s.addSource(E,{type:"geojson",data:Il(I.path)}),s.addLayer({id:k,type:"line",source:E,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":I.trail_color||"#FF0000","line-width":_,"line-opacity":c.DEFAULT_OPACITY}})}function b(I){const{sourceId:E,layerId:k}=Ct(I.id);if(n&&n.id!==I.id&&(console.log("Cleaning up old trail:",n.id),f(n.id)),s.getSource(E)){const _=s.getSource(E),d=er(I.path),y=d.coordinates.length;if(y!==a){const v={type:"Feature",properties:{},geometry:d};_.setData(v),a=y}}else{console.log("Creating new trail source:",E);const _={...I,path:er(I.path)};h(_)}}function m(I){const{sourceId:E,layerId:k}=Ct(I.id);if(s.getSource(E)){const _=s.getSource(E),d=er(I.path),y={type:"Feature",properties:{},geometry:d};_.setData(y)}else{console.log("Creating new trail source:",E);const _={...I,path:er(I.path)};h(_)}}async function g(){console.log("Starting to load historical trails",{totalTrails:t.length,trails:t});for(let I=0;I<t.length;I++){const E=t[I];try{await h(E),await new Promise(k=>setTimeout(k,c.LOAD_DELAY))}catch(k){console.log(`Failed to load trail [${I+1}/${t.length}]:`,{trailId:E.id||"unknown",error:k,trailData:E}),console.error(`Failed to load trail [${I+1}/${t.length}]:`,{trailId:E.id||"unknown",error:k,trailData:E}),fe.error("Failed to load corrupt trail data. Please try refreshing.",{description:`Trail ${I+1}/${t.length} (ID: ${E.id||"unknown"})`})}}console.log("Finished loading historical trails")}let T={currentTrailUnsubscribe:null,otherActiveTrailsUnsubscribe:null,historicalTrailsUnsubscribe:null};Xe(()=>{g(),T.currentTrailUnsubscribe=at.subscribe(E=>{E&&E.path&&b(E)}),T.otherActiveTrailsUnsubscribe=it.subscribe(E=>{E&&E.forEach(k=>{k&&k.path&&m(k)})});let I=t;T.historicalTrailsUnsubscribe=st.subscribe(E=>{I&&E&&I.filter(_=>!E.some(d=>d.id===_.id)).forEach(_=>{console.log("Deleting historical trail:",_.id),f(_.id)}),I=E})}),gt(()=>{console.log("Cleaning up trail subscriptions"),T.currentTrailUnsubscribe&&T.currentTrailUnsubscribe(),T.otherActiveTrailsUnsubscribe&&T.otherActiveTrailsUnsubscribe(),T.historicalTrailsUnsubscribe&&T.historicalTrailsUnsubscribe()});const $={addTrail:h,removeTrail:f,deleteTrail:p,reloadAll:g,updateCurrentTrail:b,generateTrailIds:Ct,calculateZoomDependentWidth:u,createTrailGeoJSON:Il};return l.$$set=I=>{"map"in I&&r(4,s=I.map),"$$scope"in I&&r(10,i=I.$$scope)},[Ct,u,p,c,s,f,h,b,m,$,i,o]}class Uf extends se{constructor(e){super(),ae(this,e,Bf,zf,ie,{TRAIL_CONFIG:3,map:4,generateTrailIds:0,calculateZoomDependentWidth:1,removeTrail:5,deleteTrail:2,addTrail:6,updateCurrentTrail:7,updateOtherActiveTrail:8,trailManagerAPI:9})}get TRAIL_CONFIG(){return this.$$.ctx[3]}get generateTrailIds(){return Ct}get calculateZoomDependentWidth(){return this.$$.ctx[1]}get removeTrail(){return this.$$.ctx[5]}get deleteTrail(){return this.$$.ctx[2]}get addTrail(){return this.$$.ctx[6]}get updateCurrentTrail(){return this.$$.ctx[7]}get updateOtherActiveTrail(){return this.$$.ctx[8]}get trailManagerAPI(){return this.$$.ctx[9]}}function Rf(l){let e,r;return e=new vo({props:{size:20}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function Ff(l){let e,r;return e=new Kl({props:{size:20,color:"black"}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function Al(l){let e,r,t,n,o,i,c,s,a,u,f,p,h,b,m;n=new Bo({props:{size:20}});let g=l[4].length>0&&Ll(l);return a=new zo({props:{size:20}}),p=new xl({props:{size:20}}),{c(){e=N("div"),r=N("div"),t=N("button"),W(n.$$.fragment),o=X(),i=N("div"),g&&g.c(),c=X(),s=N("button"),W(a.$$.fragment),u=X(),f=N("button"),W(p.$$.fragment),this.h()},l(T){e=V(T,"DIV",{class:!0,style:!0});var $=B(e);r=V($,"DIV",{class:!0});var I=B(r);t=V(I,"BUTTON",{class:!0});var E=B(t);J(n.$$.fragment,E),E.forEach(w),o=Z(I),i=V(I,"DIV",{class:!0});var k=B(i);g&&g.l(k),k.forEach(w),c=Z(I),s=V(I,"BUTTON",{class:!0});var _=B(s);J(a.$$.fragment,_),_.forEach(w),u=Z(I),f=V(I,"BUTTON",{class:!0});var d=B(f);J(p.$$.fragment,d),d.forEach(w),I.forEach(w),$.forEach(w),this.h()},h(){P(t,"class","btn btn-circle h-10 w-10 shrink-0 border-none bg-white text-lg hover:bg-gray-100"),t.disabled=!1,P(i,"class","mx-1 truncate text-center text-sm text-white"),P(s,"class","btn btn-circle h-10 w-10 shrink-0 border-none bg-white text-lg hover:bg-gray-100"),s.disabled=!1,P(f,"class","btn btn-circle btn-error h-10 w-10 shrink-0 border-none hover:bg-error/90"),P(r,"class","flex items-center justify-between gap-x-[max(0.25rem,min(1rem,1.5vw))] p-[max(0.25rem,min(1rem,1.5vw))]"),P(e,"class","navigation-fade-in fixed bottom-4 left-1/2 flex -translate-x-1/2 items-center rounded-full bg-black/70 backdrop-blur svelte-3zmpjl"),Oe(e,"max-width","calc(70vw - 2rem)"),Oe(e,"min-width","min-content")},m(T,$){R(T,e,$),M(e,r),M(r,t),G(n,t,null),M(r,o),M(r,i),g&&g.m(i,null),M(r,c),M(r,s),G(a,s,null),M(r,u),M(r,f),G(p,f,null),h=!0,b||(m=[Me(t,"click",l[7]),Me(s,"click",l[8]),Me(f,"click",l[14])],b=!0)},p(T,$){T[4].length>0?g?g.p(T,$):(g=Ll(T),g.c(),g.m(i,null)):g&&(g.d(1),g=null)},i(T){h||(C(n.$$.fragment,T),C(a.$$.fragment,T),C(p.$$.fragment,T),h=!0)},o(T){S(n.$$.fragment,T),S(a.$$.fragment,T),S(p.$$.fragment,T),h=!1},d(T){T&&w(e),Y(n),g&&g.d(),Y(a),Y(p),b=!1,vt(m)}}}function Ll(l){let e,r=l[0]+1+"",t,n,o=l[4].length+"",i;return{c(){e=_e("Trail "),t=_e(r),n=_e(" of "),i=_e(o)},l(c){e=be(c,"Trail "),t=be(c,r),n=be(c," of "),i=be(c,o)},m(c,s){R(c,e,s),R(c,t,s),R(c,n,s),R(c,i,s)},p(c,s){s&1&&r!==(r=c[0]+1+"")&&Fe(t,r),s&16&&o!==(o=c[4].length+"")&&Fe(i,o)},d(c){c&&(w(e),w(t),w(n),w(i))}}}function Pl(l){let e,r,t,n="Delete Trail?",o,i,c=`Are you sure you want to delete this trail? This action cannot be
        undone.`,s,a,u,f="Cancel",p,h,b="Delete",m,g,T,$="close",I,E;return{c(){e=N("dialog"),r=N("div"),t=N("h3"),t.textContent=n,o=X(),i=N("p"),i.textContent=c,s=X(),a=N("div"),u=N("button"),u.textContent=f,p=X(),h=N("button"),h.textContent=b,m=X(),g=N("form"),T=N("button"),T.textContent=$,this.h()},l(k){e=V(k,"DIALOG",{class:!0});var _=B(e);r=V(_,"DIV",{class:!0});var d=B(r);t=V(d,"H3",{class:!0,"data-svelte-h":!0}),$e(t)!=="svelte-ox39ht"&&(t.textContent=n),o=Z(d),i=V(d,"P",{class:!0,"data-svelte-h":!0}),$e(i)!=="svelte-uzgtjw"&&(i.textContent=c),s=Z(d),a=V(d,"DIV",{class:!0});var y=B(a);u=V(y,"BUTTON",{class:!0,"data-svelte-h":!0}),$e(u)!=="svelte-afpmp3"&&(u.textContent=f),p=Z(y),h=V(y,"BUTTON",{class:!0,"data-svelte-h":!0}),$e(h)!=="svelte-14b26fi"&&(h.textContent=b),y.forEach(w),d.forEach(w),m=Z(_),g=V(_,"FORM",{method:!0,class:!0});var v=B(g);T=V(v,"BUTTON",{"data-svelte-h":!0}),$e(T)!=="svelte-opg30q"&&(T.textContent=$),v.forEach(w),_.forEach(w),this.h()},h(){P(t,"class","text-lg font-bold"),P(i,"class","py-4"),P(u,"class","btn btn-ghost"),P(h,"class","btn btn-error"),P(a,"class","modal-action"),P(r,"class","modal-box"),P(g,"method","dialog"),P(g,"class","modal-backdrop"),P(e,"class","modal modal-open")},m(k,_){R(k,e,_),M(e,r),M(r,t),M(r,o),M(r,i),M(r,s),M(r,a),M(a,u),M(a,p),M(a,h),M(e,m),M(e,g),M(g,T),I||(E=[Me(u,"click",l[15]),Me(h,"click",l[5]),Me(T,"click",l[16])],I=!0)},p:de,d(k){k&&w(e),I=!1,vt(E)}}}function Hf(l){let e,r,t,n,o,i,c,s,a;const u=[Ff,Rf],f=[];function p(m,g){return m[1]?0:1}r=p(l),t=f[r]=u[r](l);let h=l[1]&&Al(l),b=l[2]&&l[3]&&Pl(l);return{c(){e=N("button"),t.c(),n=X(),h&&h.c(),o=X(),b&&b.c(),i=oe(),this.h()},l(m){e=V(m,"BUTTON",{class:!0,style:!0});var g=B(e);t.l(g),g.forEach(w),n=Z(m),h&&h.l(m),o=Z(m),b&&b.l(m),i=oe(),this.h()},h(){P(e,"class","btn btn-circle fixed bottom-8 left-6 z-50 h-10 w-10 border-none bg-black/70 text-white backdrop-blur transition-transform hover:scale-110 hover:bg-black/80"),Oe(e,"background",l[1]?"rgba(255, 255, 255, 0.9)":""),St(e,"text-black",l[1])},m(m,g){R(m,e,g),f[r].m(e,null),R(m,n,g),h&&h.m(m,g),R(m,o,g),b&&b.m(m,g),R(m,i,g),c=!0,s||(a=Me(e,"click",l[6]),s=!0)},p(m,[g]){let T=r;r=p(m),r!==T&&(he(),S(f[T],1,1,()=>{f[T]=null}),me(),t=f[r],t||(t=f[r]=u[r](m),t.c()),C(t,1),t.m(e,null)),(!c||g&2)&&Oe(e,"background",m[1]?"rgba(255, 255, 255, 0.9)":""),(!c||g&2)&&St(e,"text-black",m[1]),m[1]?h?(h.p(m,g),g&2&&C(h,1)):(h=Al(m),h.c(),C(h,1),h.m(o.parentNode,o)):h&&(he(),S(h,1,1,()=>{h=null}),me()),m[2]&&m[3]?b?b.p(m,g):(b=Pl(m),b.c(),b.m(i.parentNode,i)):b&&(b.d(1),b=null)},i(m){c||(C(t),C(h),c=!0)},o(m){S(t),S(h),c=!1},d(m){m&&(w(e),w(n),w(o),w(i)),f[r].d(),h&&h.d(m),b&&b.d(m),s=!1,a()}}}function jf(l,e,r){let t;re(l,st,A=>r(4,t=A));let{calculateZoomDependentWidth:n}=e,{generateTrailIds:o}=e,{deleteTrail:i}=e,{map:c}=e,s=0,a=!0,u=!1,f=!1,p=null;const h={TRAIL_HIGHLIGHT_DELAY:3e3,FLIGHT_DURATION:2e3,HIGHLIGHT_WIDTH_MULTIPLIER:1.2,MAX_FLIGHT_ZOOM:19},b=[[0,4,3],[.5,4,2.5],[1,4,2],[1.5,4,1.5],[2,4,1],[2.5,4,.5],[3,4,0],[0,.5,3,3.5],[0,1,3,3],[0,1.5,3,2.5],[0,2,3,2],[0,2.5,3,1.5],[0,3,3,1],[0,3.5,3,.5]];async function m(){p&&await i(p.id)&&(r(2,f=!1),r(3,p=null),t.length===0?r(1,u=!1):(s>=t.length&&r(0,s=Math.max(0,t.length-1)),_(s)))}function g(){if(!t.length){fe.error("No trails available. Create some trails first!");return}if(r(1,u=!u),!u)t.forEach(A=>k(A.id));else if(t.length>0){const A=t[s];E(A),$(A)}}function T(A){const{sourceId:H,highlightLayerId:U}=o(A.id),q=A.trail_width*h.HIGHLIGHT_WIDTH_MULTIPLIER;c.addLayer({type:"line",source:H,id:U,paint:{"line-color":"white","line-width":n(q,1.5),"line-opacity":.8},layout:{"line-cap":"round","line-join":"round"}});const ne=`${U}-inner`;return c.addLayer({type:"line",source:H,id:ne,paint:{"line-color":A.trail_color,"line-width":n(q,.8),"line-opacity":1},layout:{"line-cap":"round","line-join":"round"}}),()=>{c.getLayer(U)&&c.removeLayer(U),c.getLayer(ne)&&c.removeLayer(ne)}}function $(A){const{sourceId:H,highlightBackgroundLayerId:U}=o(A.id);let q=0;const ne=A.trail_width*h.HIGHLIGHT_WIDTH_MULTIPLIER,z=[.3,.4,.6,.8,1,.8,.6,.4];let F=null;if(!c.getSource(H))return;c.addLayer({type:"line",source:H,id:U,paint:{"line-color":A.trail_color,"line-width":n(ne,2.2),"line-opacity":.3,"line-blur":n(ne,.8)},layout:{"line-cap":"round","line-join":"bevel"}});function j(ee){if(!a||!c){F&&cancelAnimationFrame(F);return}try{const x=parseInt(ee/100%z.length);x!==q&&c.getLayer(U)&&(c.setPaintProperty(U,"line-opacity",z[q]),q=x),c.getLayer(U)&&(F=requestAnimationFrame(j))}catch{console.log("Animation stopped due to map cleanup"),F&&cancelAnimationFrame(F)}}return j(0),()=>{F&&cancelAnimationFrame(F)}}function I(A){const{sourceId:H,highlightLayerId:U,highlightBackgroundLayerId:q}=o(A.id);let ne=0;const z=A.trail_width*h.HIGHLIGHT_WIDTH_MULTIPLIER,F=A.trail_color.match(/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i);let j=A.trail_color;if(F){const K=parseInt(F[1],16),te=parseInt(F[2],16),ce=parseInt(F[3],16);j=`rgb(${Math.min(K+80,255)}, ${Math.min(te+80,255)}, ${Math.min(ce+80,255)})`}const ee=[.3,.4,.6,.8,1,.8,.6,.4];c.addLayer({type:"line",source:H,id:q,paint:{"line-color":A.trail_color,"line-width":n(z,2.2),"line-opacity":.3,"line-blur":n(z,.8)},layout:{"line-cap":"round","line-join":"bevel"}}),c.addLayer({type:"line",source:H,id:U,paint:{"line-color":j,"line-width":n(z,.8),"line-dasharray":b[0],"line-opacity":1},layout:{"line-cap":"butt","line-join":"bevel"}});function x(K){if(!a)return;const te=parseInt(K/100%ee.length);try{te!==ne&&(c!=null&&c.getLayer(q))&&(c.setPaintProperty(q,"line-opacity",ee[ne]),ne=te),c!=null&&c.getLayer(q)&&requestAnimationFrame(x)}catch{console.log("Animation stopped due to map cleanup"),a=!1}}x(0)}function E(A){const H=A.path.coordinates,U=H.reduce((q,ne)=>q.extend(ne),new Ke.LngLatBounds(H[0],H[0]));c.fitBounds(U,{padding:50,duration:h.FLIGHT_DURATION,maxZoom:h.MAX_FLIGHT_ZOOM})}function k(A){const{highlightLayerId:H,highlightBackgroundLayerId:U}=o(A);try{c&&c.getLayer(H)&&c.removeLayer(H),c&&c.getLayer(U)&&c.removeLayer(U)}catch(q){console.log("Error removing highlight layers:",q)}}async function _(A){if(t.length===0)return;t.forEach(U=>k(U.id)),r(0,s=A),s>=t.length?r(0,s=0):s<0&&r(0,s=t.length-1);const H=t[s];E(H),$(H),await new Promise(U=>setTimeout(U,h.FLIGHT_DURATION))}function d(){_(s-1)}function y(){_(s+1)}const v={highlightTrail:I,glowTrail:$,outlineTrail:T,removeHighlight:k,flyToTrail:E,nextTrail:y,previousTrail:d,navigateToTrail:_};Xe(()=>()=>{a=!1});const L=()=>{r(3,p=t[s]),r(2,f=!0)},D=()=>r(2,f=!1),O=()=>r(2,f=!1);return l.$$set=A=>{"calculateZoomDependentWidth"in A&&r(9,n=A.calculateZoomDependentWidth),"generateTrailIds"in A&&r(10,o=A.generateTrailIds),"deleteTrail"in A&&r(11,i=A.deleteTrail),"map"in A&&r(12,c=A.map)},[s,u,f,p,t,m,g,d,y,n,o,i,c,v,L,D,O]}class qf extends se{constructor(e){super(),ae(this,e,jf,Hf,ie,{calculateZoomDependentWidth:9,generateTrailIds:10,deleteTrail:11,map:12,highlighterAPI:13})}get highlighterAPI(){return this.$$.ctx[13]}}function Wf(l){let e,r,t;function n(i){l[3](i)}let o={map:l[2],calculateZoomDependentWidth:l[5],generateTrailIds:l[6],deleteTrail:l[7]};return l[1]!==void 0&&(o.highlighterAPI=l[1]),e=new qf({props:o}),He.push(()=>Ir(e,"highlighterAPI",n)),{c(){W(e.$$.fragment)},l(i){J(e.$$.fragment,i)},m(i,c){G(e,i,c),t=!0},p(i,c){const s={};c&4&&(s.map=i[2]),c&32&&(s.calculateZoomDependentWidth=i[5]),c&64&&(s.generateTrailIds=i[6]),c&128&&(s.deleteTrail=i[7]),!r&&c&2&&(r=!0,s.highlighterAPI=i[1],Mr(()=>r=!1)),e.$set(s)},i(i){t||(C(e.$$.fragment,i),t=!0)},o(i){S(e.$$.fragment,i),t=!1},d(i){Y(e,i)}}}function Gf(l){let e,r,t;function n(i){l[4](i)}let o={map:l[2],$$slots:{default:[Wf,({calculateZoomDependentWidth:i,generateTrailIds:c,deleteTrail:s})=>({5:i,6:c,7:s}),({calculateZoomDependentWidth:i,generateTrailIds:c,deleteTrail:s})=>(i?32:0)|(c?64:0)|(s?128:0)]},$$scope:{ctx:l}};return l[0]!==void 0&&(o.trailManagerAPI=l[0]),e=new Uf({props:o}),He.push(()=>Ir(e,"trailManagerAPI",n)),{c(){W(e.$$.fragment)},l(i){J(e.$$.fragment,i)},m(i,c){G(e,i,c),t=!0},p(i,[c]){const s={};c&4&&(s.map=i[2]),c&486&&(s.$$scope={dirty:c,ctx:i}),!r&&c&1&&(r=!0,s.trailManagerAPI=i[0],Mr(()=>r=!1)),e.$set(s)},i(i){t||(C(e.$$.fragment,i),t=!0)},o(i){S(e.$$.fragment,i),t=!1},d(i){Y(e,i)}}}function Yf(l,e,r){let{map:t}=e,{trailManagerAPI:n}=e,{highlighterAPI:o}=e;function i(s){o=s,r(1,o)}function c(s){n=s,r(0,n)}return l.$$set=s=>{"map"in s&&r(2,t=s.map),"trailManagerAPI"in s&&r(0,n=s.trailManagerAPI),"highlighterAPI"in s&&r(1,o=s.highlighterAPI)},[n,o,t,i,c]}class Xf extends se{constructor(e){super(),ae(this,e,Yf,Gf,ie,{map:2,trailManagerAPI:0,highlighterAPI:1})}}function Dl(l){let e,r;return e=new Xf({props:{map:l[0]}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,n){const o={};n&1&&(o.map=t[0]),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function Zf(l){let e,r,t,n,o;function i(a){l[4](a)}let c={};l[1]!==void 0&&(c.triggerEndTrail=l[1]),e=new Nf({props:c}),He.push(()=>Ir(e,"triggerEndTrail",i));let s=l[2]&&Dl(l);return{c(){W(e.$$.fragment),t=X(),s&&s.c(),n=oe()},l(a){J(e.$$.fragment,a),t=Z(a),s&&s.l(a),n=oe()},m(a,u){G(e,a,u),R(a,t,u),s&&s.m(a,u),R(a,n,u),o=!0},p(a,[u]){const f={};!r&&u&2&&(r=!0,f.triggerEndTrail=a[1],Mr(()=>r=!1)),e.$set(f),a[2]?s?(s.p(a,u),u&4&&C(s,1)):(s=Dl(a),s.c(),C(s,1),s.m(n.parentNode,n)):s&&(he(),S(s,1,1,()=>{s=null}),me())},i(a){o||(C(e.$$.fragment,a),C(s),o=!0)},o(a){S(e.$$.fragment,a),S(s),o=!1},d(a){a&&(w(t),w(n)),Y(e,a),s&&s.d(a)}}}const Jf=5e3;function Kf(l,e,r){let t,n,o,i,c,s,a,u;re(l,$t,z=>r(8,t=z)),re(l,Jl,z=>r(9,n=z)),re(l,on,z=>r(10,o=z)),re(l,at,z=>r(11,i=z)),re(l,Et,z=>r(12,c=z)),re(l,it,z=>r(13,s=z)),re(l,st,z=>r(14,a=z)),re(l,ct,z=>r(15,u=z));let{selectedOperation:f}=e,{map:p}=e,h,b,m=null,g=!1,T={trailingUnsubscribe:null,coordinateBufferUnsubscribe:null,unsavedCoordinatesUnsubscribe:null};async function $(z,F="POST",j={}){var K,te;const ee=Nt(Ot);if(!((K=ee==null?void 0:ee.user)!=null&&K.id)){await Tr();const ce=Nt(Ot);if(!((te=ce==null?void 0:ce.user)!=null&&te.id))throw new Error("Authentication required")}const x=Nt(Ot);return fetch(z,{method:F,headers:{"Content-Type":"application/json",Authorization:`Bearer ${x.access_token}`},body:F!=="GET"?JSON.stringify(j):void 0})}Xe(async()=>{console.log("🚀 TrailSynchronizer: Initializing..."),await Tr(),await O(),await A(),await D(),T.trailingUnsubscribe=(()=>{let z=!0;return sn.subscribe(async F=>{if(z){z=!1;return}console.log("Pressed trailing button",F,"Trailing State:",u),u?u&&(console.log("Triggering end trail"),b()):(console.log("Handling trail creation"),await H())})})(),T.coordinateBufferUnsubscribe=Er.subscribe(z=>{z&&z.coordinates&&u&&k(z)}),T.unsavedCoordinatesUnsubscribe=Et.subscribe(z=>{z.length>0&&!m?_():z.length===0&&m&&v()}),console.log("active trials",s),await I(),await E(),console.log("✅ TrailSynchronizer: Setup completed")}),gt(()=>{console.log("🧹 TrailSynchronizer: Cleaning up resources"),T.trailingUnsubscribe&&T.trailingUnsubscribe(),T.coordinateBufferUnsubscribe&&T.coordinateBufferUnsubscribe(),T.unsavedCoordinatesUnsubscribe&&T.unsavedCoordinatesUnsubscribe(),h&&h.unsubscribe(),v(),ct.set(!1)});async function I(){const z=o.id;console.log("📡 TrailSynchronizer: Subscribing to trail changes of operation",f.id,"and not vehicle:",z),h=Ve.channel("trail_changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"trails",filter:`operation_id=eq.${f.id}`},F).on("postgres_changes",{event:"UPDATE",schema:"public",table:"trails",filter:`operation_id=eq.${f.id}`},j).on("postgres_changes",{event:"DELETE",schema:"public",table:"trails",filter:`operation_id=eq.${f.id}`},ee).subscribe();function F(x){if(!x.new)return;const K=x.new;K.vehicle_id!==z&&(console.log("🆕 New trail detected:",K.id),s!=null&&s.length||it.set([]),it.update((te=[])=>[...te,{id:K.id,vehicle_id:K.vehicle_id,operation_id:K.operation_id,start_time:K.start_time,end_time:K.end_time,task_id:K.task_id,trail_color:K.trail_color,trail_width:K.trail_width,path:[],detailed_path:K.detailed_path}]),console.log("active trails",s))}function j(x){if(console.log("🔄 Trail update detected:",x),!x.new)return;const K=x.new;K.vehicle_id!==z&&(console.log("🔄 Trail update detected:",K.id),s!=null&&s.length||it.set([]),it.update((te=[])=>{const ce=te.findIndex(le=>le.id===K.id);if(ce===-1)return te;const pe=te[ce];console.log("Updating existing trail:",K.id);const Pe={type:"LineString",coordinates:pe.path.map(le=>[le.coordinates.longitude,le.coordinates.latitude])},ve={id:K.id,vehicle_id:K.vehicle_id,operation_id:K.operation_id,start_time:K.start_time,end_time:K.end_time,trail_color:K.trail_color,trail_width:K.trail_width,path:Pe,detailed_path:K.detailed_path};return st.update(le=>[...le,ve]),te.filter(le=>le.id!==K.id)}),console.log("active trails",s))}function ee(x){if(console.log("🗑️ Trail deletion detected:",x),!x.old)return;const K=x.old;console.log(K.vehicle_id===z),K.vehicle_id!==z&&(console.log("🗑️ Trail deletion detected:",K.id),new Date(K.start_time),new Date(K.end_time),fe.info("Trail deleted by another user",{description:`${K.trail_width}m ${K.trail_color.toLowerCase()} trail`}),s!=null&&s.length&&it.update((te=[])=>te.filter(ce=>ce.id!==K.id)),a!=null&&a.length&&a.some(ce=>ce.id===K.id)&&st.update(ce=>ce.filter(pe=>pe.id!==K.id)),console.log("active trails",s))}}async function E(){console.log("📡 TrailSynchronizer: Subscribing to trail streams"),h=Ve.channel("trail_stream_changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"trail_stream",filter:`operation_id=eq.${f.id}`},z=>{if(!z.new)return;const{trail_id:F,coordinate:j,timestamp:ee}=z.new;!(s!=null&&s.length)||!s.some(K=>K.id===F)||it.update(K=>K.map(te=>te.id===F?{...te,path:[...te.path,{coordinates:{latitude:j.coordinates[1],longitude:j.coordinates[0]},timestamp:ee}]}:te))}).subscribe()}function k(z){q(z);const F={coordinates:z.coordinates,timestamp:z.timestamp};Et.update(j=>[...j,F]),Er.set(null)}function _(){m||(console.log("🔄 TrailSynchronizer: Starting periodic sync"),m=setInterval(()=>{d()},Jf))}async function d(){await y()}async function y(){const z=c;if(z.length===0)return;const F=[...z];Et.set([]);try{const j={operation_id:f.id,trail_id:i.id,coordinates_batch:F.map(x=>({coordinates:x.coordinates,timestamp:x.timestamp}))};console.log(`📤 TrailSynchronizer: Sending batch of ${F.length} coordinates`);const ee=await $("/api/map-trails/save-coordinate","POST",j);if(!ee.ok)throw new Error(`HTTP error! status: ${ee.status}`);await ee.json(),console.log(`✅ TrailSynchronizer: Successfully synced ${F.length} coordinates`)}catch(j){console.log("❌ TrailSynchronizer: Failed to sync coordinates:",j),Et.update(ee=>[...F,...ee])}}function v(){m&&(console.log("⏹️ TrailSynchronizer: Stopping periodic sync"),clearInterval(m),m=null)}async function L(z){try{const F=await qr.getOperationTrails(z);if(F.error)throw new Error(F.message||"Failed to fetch operation trails");return F.trails}catch(F){throw F}}async function D(){console.log("📥 TrailSynchronizer: Fetching operation trails"),fe.promise((async()=>{const z=await L(f.id);return st.set([]),st.update(F=>[...F,...z]),r(2,g=!0),console.log(`✅ TrailSynchronizer: Loaded ${z.length} historical trails`),console.log("Operation",f),z})(),{loading:`Loading trails from ${f.name} (${f.year})...`,success:z=>`Loaded ${z.length} trails from ${f.name} (${f.year})`,error:z=>`Failed to fetch trails from ${f.name}: ${z.message}`},{duration:4e3})}async function O(){try{const z=await qr.checkOpenTrails(o.id);if(z.error)throw new Error(z.message||"Failed to check for open trails");const{openTrail:F,trailData:j}=z;if(console.log("Opentrail",F,"data",j),F){console.log("🔄 TrailSynchronizer: Found existing open trail"),at.set({...F,start_time:F.start_time,trail_color:F.trail_color,trail_width:F.trail_width,path:j||[]}),ct.set(!0);const ee=new Date(F.start_time),x=Math.round((Date.now()-ee.getTime())/(1e3*60));fe.info(`Found existing ${F.trail_width}m ${F.trail_color.toLowerCase()} trail`,{description:`Started ${x} minutes ago. Trailing will continue automatically.`,duration:5e3})}}catch(z){console.error("❌ TrailSynchronizer: Failed to check open trails:",z),fe.error("Failed to check for open trails")}}async function A(){const z=fe.promise((async()=>{console.log("Getting other active trails... from operation:",f.id,"and profile:",o.id);const F=await qr.checkOtherActiveTrails(f.id,o.id);if(F.error)throw new Error(F.message||"Failed to check for other active trails");F.errors&&F.errors.forEach(ee=>{fe.error(ee,{duration:6e3})});const{activeTrails:j}=F;if(j&&j.length>0){console.log(`📍 TrailSynchronizer: Found ${j.length} other active trails`,j);const ee=j.map(te=>({id:te.id,vehicle_id:te.vehicle_id,operation_id:te.operation_id,task_id:te.task_id||null,start_time:te.start_time,end_time:te.end_time,trail_color:te.trail_color,trail_width:te.trail_width,path:te.trailData||[],detailed_path:null})),x=(n==null?void 0:n.connected_profiles)||[],K=j.map(te=>{const ce=x.find(pe=>pe.id===te.vehicle_id);return ce?ce.full_name:null}).filter(te=>te!==null);return it.set(ee),K.length>0?`Active trails from: ${K.join(", ")}`:`Found ${j.length} active ${j.length===1?"trail":"trails"} from unknown vehicles`}else return it.set([]),"No active trails found"})(),{loading:"Checking for active trails...",success:F=>F,error:F=>F instanceof Error?F.message:"Failed to check for other active trails"},{duration:6e3});try{await z}catch(F){console.error("❌ TrailSynchronizer: Failed to check other active trails:",F)}}async function H(){const z=t.vehicle_id;try{await U(z)}catch(F){console.error("❌ TrailSynchronizer: Error creating trail:",F),fe.error(`Error creating trail: ${F.message}`)}}async function U(z){console.log("🆕 TrailSynchronizer: Creating new trail");const F=await $("/api/map-trails/open-new-trail","POST",{vehicle_id:z,operation_id:f.id,vehicle_info:t}),j=await F.json();if(!F.ok)throw new Error(j.error||"Failed to create trail");console.log("✅ TrailSynchronizer: New trail created successfully"),fe.success("New trail created successfully"),at.set({...j.trail,start_time:j.trail.start_time,trail_color:j.trail.trail_color,trail_width:j.trail.trail_width,path:[]}),ct.set(!0)}function q(z){at.update(F=>{if(F){const j=[...F.path||[],z];return{...F,path:j}}return F})}function ne(z){b=z,r(1,b)}return l.$$set=z=>{"selectedOperation"in z&&r(3,f=z.selectedOperation),"map"in z&&r(0,p=z.map)},[p,b,g,f,ne]}class Qf extends se{constructor(e){super(),ae(this,e,Kf,Zf,ie,{selectedOperation:3,map:0})}}function Ol(l){let e,r,t,n='<svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg>',o,i,c,s,a,u,f="Measured Area",p,h,b,m;s=new $i({props:{class:"h-3.5 w-3.5"}});function g(I,E){return I[2]?I[3]?xf:ed:td}let T=g(l),$=T(l);return{c(){e=N("div"),r=N("div"),t=N("button"),t.innerHTML=n,o=X(),i=N("div"),c=N("div"),W(s.$$.fragment),a=X(),u=N("span"),u.textContent=f,p=X(),$.c(),this.h()},l(I){e=V(I,"DIV",{class:!0});var E=B(e);r=V(E,"DIV",{class:!0});var k=B(r);t=V(k,"BUTTON",{class:!0,"data-svelte-h":!0}),$e(t)!=="svelte-lmi83i"&&(t.innerHTML=n),o=Z(k),i=V(k,"DIV",{class:!0});var _=B(i);c=V(_,"DIV",{class:!0});var d=B(c);J(s.$$.fragment,d),a=Z(d),u=V(d,"SPAN",{"data-svelte-h":!0}),$e(u)!=="svelte-464exh"&&(u.textContent=f),d.forEach(w),p=Z(_),$.l(_),_.forEach(w),k.forEach(w),E.forEach(w),this.h()},h(){P(t,"class","absolute -right-2 -top-2 flex h-5 w-5 items-center justify-center rounded-full border border-gray-200 bg-white text-gray-500 hover:bg-gray-50"),P(c,"class","flex items-center gap-1.5 text-[11px] font-medium uppercase tracking-wider text-gray-600"),P(i,"class","flex flex-col items-center gap-2"),P(r,"class","relative min-w-[180px] rounded-lg border border-gray-200 bg-white/90 p-3 backdrop-blur-sm"),P(e,"class","absolute left-1/2 top-3 z-10 -translate-x-1/2 transform")},m(I,E){R(I,e,E),M(e,r),M(r,t),M(r,o),M(r,i),M(i,c),G(s,c,null),M(c,a),M(c,u),M(i,p),$.m(i,null),h=!0,b||(m=Me(t,"click",l[6]),b=!0)},p(I,E){T===(T=g(I))&&$?$.p(I,E):($.d(1),$=T(I),$&&($.c(),$.m(i,null)))},i(I){h||(C(s.$$.fragment,I),h=!0)},o(I){S(s.$$.fragment,I),h=!1},d(I){I&&w(e),Y(s),$.d(),b=!1,m()}}}function xf(l){let e,r,t=l[1].hectares+"",n,o,i,c="ha",s,a,u=l[1].squareMeters.toLocaleString()+"",f,p;return{c(){e=N("div"),r=N("div"),n=_e(t),o=X(),i=N("span"),i.textContent=c,s=X(),a=N("div"),f=_e(u),p=_e(" m²"),this.h()},l(h){e=V(h,"DIV",{class:!0});var b=B(e);r=V(b,"DIV",{class:!0});var m=B(r);n=be(m,t),o=Z(m),i=V(m,"SPAN",{class:!0,"data-svelte-h":!0}),$e(i)!=="svelte-1c7zf12"&&(i.textContent=c),m.forEach(w),s=Z(b),a=V(b,"DIV",{class:!0});var g=B(a);f=be(g,u),p=be(g," m²"),g.forEach(w),b.forEach(w),this.h()},h(){P(i,"class","text-xs font-normal"),P(r,"class","flex items-baseline gap-1 text-2xl font-bold text-gray-800"),P(a,"class","text-xs text-gray-500"),P(e,"class","flex flex-col items-center")},m(h,b){R(h,e,b),M(e,r),M(r,n),M(r,o),M(r,i),M(e,s),M(e,a),M(a,f),M(a,p)},p(h,b){b&2&&t!==(t=h[1].hectares+"")&&Fe(n,t),b&2&&u!==(u=h[1].squareMeters.toLocaleString()+"")&&Fe(f,u)},d(h){h&&w(e)}}}function ed(l){let e,r="Complete the shape";return{c(){e=N("div"),e.textContent=r,this.h()},l(t){e=V(t,"DIV",{class:!0,"data-svelte-h":!0}),$e(e)!=="svelte-1298jjy"&&(e.textContent=r),this.h()},h(){P(e,"class","text-sm text-gray-600")},m(t,n){R(t,e,n)},p:de,d(t){t&&w(e)}}}function td(l){let e,r="Click to start measuring";return{c(){e=N("div"),e.textContent=r,this.h()},l(t){e=V(t,"DIV",{class:!0,"data-svelte-h":!0}),$e(e)!=="svelte-116r9bz"&&(e.textContent=r),this.h()},h(){P(e,"class","text-sm text-gray-600")},m(t,n){R(t,e,n)},p:de,d(t){t&&w(e)}}}function rd(l){let e,r,t=l[0]&&Ol(l);return{c(){t&&t.c(),e=oe()},l(n){t&&t.l(n),e=oe()},m(n,o){t&&t.m(n,o),R(n,e,o),r=!0},p(n,[o]){n[0]?t?(t.p(n,o),o&1&&C(t,1)):(t=Ol(n),t.c(),C(t,1),t.m(e.parentNode,e)):t&&(he(),S(t,1,1,()=>{t=null}),me())},i(n){r||(C(t),r=!0)},o(n){S(t),r=!1},d(n){n&&w(e),t&&t.d(n)}}}function nd(l){return{squareMeters:Math.round(l),hectares:Math.round(l/1e4*100)/100}}function ld(l,e,r){let t;re(l,Yt,p=>r(0,t=p));let{map:n}=e,o,i={hectares:0,squareMeters:0},c=!1,s=!1;const a={create:()=>u(),delete:()=>u(),update:()=>u()};Xe(()=>{r(5,o=new bo({displayControlsDefault:!1,controls:{},defaultMode:"draw_polygon",clickBuffer:6,touchBuffer:6,snapToFinish:!0,finishDrawingOnSnapToFinish:!0,touchEnabled:!0,boxSelect:!1,translateEnabled:!1,rotateEnabled:!1,styles:[{id:"gl-draw-polygon-fill-active",type:"fill",filter:["all",["==","active","true"],["==","$type","Polygon"]],paint:{"fill-color":"#0ea5e9","fill-opacity":.25}},{id:"gl-draw-polygon-fill-inactive",type:"fill",filter:["all",["==","active","false"],["==","$type","Polygon"]],paint:{"fill-color":"#0ea5e9","fill-opacity":.4}},{id:"gl-draw-polygon-stroke-active",type:"line",filter:["all",["==","active","true"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#0ea5e9","line-width":2,"line-dasharray":[2,2]}},{id:"gl-draw-polygon-stroke-inactive",type:"line",filter:["all",["==","active","false"],["==","$type","Polygon"]],layout:{"line-cap":"round","line-join":"round"},paint:{"line-color":"#0ea5e9","line-width":3}},{id:"gl-draw-polygon-and-line-vertex-active",type:"circle",filter:["all",["==","meta","vertex"],["==","$type","Point"]],paint:{"circle-radius":6,"circle-color":"#fff","circle-stroke-color":"#0ea5e9","circle-stroke-width":2}},{id:"gl-draw-polygon-and-line-midpoint-active",type:"circle",filter:["all",["==","meta","midpoint"],["==","$type","Point"]],paint:{"circle-radius":4,"circle-color":"#0ea5e9","circle-stroke-color":"#fff","circle-stroke-width":2}}]})),n.addControl(o),n.on("draw.create",a.create),n.on("draw.delete",a.delete),n.on("draw.update",a.update)});function u(){if(!o)return;const p=o.getAll();p.features.length>0?(r(1,i=nd(No(p))),r(2,c=!0),r(3,s=!0)):(r(2,c=!1),r(3,s=!1),r(1,i={hectares:0,squareMeters:0}))}const f=()=>Bl(Yt,t=!1,t);return l.$$set=p=>{"map"in p&&r(4,n=p.map)},l.$$.update=()=>{l.$$.dirty&33&&o&&t!==void 0&&(t?o.changeMode("draw_polygon"):(o.deleteAll(),o.changeMode("simple_select"),r(2,c=!1),r(3,s=!1)))},[t,i,c,s,n,o,f]}class od extends se{constructor(e){super(),ae(this,e,ld,rd,ie,{map:4})}}function id(l){let e,r=null,t=0,n=null;const{getMap:o}=Xt("map");class i extends Ke.NavigationControl{constructor(s){super(s),this._trackingEnabled=!1}onAdd(s){const a=super.onAdd(s),u=a.querySelector(".mapboxgl-ctrl-compass");return u&&u.addEventListener("click",f=>{f.preventDefault(),f.stopPropagation(),this._handleCompassClick(s)}),a}_handleCompassClick(s){n&&clearTimeout(n),t++,n=setTimeout(()=>{t=0},500),t===1?(s.resetNorth(),this._trackingEnabled&&this._disableTracking()):t===2&&(t=0,this._toggleTracking(s))}_toggleTracking(s){this._trackingEnabled=!this._trackingEnabled;const a=document.querySelector(".mapboxgl-ctrl-compass");this._trackingEnabled&&navigator.geolocation?(r=navigator.geolocation.watchPosition(u=>{s.easeTo({center:[u.coords.longitude,u.coords.latitude],bearing:u.coords.heading||0,duration:1e3})},null,{enableHighAccuracy:!0}),a&&a.classList.add("tracking-active")):this._disableTracking()}_disableTracking(){this._trackingEnabled=!1,r&&(navigator.geolocation.clearWatch(r),r=null);const s=document.querySelector(".mapboxgl-ctrl-compass");s&&s.classList.remove("tracking-active")}}return Xe(async()=>{try{e=await o();const c=new i({showZoom:!1,showCompass:!0,visualizePitch:!0});e.addControl(c,"bottom-right")}catch(c){console.warn("Map initialization error:",c)}}),[]}class sd extends se{constructor(e){super(),ae(this,e,id,null,ie,{})}}function Nl(l){let e,r,t,n,o,i,c,s,a,u,f,p,h,b,m,g,T,$,I,E;e=new cu({}),e.$on("toggleMapStyleDispatcher",l[11]),e.$on("backToDashboard",function(){go(l[0])&&l[0].apply(this,arguments)}),e.$on("locateHome",l[12]),t=new sd({}),o=new uc({props:{markerPlacementEvent:l[7],markerClickEvent:l[8]}}),c=new Wu({props:{map:l[4]}});let k={map:l[4]};a=new hu({props:k}),l[13](a),a.$on("markerPlacement",l[9]),a.$on("markerClick",l[10]),f=new nf({}),h=new ef({props:{map:l[4],disableAutoZoom:l[1]}}),m=new Mf({props:{map:l[4]}}),T=new od({props:{map:l[4]}});let _=l[2]&&Vl(l);return{c(){W(e.$$.fragment),r=X(),W(t.$$.fragment),n=X(),W(o.$$.fragment),i=X(),W(c.$$.fragment),s=X(),W(a.$$.fragment),u=X(),W(f.$$.fragment),p=X(),W(h.$$.fragment),b=X(),W(m.$$.fragment),g=X(),W(T.$$.fragment),$=X(),_&&_.c(),I=oe()},l(d){J(e.$$.fragment,d),r=Z(d),J(t.$$.fragment,d),n=Z(d),J(o.$$.fragment,d),i=Z(d),J(c.$$.fragment,d),s=Z(d),J(a.$$.fragment,d),u=Z(d),J(f.$$.fragment,d),p=Z(d),J(h.$$.fragment,d),b=Z(d),J(m.$$.fragment,d),g=Z(d),J(T.$$.fragment,d),$=Z(d),_&&_.l(d),I=oe()},m(d,y){G(e,d,y),R(d,r,y),G(t,d,y),R(d,n,y),G(o,d,y),R(d,i,y),G(c,d,y),R(d,s,y),G(a,d,y),R(d,u,y),G(f,d,y),R(d,p,y),G(h,d,y),R(d,b,y),G(m,d,y),R(d,g,y),G(T,d,y),R(d,$,y),_&&_.m(d,y),R(d,I,y),E=!0},p(d,y){l=d;const v={};y&128&&(v.markerPlacementEvent=l[7]),y&256&&(v.markerClickEvent=l[8]),o.$set(v);const L={};y&16&&(L.map=l[4]),c.$set(L);const D={};y&16&&(D.map=l[4]),a.$set(D);const O={};y&16&&(O.map=l[4]),y&2&&(O.disableAutoZoom=l[1]),h.$set(O);const A={};y&16&&(A.map=l[4]),m.$set(A);const H={};y&16&&(H.map=l[4]),T.$set(H),l[2]?_?(_.p(l,y),y&4&&C(_,1)):(_=Vl(l),_.c(),C(_,1),_.m(I.parentNode,I)):_&&(he(),S(_,1,1,()=>{_=null}),me())},i(d){E||(C(e.$$.fragment,d),C(t.$$.fragment,d),C(o.$$.fragment,d),C(c.$$.fragment,d),C(a.$$.fragment,d),C(f.$$.fragment,d),C(h.$$.fragment,d),C(m.$$.fragment,d),C(T.$$.fragment,d),C(_),E=!0)},o(d){S(e.$$.fragment,d),S(t.$$.fragment,d),S(o.$$.fragment,d),S(c.$$.fragment,d),S(a.$$.fragment,d),S(f.$$.fragment,d),S(h.$$.fragment,d),S(m.$$.fragment,d),S(T.$$.fragment,d),S(_),E=!1},d(d){d&&(w(r),w(n),w(i),w(s),w(u),w(p),w(b),w(g),w($),w(I)),Y(e,d),Y(t,d),Y(o,d),Y(c,d),l[13](null),Y(a,d),Y(f,d),Y(h,d),Y(m,d),Y(T,d),_&&_.d(d)}}}function Vl(l){let e,r;return e=new Qf({props:{selectedOperation:l[2],map:l[4]}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,n){const o={};n&4&&(o.selectedOperation=t[2]),n&16&&(o.map=t[4]),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function ad(l){let e,r,t=l[6]&&Nl(l);return{c(){e=N("div"),t&&t.c(),this.h()},l(n){e=V(n,"DIV",{class:!0});var o=B(e);t&&t.l(o),o.forEach(w),this.h()},h(){P(e,"class","map-container svelte-1s99y2r")},m(n,o){R(n,e,o),t&&t.m(e,null),l[14](e),r=!0},p(n,[o]){n[6]?t?(t.p(n,o),o&64&&C(t,1)):(t=Nl(n),t.c(),C(t,1),t.m(e,null)):t&&(he(),S(t,1,1,()=>{t=null}),me())},i(n){r||(C(t),r=!0)},o(n){S(t),r=!1},d(n){n&&w(e),t&&t.d(),l[14](null)}}}const cd="pk.eyJ1IjoibHVjaG9kb3JlIiwiYSI6ImNsdndpd2NvNjA5OWUybG14anc1aWJpbXMifQ.7DSbOP9x-3sTZdJ5ee4UKw",Wr="mapbox://styles/mapbox/satellite-streets-v12",ud="mapbox://styles/mapbox/outdoors-v12";function fd(l,e,r){let t,n;re(l,Qr,v=>r(21,t=v)),re(l,oo,v=>r(22,n=v));let{handleBackToDashboard:o}=e,{initialLocation:i}=e,{selectedOperation:c}=e,s,a=!0,u=Wr,f,p,h,b=!1;$r("map",{getMap:()=>Promise.resolve(p)});const m={container:null,style:Wr,center:[90,-40],zoom:2};function g(){if(i&&Array.isArray(i))if(i.length===4){const v=[[i[0],i[1]],[i[2],i[3]]];p.fitBounds(v,{padding:50,maxZoom:15})}else i.length===2&&p.flyTo({center:i,zoom:15,duration:4e3})}Xe(async()=>{console.log("Selected operation on mount!",c),Ke.accessToken=cd,m.container=f,r(4,p=new Ke.Map(m)),p.setMaxPitch(0),p.setMinPitch(0),Yn.set(p),r(6,b=!0),p.loaded()?g():p.on("load",()=>{g()});try{await mn.open(),s=mn}catch(v){console.error("Error opening IndexedDB database:",v)}}),gt(()=>{p&&(p.off(),p.remove(),r(4,p=null),Yn.set(null)),h&&h.$destroy()});let T=null,$=null;function I(v){r(7,T=v.detail)}function E(v){r(8,$=v.detail)}function k(){a?u=ud:u=Wr,p.setStyle(u),p.once("load",()=>{g()}),a=!a}function _(){n?p.fitBounds(n,{padding:50,maxZoom:15}):t?p.fitBounds(t,{padding:50,maxZoom:15}):fe.error("Please place markers or upload field boundaries to set a home location",{duration:4e3})}function d(v){He[v?"unshift":"push"](()=>{h=v,r(5,h)})}function y(v){He[v?"unshift":"push"](()=>{f=v,r(3,f)})}return l.$$set=v=>{"handleBackToDashboard"in v&&r(0,o=v.handleBackToDashboard),"initialLocation"in v&&r(1,i=v.initialLocation),"selectedOperation"in v&&r(2,c=v.selectedOperation)},[o,i,c,f,p,h,b,T,$,I,E,k,_,d,y]}class dd extends se{constructor(e){super(),ae(this,e,fd,ad,ie,{handleBackToDashboard:0,initialLocation:1,selectedOperation:2})}}function hd(l){let e,r,t,n;const o=[pd,gd,md],i=[];function c(s,a){return s[0]?0:s[1]?1:2}return e=c(l),r=i[e]=o[e](l),{c(){r.c(),t=oe()},l(s){r.l(s),t=oe()},m(s,a){i[e].m(s,a),R(s,t,a),n=!0},p(s,a){let u=e;e=c(s),e===u?i[e].p(s,a):(he(),S(i[u],1,1,()=>{i[u]=null}),me(),r=i[e],r?r.p(s,a):(r=i[e]=o[e](s),r.c()),C(r,1),r.m(t.parentNode,t))},i(s){n||(C(r),n=!0)},o(s){S(r),n=!1},d(s){s&&w(t),i[e].d(s)}}}function md(l){let e,r=l[3],t,n=zl(l);return{c(){e=N("div"),n.c(),this.h()},l(o){e=V(o,"DIV",{class:!0});var i=B(e);n.l(i),i.forEach(w),this.h()},h(){P(e,"class","fixed left-0 top-0 h-full w-full overflow-hidden")},m(o,i){R(o,e,i),n.m(e,null),t=!0},p(o,i){i&8&&ie(r,r=o[3])?(he(),S(n,1,1,de),me(),n=zl(o),n.c(),C(n,1),n.m(e,null)):n.p(o,i)},i(o){t||(C(n),t=!0)},o(o){S(n),t=!1},d(o){o&&w(e),n.d(o)}}}function gd(l){let e,r,t,n="Error Loading Map",o,i,c,s,a,u,f="Try Again",p,h,b="Back to Dashboard",m,g;return{c(){e=N("div"),r=N("div"),t=N("h2"),t.textContent=n,o=X(),i=N("p"),c=_e(l[1]),s=X(),a=N("div"),u=N("button"),u.textContent=f,p=X(),h=N("button"),h.textContent=b,this.h()},l(T){e=V(T,"DIV",{class:!0});var $=B(e);r=V($,"DIV",{class:!0});var I=B(r);t=V(I,"H2",{class:!0,"data-svelte-h":!0}),$e(t)!=="svelte-3pt6ml"&&(t.textContent=n),o=Z(I),i=V(I,"P",{class:!0});var E=B(i);c=be(E,l[1]),E.forEach(w),s=Z(I),a=V(I,"DIV",{class:!0});var k=B(a);u=V(k,"BUTTON",{class:!0,"data-svelte-h":!0}),$e(u)!=="svelte-9gqfuk"&&(u.textContent=f),p=Z(k),h=V(k,"BUTTON",{class:!0,"data-svelte-h":!0}),$e(h)!=="svelte-jngz7b"&&(h.textContent=b),k.forEach(w),I.forEach(w),$.forEach(w),this.h()},h(){P(t,"class","text-2xl font-bold text-red-700"),P(i,"class","mt-2 text-red-600"),P(u,"class","rounded bg-primary px-4 py-2 text-white"),P(h,"class","rounded border border-gray-300 bg-white px-4 py-2 text-gray-700"),P(a,"class","mt-6 flex justify-center space-x-4"),P(r,"class","max-w-md rounded-lg bg-red-50 p-6 text-center shadow-lg"),P(e,"class","fixed left-0 top-0 flex h-full w-full items-center justify-center")},m(T,$){R(T,e,$),M(e,r),M(r,t),M(r,o),M(r,i),M(i,c),M(r,s),M(r,a),M(a,u),M(a,p),M(a,h),m||(g=[Me(u,"click",l[7]),Me(h,"click",l[4])],m=!0)},p(T,$){$&2&&Fe(c,T[1])},i:de,o:de,d(T){T&&w(e),m=!1,vt(g)}}}function pd(l){let e,r='<div class="flex flex-col items-center"><div class="h-16 w-16 animate-spin rounded-full border-4 border-primary border-t-transparent"></div> <p class="mt-4 text-xl font-medium">Loading map data...</p></div>';return{c(){e=N("div"),e.innerHTML=r,this.h()},l(t){e=V(t,"DIV",{class:!0,"data-svelte-h":!0}),$e(e)!=="svelte-18ukp73"&&(e.innerHTML=r),this.h()},h(){P(e,"class","fixed left-0 top-0 flex h-full w-full items-center justify-center")},m(t,n){R(t,e,n)},p:de,i:de,o:de,d(t){t&&w(e)}}}function zl(l){let e,r;return e=new dd({props:{handleBackToDashboard:l[4],initialLocation:l[2],selectedOperation:l[3]}}),{c(){W(e.$$.fragment)},l(t){J(e.$$.fragment,t)},m(t,n){G(e,t,n),r=!0},p(t,n){const o={};n&4&&(o.initialLocation=t[2]),n&8&&(o.selectedOperation=t[3]),e.$set(o)},i(t){r||(C(e.$$.fragment,t),r=!0)},o(t){S(e.$$.fragment,t),r=!1},d(t){Y(e,t)}}}function _d(l){let e,r,t=hd(l);return{c(){t&&t.c(),e=oe()},l(n){t&&t.l(n),e=oe()},m(n,o){t&&t.m(n,o),R(n,e,o),r=!0},p(n,[o]){t.p(n,o)},i(n){r||(C(t),r=!0)},o(n){S(t),r=!1},d(n){n&&w(e),t&&t.d(n)}}}function bd(l,e,r){let t,n;re(l,Ot,_=>r(6,t=_)),re(l,bn,_=>r(11,n=_));let{data:o}=e,i=!0,c=null,s=[],a=null,u=null;console.log("1. MapViewer Page Load - Initial data:",o),Xt("adminSection").set("mapviewer");let p=null;console.log("2. Current selectedOperationStore value:",n);let h=n;console.log("3. Local selectedOperation variable set to:",h),bn.subscribe(_=>{console.log("4. selectedOperationStore changed to:",_),r(3,h=_),console.log("5. Local selectedOperation updated to:",h)});function b(){return/Android/.test(navigator.userAgent)}async function m(){if(b()&&"wakeLock"in navigator)try{p=await navigator.wakeLock.request("screen")}catch(_){_.name!=="NotAllowedError"&&fe.error(`Couldn't keep screen awake: ${_.message}`)}}function g(){p&&p.release().then(()=>{p=null}).catch(_=>{console.error(`Error releasing wake lock: ${_.message}`)})}async function T(){var _;try{if(console.log("Attempting to fetch fields using fileApi..."),!((_=t==null?void 0:t.user)!=null&&_.id))throw console.error("No authenticated user"),new Error("Authentication required");const d=await Lo.loadFields();if(d.error)throw console.error("Fields API error:",d.error),new Error(`Failed to fetch fields: ${d.error}`);return s=d.fields||[],Jr.set(s),console.log("Fields loaded successfully:",s),s}catch(d){throw console.error("Error loading fields:",d),r(1,c=d.message||"Failed to load fields"),fe.error("Failed to load field data"),d}}async function $(){if(!o.type||!o.id)return null;try{if(!(t!=null&&t.access_token))return console.error("No access token available"),null;const _=t.access_token;console.log("Using token for location API:",_.substring(0,5)+"...");const d=await fetch(`/api/location?type=${o.type}&id=${o.id}`,{headers:{Authorization:`Bearer ${_}`}});if(!d.ok){const v=await d.text();throw console.error("Location API error:",d.status,v),new Error(`Failed to fetch location: ${d.status}`)}return a=(await d.json()).location,r(2,u=a),console.log(`Fetched ${o.type} location:`,a),a}catch(_){return console.error(`Error fetching ${o.type} location:`,_),fe.error(`Failed to load ${o.type} location`),null}}Xe(async()=>{var _;console.log("6. MapViewer Page Mount - selectedOperation:",h),console.log("7. MapViewer Page Mount - store value:",n);{if(t)console.log("Session available on mount:",{userId:(_=t.user)==null?void 0:_.id,hasToken:!!t.access_token});else{console.log("No session on mount, redirecting to login"),Nr("/login");return}r(0,i=!0);try{await T(),await $(),r(0,i=!1)}catch(d){console.error("Error loading map data:",d),r(0,i=!1)}m(),document.addEventListener("visibilitychange",I)}}),gt(()=>{g(),document.removeEventListener("visibilitychange",I)});function I(){document.visibilityState==="visible"?m():g()}function E(){g(),Nr("/account")}const k=()=>window.location.reload();return l.$$set=_=>{"data"in _&&r(5,o=_.data)},l.$$.update=()=>{var _;l.$$.dirty&64&&(t?console.log("Session found:",(_=t.user)==null?void 0:_.email):(console.log("No session found, redirecting to login"),Nr("/login")))},[i,c,u,h,E,o,t,k]}class hh extends se{constructor(e){super(),ae(this,e,bd,_d,ie,{data:5})}}export{hh as component,dh as universal};

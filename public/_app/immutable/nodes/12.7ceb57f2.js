import{_ as Ce}from"../chunks/preload-helper.a4192956.js";import{r as le,e as Be}from"../chunks/index.3feb4388.js";import{u as me,C as Le,I as Re}from"../chunks/input.a3371209.js";import{c as Ie}from"../chunks/connectedMapStore.4c0c71f1.js";import{s as Me}from"../chunks/sessionStore.4d48270f.js";import{P as de,s as re,r as G,O as ee,l as q,v as ze,a as A,e as N,f as D,c as V,g as ie,i as b,j as v,n as K,d as _,E as _e,F as pe,b as H,k as B,z as Ee,A as Se,a3 as Ae,G as Xe,t as W,h as x,w as Z,_ as L,q as Je}from"../chunks/scheduler.78aa6f0d.js";import{S as se,i as ae,c as P,a as y,m as j,t as h,b as $,d as C,h as De,g as ce,e as ue}from"../chunks/index.9a12d9f3.js";import{e as te,u as Ye,o as Ge}from"../chunks/each.13a24068.js";import{g as qe}from"../chunks/navigation.dd464073.js";import{C as Ne}from"../chunks/card.07545186.js";import{C as Ke,a as Ze,b as Qe}from"../chunks/card-title.64894721.js";import{g as Ve,C as Ue,a as We,b as xe}from"../chunks/carousel-item.6a4ab7e7.js";import{g as Fe,a as He}from"../chunks/spread.8a54911c.js";import{A as et}from"../chunks/arrow-left.1ead8ef1.js";import{c as ne}from"../chunks/utils.b7c75443.js";import"../chunks/index.c6cad0ee.js";import{B as Q}from"../chunks/button.24e75470.js";import{A as tt}from"../chunks/arrow-right.7d2fd3d3.js";import{t as ge,p as he}from"../chunks/index.0ffb7a2a.js";import{t as $e}from"../chunks/Toaster.svelte_svelte_type_style_lang.006f4a9b.js";import{I as nt}from"../chunks/info.38c5bc92.js";import{X as Te}from"../chunks/x.eeac2894.js";import{C as Oe}from"../chunks/check.de10068b.js";const rt=async(a,e)=>{{const{toast:t}=await Ce(()=>import("../chunks/index.fe2e106b.js"),["..\\chunks\\index.fe2e106b.js","..\\chunks\\Toaster.61985541.js","..\\chunks\\scheduler.78aa6f0d.js","..\\chunks\\index.9a12d9f3.js","..\\chunks\\globals.7f7f1b26.js","..\\chunks\\each.13a24068.js","..\\chunks\\spread.8a54911c.js","..\\chunks\\Toaster.svelte_svelte_type_style_lang.006f4a9b.js","..\\chunks\\index.75457b94.js","..\\assets\\Toaster.77cf5b64.css"],import.meta.url);return new Promise((n,s)=>{t.promise(a,{loading:`Processing ${e}...`,success:r=>(setTimeout(()=>n(r),500),`${e} processed: ${r.message}`),error:r=>(setTimeout(()=>s(r),500),`Error processing ${e}: ${r.message}`)})})}},we=async a=>{{const{toast:e}=await Ce(()=>import("../chunks/index.fe2e106b.js"),["..\\chunks\\index.fe2e106b.js","..\\chunks\\Toaster.61985541.js","..\\chunks\\scheduler.78aa6f0d.js","..\\chunks\\index.9a12d9f3.js","..\\chunks\\globals.7f7f1b26.js","..\\chunks\\each.13a24068.js","..\\chunks\\spread.8a54911c.js","..\\chunks\\Toaster.svelte_svelte_type_style_lang.006f4a9b.js","..\\chunks\\index.75457b94.js","..\\assets\\Toaster.77cf5b64.css"],import.meta.url);e.error(a,{duration:5e3,position:"top-center"})}},st=async({url:a,fetch:e})=>{var o;const t=de(Ie);if(!t.is_connected||!t.id)throw await we("Please connect to a map before processing files."),le(303,"/account/fieldview/");const n=a.searchParams.get("fileName"),s=a.searchParams.get("fileId");if(!n||!s)throw Be(400,"Missing file information");const r=de(Me);if(!((o=r==null?void 0:r.user)!=null&&o.id))throw await we("Please log in to process files."),le(303,"/login");const l=async()=>{const i=await e("/api/files/process",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${r.access_token}`},body:JSON.stringify({fileName:n})}),f=await i.json();if(!i.ok)throw new Error(f.message||"Failed to process file");return f};try{const i=await rt(l(),n);return me.update(f=>f.map(p=>p.id===s?{...p,message:i.message,status:"Processed"}:p)),{processedData:i,fileName:n,fileId:s}}catch(i){throw me.update(f=>f.map(p=>p.id===s?{...p,message:i.message,status:"Failed"}:p)),le(303,"/account/fieldview/")}},on=Object.freeze(Object.defineProperty({__proto__:null,load:st},Symbol.toStringTag,{value:"Module"}));function at(a){let e,t,n,s="Previous slide",r;return e=new et({props:{class:"h-4 w-4"}}),{c(){P(e.$$.fragment),t=A(),n=N("span"),n.textContent=s,this.h()},l(l){y(e.$$.fragment,l),t=D(l),n=V(l,"SPAN",{class:!0,"data-svelte-h":!0}),ie(n)!=="svelte-1tx67gn"&&(n.textContent=s),this.h()},h(){b(n,"class","sr-only")},m(l,o){j(e,l,o),v(l,t,o),v(l,n,o),r=!0},p:K,i(l){r||(h(e.$$.fragment,l),r=!0)},o(l){$(e.$$.fragment,l),r=!1},d(l){l&&(_(t),_(n)),C(e,l)}}}function ot(a){let e,t;const n=[{variant:a[1]},{size:a[2]},{class:ne("absolute h-8 w-8 touch-manipulation rounded-full",a[3]==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",a[0])},{disabled:!a[4]},a[9]];let s={$$slots:{default:[at]},$$scope:{ctx:a}};for(let r=0;r<n.length;r+=1)s=G(s,n[r]);return e=new Q({props:s}),e.$on("click",a[7]),e.$on("keydown",a[8]),{c(){P(e.$$.fragment)},l(r){y(e.$$.fragment,r)},m(r,l){j(e,r,l),t=!0},p(r,[l]){const o=l&543?Fe(n,[l&2&&{variant:r[1]},l&4&&{size:r[2]},l&9&&{class:ne("absolute h-8 w-8 touch-manipulation rounded-full",r[3]==="horizontal"?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",r[0])},l&16&&{disabled:!r[4]},l&512&&He(r[9])]):{};l&1024&&(o.$$scope={dirty:l,ctx:r}),e.$set(o)},i(r){t||(h(e.$$.fragment,r),t=!0)},o(r){$(e.$$.fragment,r),t=!1},d(r){C(e,r)}}}function lt(a,e,t){const n=["class","variant","size"];let s=ee(e,n),r,l,{class:o=void 0}=e,{variant:i="outline"}=e,{size:f="icon"}=e;const{orientation:p,canScrollPrev:c,scrollPrev:u,handleKeyDown:d}=Ve("<Carousel.Previous/>");return q(a,p,m=>t(3,r=m)),q(a,c,m=>t(4,l=m)),a.$$set=m=>{e=G(G({},e),ze(m)),t(9,s=ee(e,n)),"class"in m&&t(0,o=m.class),"variant"in m&&t(1,i=m.variant),"size"in m&&t(2,f=m.size)},[o,i,f,r,l,p,c,u,d,s]}class it extends se{constructor(e){super(),ae(this,e,lt,ot,re,{class:0,variant:1,size:2})}}function ct(a){let e,t,n,s="Next slide",r;return e=new tt({props:{class:"h-4 w-4"}}),{c(){P(e.$$.fragment),t=A(),n=N("span"),n.textContent=s,this.h()},l(l){y(e.$$.fragment,l),t=D(l),n=V(l,"SPAN",{class:!0,"data-svelte-h":!0}),ie(n)!=="svelte-vmesmf"&&(n.textContent=s),this.h()},h(){b(n,"class","sr-only")},m(l,o){j(e,l,o),v(l,t,o),v(l,n,o),r=!0},p:K,i(l){r||(h(e.$$.fragment,l),r=!0)},o(l){$(e.$$.fragment,l),r=!1},d(l){l&&(_(t),_(n)),C(e,l)}}}function ut(a){let e,t;const n=[{variant:a[1]},{size:a[2]},{class:ne("absolute h-8 w-8 touch-manipulation rounded-full",a[3]==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",a[0])},{disabled:!a[4]},a[9]];let s={$$slots:{default:[ct]},$$scope:{ctx:a}};for(let r=0;r<n.length;r+=1)s=G(s,n[r]);return e=new Q({props:s}),e.$on("click",a[7]),e.$on("keydown",a[8]),{c(){P(e.$$.fragment)},l(r){y(e.$$.fragment,r)},m(r,l){j(e,r,l),t=!0},p(r,[l]){const o=l&543?Fe(n,[l&2&&{variant:r[1]},l&4&&{size:r[2]},l&9&&{class:ne("absolute h-8 w-8 touch-manipulation rounded-full",r[3]==="horizontal"?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",r[0])},l&16&&{disabled:!r[4]},l&512&&He(r[9])]):{};l&1024&&(o.$$scope={dirty:l,ctx:r}),e.$set(o)},i(r){t||(h(e.$$.fragment,r),t=!0)},o(r){$(e.$$.fragment,r),t=!1},d(r){C(e,r)}}}function ft(a,e,t){const n=["class","variant","size"];let s=ee(e,n),r,l,{class:o=void 0}=e,{variant:i="outline"}=e,{size:f="icon"}=e;const{orientation:p,canScrollNext:c,scrollNext:u,handleKeyDown:d}=Ve("<Carousel.Next/>");return q(a,p,m=>t(3,r=m)),q(a,c,m=>t(4,l=m)),a.$$set=m=>{e=G(G({},e),ze(m)),t(9,s=ee(e,n)),"class"in m&&t(0,o=m.class),"variant"in m&&t(1,i=m.variant),"size"in m&&t(2,f=m.size)},[o,i,f,r,l,p,c,u,d,s]}class mt extends se{constructor(e){super(),ae(this,e,ft,ut,re,{class:0,variant:1,size:2})}}function dt(a){let e,t,n;return{c(){e=_e("svg"),t=_e("path"),this.h()},l(s){e=pe(s,"svg",{width:!0,height:!0,viewBox:!0,xmlns:!0,class:!0});var r=H(e);t=pe(r,"path",{d:!0,fill:!0,stroke:!0,"stroke-width":!0,filter:!0,"fill-rule":!0}),H(t).forEach(_),r.forEach(_),this.h()},h(){b(t,"d",a[2]),b(t,"fill","rgba(34, 197, 94, 0.45)"),b(t,"stroke","#fefbf6"),b(t,"stroke-width","2.5"),b(t,"filter","drop-shadow(0 0 4px rgba(0, 0, 0, 0.5))"),b(t,"fill-rule","evenodd"),b(e,"width",a[0]),b(e,"height",a[1]),b(e,"viewBox",n="0 0 "+a[0]+" "+a[1]),b(e,"xmlns","http://www.w3.org/2000/svg"),b(e,"class","svelte-149zop")},m(s,r){v(s,e,r),B(e,t)},p(s,[r]){r&4&&b(t,"d",s[2]),r&1&&b(e,"width",s[0]),r&2&&b(e,"height",s[1]),r&3&&n!==(n="0 0 "+s[0]+" "+s[1])&&b(e,"viewBox",n)},i:K,o:K,d(s){s&&_(e)}}}function _t(a){return a&&(a.type==="Polygon"||a.type==="MultiPolygon")}function pt(a){let e=1/0,t=1/0,n=-1/0,s=-1/0;return a.forEach(r=>{r.forEach(([l,o])=>{e=Math.min(e,l),t=Math.min(t,o),n=Math.max(n,l),s=Math.max(s,o)})}),[e,t,n,s]}function be(a,e){const t=a[0].map(e),n=a.slice(1).map(s=>s.map(e));return`M${t.map(s=>s.join(",")).join("L")}Z ${n.map(s=>`M${s.map(r=>r.join(",")).join("L")}Z`).join(" ")}`}function gt(a,e,t){let{geojson:n}=e,{width:s=300}=e,{height:r=200}=e,{areaHectares:l=0}=e,o="";function i(u){return u.type==="Polygon"?f(u.coordinates):u.type==="MultiPolygon"?u.coordinates.reduce((d,m)=>d+f(m),0):0}function f(u){const d=u[0],m=u.slice(1),z=ge(he([d]))/1e4,M=m.reduce((R,T)=>R+ge(he([T]))/1e4,0);return z-M}function p(u){const[d,m,z,M]=u,R=s/(z-d),T=r/(M-m),J=Math.min(R,T)*.9,U=(d+z)/2,Y=(m+M)/2;return([g,E])=>[(g-U)*J+s/2,(Y-E)*J+r/2]}function c(u){let d=[];u.type==="Polygon"?d=u.coordinates:u.type==="MultiPolygon"&&(d=u.coordinates.flat());const m=pt(d),z=p(m);return u.type==="Polygon"?be(u.coordinates,z):u.type==="MultiPolygon"?u.coordinates.map(M=>be(M,z)).join(" "):""}return Ee(()=>{_t(n)?(t(2,o=c(n)),t(3,l=i(n))):console.error("Invalid GeoJSON structure")}),a.$$set=u=>{"geojson"in u&&t(4,n=u.geojson),"width"in u&&t(0,s=u.width),"height"in u&&t(1,r=u.height),"areaHectares"in u&&t(3,l=u.areaHectares)},[s,r,o,l,n]}class ht extends se{constructor(e){super(),ae(this,e,gt,dt,re,{geojson:4,width:0,height:1,areaHectares:3})}}function ve(a,e,t){const n=a.slice();return n[19]=e[t],n[21]=t,n}function ke(a,e,t){const n=a.slice();return n[19]=e[t],n[22]=e,n[21]=t,n}function $t(a){let e;return{c(){e=W("Paddock Collection")},l(t){e=x(t,"Paddock Collection")},m(t,n){v(t,e,n)},d(t){t&&_(e)}}}function wt(a){let e,t;return e=new Qe({props:{class:"flex justify-center text-2xl font-bold",$$slots:{default:[$t]},$$scope:{ctx:a}}}),{c(){P(e.$$.fragment)},l(n){y(e.$$.fragment,n)},m(n,s){j(e,n,s),t=!0},p(n,s){const r={};s&8388608&&(r.$$scope={dirty:s,ctx:n}),e.$set(r)},i(n){t||(h(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){C(e,n)}}}function bt(a){let e,t;return e=new Oe({props:{class:"inline-block h-5 w-5 align-middle"}}),{c(){P(e.$$.fragment)},l(n){y(e.$$.fragment,n)},m(n,s){j(e,n,s),t=!0},p:K,i(n){t||(h(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){C(e,n)}}}function vt(a){let e,t;return e=new Te({props:{class:"inline-block h-5 w-5 align-middle"}}),{c(){P(e.$$.fragment)},l(n){y(e.$$.fragment,n)},m(n,s){j(e,n,s),t=!0},p:K,i(n){t||(h(e.$$.fragment,n),t=!0)},o(n){$(e.$$.fragment,n),t=!1},d(n){C(e,n)}}}function Pe(a){let e,t="MultiPolygon detected.";return{c(){e=N("div"),e.textContent=t,this.h()},l(n){e=V(n,"DIV",{class:!0,"data-svelte-h":!0}),ie(e)!=="svelte-zrl27z"&&(e.textContent=t),this.h()},h(){b(e,"class","text-center text-sm text-blue-500")},m(n,s){v(n,e,s)},d(n){n&&_(e)}}}function kt(a){var S;let e,t,n,s,r,l,o,i,f=(((S=a[19].area)==null?void 0:S.toFixed(2))??"N/A")+"",p,c,u,d,m,z,M,R,T;function J(...w){return a[10](a[21],...w)}t=new Re({props:{type:"text",value:a[19].name,class:"w-full bg-transparent text-base font-semibold sm:text-lg"}}),t.$on("input",J);function U(w){a[11](w,a[19])}let Y={geojson:a[19].boundary,width:300,height:200};a[19].area!==void 0&&(Y.areaHectares=a[19].area),r=new ht({props:Y}),Se.push(()=>De(r,"areaHectares",U));function g(){return a[12](a[21])}m=new Q({props:{variant:a[19].status==="accepted"?"default":"outline",class:"mx-1.5 inline-block h-10 w-10 rounded-full p-0 align-middle leading-[2.5rem]",$$slots:{default:[bt]},$$scope:{ctx:a}}}),m.$on("click",g);function E(){return a[13](a[21])}M=new Q({props:{variant:a[19].status==="rejected"?"default":"outline",class:"mx-1.5 inline-block h-10 w-10 rounded-full p-0 align-middle leading-[2.5rem]",$$slots:{default:[vt]},$$scope:{ctx:a}}}),M.$on("click",E);let I=a[19].isMultiPolygon&&Pe();return{c(){e=N("div"),P(t.$$.fragment),n=A(),s=N("div"),P(r.$$.fragment),o=A(),i=N("div"),p=W(f),c=W(" hectares"),u=A(),d=N("div"),P(m.$$.fragment),z=A(),P(M.$$.fragment),R=A(),I&&I.c(),this.h()},l(w){e=V(w,"DIV",{class:!0});var k=H(e);y(t.$$.fragment,k),n=D(k),s=V(k,"DIV",{class:!0});var O=H(s);y(r.$$.fragment,O),O.forEach(_),o=D(k),i=V(k,"DIV",{class:!0});var F=H(i);p=x(F,f),c=x(F," hectares"),F.forEach(_),u=D(k),d=V(k,"DIV",{class:!0});var X=H(d);y(m.$$.fragment,X),z=D(X),y(M.$$.fragment,X),X.forEach(_),R=D(k),I&&I.l(k),k.forEach(_),this.h()},h(){b(s,"class","mx-auto aspect-[3/2] w-full max-w-[300px]"),b(i,"class","text-center text-sm"),b(d,"class","text-center"),b(e,"class","flex flex-col space-y-2 p-2 sm:space-y-4 sm:p-4")},m(w,k){v(w,e,k),j(t,e,null),B(e,n),B(e,s),j(r,s,null),B(e,o),B(e,i),B(i,p),B(i,c),B(e,u),B(e,d),j(m,d,null),B(d,z),j(M,d,null),B(e,R),I&&I.m(e,null),T=!0},p(w,k){var fe;a=w;const O={};k&1&&(O.value=a[19].name),t.$set(O);const F={};k&1&&(F.geojson=a[19].boundary),!l&&k&1&&(l=!0,F.areaHectares=a[19].area,Ae(()=>l=!1)),r.$set(F),(!T||k&1)&&f!==(f=(((fe=a[19].area)==null?void 0:fe.toFixed(2))??"N/A")+"")&&Je(p,f);const X={};k&1&&(X.variant=a[19].status==="accepted"?"default":"outline"),k&8388608&&(X.$$scope={dirty:k,ctx:a}),m.$set(X);const oe={};k&1&&(oe.variant=a[19].status==="rejected"?"default":"outline"),k&8388608&&(oe.$$scope={dirty:k,ctx:a}),M.$set(oe),a[19].isMultiPolygon?I||(I=Pe(),I.c(),I.m(e,null)):I&&(I.d(1),I=null)},i(w){T||(h(t.$$.fragment,w),h(r.$$.fragment,w),h(m.$$.fragment,w),h(M.$$.fragment,w),T=!0)},o(w){$(t.$$.fragment,w),$(r.$$.fragment,w),$(m.$$.fragment,w),$(M.$$.fragment,w),T=!1},d(w){w&&_(e),C(t),C(r),C(m),C(M),I&&I.d()}}}function Pt(a){let e,t,n;return e=new Ne({props:{$$slots:{default:[kt]},$$scope:{ctx:a}}}),{c(){P(e.$$.fragment),t=A()},l(s){y(e.$$.fragment,s),t=D(s)},m(s,r){j(e,s,r),v(s,t,r),n=!0},p(s,r){const l={};r&8388609&&(l.$$scope={dirty:r,ctx:s}),e.$set(l)},i(s){n||(h(e.$$.fragment,s),n=!0)},o(s){$(e.$$.fragment,s),n=!1},d(s){s&&_(t),C(e,s)}}}function ye(a,e){let t,n,s;return n=new xe({props:{class:"w-full",$$slots:{default:[Pt]},$$scope:{ctx:e}}}),{key:a,first:null,c(){t=Z(),P(n.$$.fragment),this.h()},l(r){t=Z(),y(n.$$.fragment,r),this.h()},h(){this.first=t},m(r,l){v(r,t,l),j(n,r,l),s=!0},p(r,l){e=r;const o={};l&8388609&&(o.$$scope={dirty:l,ctx:e}),n.$set(o)},i(r){s||(h(n.$$.fragment,r),s=!0)},o(r){$(n.$$.fragment,r),s=!1},d(r){r&&_(t),C(n,r)}}}function yt(a){let e=[],t=new Map,n,s,r=te(a[0]);const l=o=>o[21];for(let o=0;o<r.length;o+=1){let i=ke(a,r,o),f=l(i);t.set(f,e[o]=ye(f,i))}return{c(){for(let o=0;o<e.length;o+=1)e[o].c();n=Z()},l(o){for(let i=0;i<e.length;i+=1)e[i].l(o);n=Z()},m(o,i){for(let f=0;f<e.length;f+=1)e[f]&&e[f].m(o,i);v(o,n,i),s=!0},p(o,i){i&113&&(r=te(o[0]),ce(),e=Ye(e,i,l,1,o,r,t,n.parentNode,Ge,ye,n,ke),ue())},i(o){if(!s){for(let i=0;i<r.length;i+=1)h(e[i]);s=!0}},o(o){for(let i=0;i<e.length;i+=1)$(e[i]);s=!1},d(o){o&&_(n);for(let i=0;i<e.length;i+=1)e[i].d(o)}}}function jt(a){let e,t,n,s,r,l;return e=new We({props:{$$slots:{default:[yt]},$$scope:{ctx:a}}}),n=new it({}),r=new mt({}),{c(){P(e.$$.fragment),t=A(),P(n.$$.fragment),s=A(),P(r.$$.fragment)},l(o){y(e.$$.fragment,o),t=D(o),y(n.$$.fragment,o),s=D(o),y(r.$$.fragment,o)},m(o,i){j(e,o,i),v(o,t,i),j(n,o,i),v(o,s,i),j(r,o,i),l=!0},p(o,i){const f={};i&8388609&&(f.$$scope={dirty:i,ctx:o}),e.$set(f)},i(o){l||(h(e.$$.fragment,o),h(n.$$.fragment,o),h(r.$$.fragment,o),l=!0)},o(o){$(e.$$.fragment,o),$(n.$$.fragment,o),$(r.$$.fragment,o),l=!1},d(o){o&&(_(t),_(s)),C(e,o),C(n,o),C(r,o)}}}function Ct(a){let e,t,n;return t=new nt({props:{class:"h-3 w-3 text-white"}}),{c(){e=N("div"),P(t.$$.fragment),this.h()},l(s){e=V(s,"DIV",{class:!0});var r=H(e);y(t.$$.fragment,r),r.forEach(_),this.h()},h(){b(e,"class","flex h-full w-full items-center justify-center rounded-full bg-blue-200")},m(s,r){v(s,e,r),j(t,e,null),n=!0},i(s){n||(h(t.$$.fragment,s),n=!0)},o(s){$(t.$$.fragment,s),n=!1},d(s){s&&_(e),C(t)}}}function It(a){let e,t,n;return t=new Te({props:{class:"h-3 w-3 text-white"}}),{c(){e=N("div"),P(t.$$.fragment),this.h()},l(s){e=V(s,"DIV",{class:!0});var r=H(e);y(t.$$.fragment,r),r.forEach(_),this.h()},h(){b(e,"class","flex h-full w-full items-center justify-center rounded-full bg-red-500")},m(s,r){v(s,e,r),j(t,e,null),n=!0},i(s){n||(h(t.$$.fragment,s),n=!0)},o(s){$(t.$$.fragment,s),n=!1},d(s){s&&_(e),C(t)}}}function Mt(a){let e,t,n;return t=new Oe({props:{class:"h-3 w-3 text-white"}}),{c(){e=N("div"),P(t.$$.fragment),this.h()},l(s){e=V(s,"DIV",{class:!0});var r=H(e);y(t.$$.fragment,r),r.forEach(_),this.h()},h(){b(e,"class","flex h-full w-full items-center justify-center rounded-full bg-green-500")},m(s,r){v(s,e,r),j(t,e,null),n=!0},i(s){n||(h(t.$$.fragment,s),n=!0)},o(s){$(t.$$.fragment,s),n=!1},d(s){s&&_(e),C(t)}}}function zt(a){let e;return{c(){e=N("div"),this.h()},l(t){e=V(t,"DIV",{class:!0}),H(e).forEach(_),this.h()},h(){b(e,"class","w-full")},m(t,n){v(t,e,n)},d(t){t&&_(e)}}}function je(a){let e,t,n,s,r,l;const o=[Mt,It,Ct],i=[];function f(c,u){return c[19].status==="accepted"?0:c[19].status==="rejected"?1:c[19].status==="warning"?2:-1}~(t=f(a))&&(n=i[t]=o[t](a));let p=(a[21]+1)%10===0&&zt();return{c(){e=N("div"),n&&n.c(),s=A(),p&&p.c(),r=Z(),this.h()},l(c){e=V(c,"DIV",{class:!0});var u=H(e);n&&n.l(u),u.forEach(_),s=D(c),p&&p.l(c),r=Z(),this.h()},h(){b(e,"class","m-1 flex h-4 w-4 cursor-pointer items-center justify-center rounded-full transition-all duration-300 ease-in-out"),L(e,"bg-green-200",a[21]===a[2]),L(e,"bg-muted",a[21]!==a[2]),L(e,"outline-black-500",a[21]===a[2]),L(e,"outline-2",a[21]===a[2]),L(e,"outline",a[21]===a[2])},m(c,u){v(c,e,u),~t&&i[t].m(e,null),v(c,s,u),p&&p.m(c,u),v(c,r,u),l=!0},p(c,u){let d=t;t=f(c),t!==d&&(n&&(ce(),$(i[d],1,1,()=>{i[d]=null}),ue()),~t?(n=i[t],n||(n=i[t]=o[t](c),n.c()),h(n,1),n.m(e,null)):n=null),(!l||u&4)&&L(e,"bg-green-200",c[21]===c[2]),(!l||u&4)&&L(e,"bg-muted",c[21]!==c[2]),(!l||u&4)&&L(e,"outline-black-500",c[21]===c[2]),(!l||u&4)&&L(e,"outline-2",c[21]===c[2]),(!l||u&4)&&L(e,"outline",c[21]===c[2])},i(c){l||(h(n),l=!0)},o(c){$(n),l=!1},d(c){c&&(_(e),_(s),_(r)),~t&&i[t].d(),p&&p.d(c)}}}function Et(a){let e,t,n,s,r;function l(c){a[14](c)}let o={class:"mx-auto",style:"width: 100%; max-width: 50vw;",$$slots:{default:[jt]},$$scope:{ctx:a}};a[1]!==void 0&&(o.api=a[1]),e=new Ue({props:o}),Se.push(()=>De(e,"api",l));let i=te(a[0]),f=[];for(let c=0;c<i.length;c+=1)f[c]=je(ve(a,i,c));const p=c=>$(f[c],1,1,()=>{f[c]=null});return{c(){P(e.$$.fragment),n=A(),s=N("div");for(let c=0;c<f.length;c+=1)f[c].c();this.h()},l(c){y(e.$$.fragment,c),n=D(c),s=V(c,"DIV",{class:!0});var u=H(s);for(let d=0;d<f.length;d+=1)f[d].l(u);u.forEach(_),this.h()},h(){b(s,"class","mt-4 flex flex-wrap justify-center")},m(c,u){j(e,c,u),v(c,n,u),v(c,s,u);for(let d=0;d<f.length;d+=1)f[d]&&f[d].m(s,null);r=!0},p(c,u){const d={};if(u&8388609&&(d.$$scope={dirty:u,ctx:c}),!t&&u&2&&(t=!0,d.api=c[1],Ae(()=>t=!1)),e.$set(d),u&5){i=te(c[0]);let m;for(m=0;m<i.length;m+=1){const z=ve(c,i,m);f[m]?(f[m].p(z,u),h(f[m],1)):(f[m]=je(z),f[m].c(),h(f[m],1),f[m].m(s,null))}for(ce(),m=i.length;m<f.length;m+=1)p(m);ue()}},i(c){if(!r){h(e.$$.fragment,c);for(let u=0;u<i.length;u+=1)h(f[u]);r=!0}},o(c){$(e.$$.fragment,c),f=f.filter(Boolean);for(let u=0;u<f.length;u+=1)$(f[u]);r=!1},d(c){c&&(_(n),_(s)),C(e,c),Xe(f,c)}}}function St(a){let e;return{c(){e=W("Accept All")},l(t){e=x(t,"Accept All")},m(t,n){v(t,e,n)},d(t){t&&_(e)}}}function At(a){let e;return{c(){e=W("Load")},l(t){e=x(t,"Load")},m(t,n){v(t,e,n)},d(t){t&&_(e)}}}function Dt(a){let e,t,n,s;return e=new Q({props:{variant:"outline",$$slots:{default:[St]},$$scope:{ctx:a}}}),e.$on("click",a[7]),n=new Q({props:{class:"bg-black",disabled:!a[3],$$slots:{default:[At]},$$scope:{ctx:a}}}),n.$on("click",a[8]),{c(){P(e.$$.fragment),t=A(),P(n.$$.fragment)},l(r){y(e.$$.fragment,r),t=D(r),y(n.$$.fragment,r)},m(r,l){j(e,r,l),v(r,t,l),j(n,r,l),s=!0},p(r,l){const o={};l&8388608&&(o.$$scope={dirty:l,ctx:r}),e.$set(o);const i={};l&8&&(i.disabled=!r[3]),l&8388608&&(i.$$scope={dirty:l,ctx:r}),n.$set(i)},i(r){s||(h(e.$$.fragment,r),h(n.$$.fragment,r),s=!0)},o(r){$(e.$$.fragment,r),$(n.$$.fragment,r),s=!1},d(r){r&&_(t),C(e,r),C(n,r)}}}function Nt(a){let e,t,n,s,r,l;return e=new Ke({props:{$$slots:{default:[wt]},$$scope:{ctx:a}}}),n=new Ze({props:{$$slots:{default:[Et]},$$scope:{ctx:a}}}),r=new Le({props:{class:"flex justify-center space-x-4",$$slots:{default:[Dt]},$$scope:{ctx:a}}}),{c(){P(e.$$.fragment),t=A(),P(n.$$.fragment),s=A(),P(r.$$.fragment)},l(o){y(e.$$.fragment,o),t=D(o),y(n.$$.fragment,o),s=D(o),y(r.$$.fragment,o)},m(o,i){j(e,o,i),v(o,t,i),j(n,o,i),v(o,s,i),j(r,o,i),l=!0},p(o,i){const f={};i&8388608&&(f.$$scope={dirty:i,ctx:o}),e.$set(f);const p={};i&8388615&&(p.$$scope={dirty:i,ctx:o}),n.$set(p);const c={};i&8388616&&(c.$$scope={dirty:i,ctx:o}),r.$set(c)},i(o){l||(h(e.$$.fragment,o),h(n.$$.fragment,o),h(r.$$.fragment,o),l=!0)},o(o){$(e.$$.fragment,o),$(n.$$.fragment,o),$(r.$$.fragment,o),l=!1},d(o){o&&(_(t),_(s)),C(e,o),C(n,o),C(r,o)}}}function Vt(a){let e,t,n;return t=new Ne({props:{class:"mx-auto w-full max-w-4xl",$$slots:{default:[Nt]},$$scope:{ctx:a}}}),{c(){e=N("div"),P(t.$$.fragment),this.h()},l(s){e=V(s,"DIV",{class:!0});var r=H(e);y(t.$$.fragment,r),r.forEach(_),this.h()},h(){b(e,"class","container mx-auto px-4")},m(s,r){v(s,e,r),j(t,e,null),n=!0},p(s,[r]){const l={};r&8388623&&(l.$$scope={dirty:r,ctx:s}),t.$set(l)},i(s){n||(h(t.$$.fragment,s),n=!0)},o(s){$(t.$$.fragment,s),n=!1},d(s){s&&_(e),C(t)}}}function Ft(a,e,t){let n,s,r;q(a,Me,g=>t(16,s=g)),q(a,Ie,g=>t(17,r=g));let{data:l}=e,o=[];Ee(()=>{var g;(g=l.processedData)!=null&&g.paddocks&&t(0,o=l.processedData.paddocks.map(E=>{const I=E.boundary.type==="MultiPolygon";return{...E,status:I?"warning":null,area:void 0,isMultiPolygon:I}}))});let i,f=0,p=0;function c(g,E){const I=E.target;t(0,o[g].name=I.value,o),t(0,o=[...o])}function u(g){t(0,o[g].status="accepted",o),t(0,o=[...o]),m()}function d(g){t(0,o[g].status="rejected",o),t(0,o=[...o]),m()}function m(){f<p-1&&i.scrollNext()}function z(){t(0,o=o.map(g=>({...g,status:"accepted"})))}async function M(){const g=r.id,E=new Headers({"Content-Type":"application/json"});s!=null&&s.access_token&&E.append("Authorization",`Bearer ${s.access_token}`);const I=fetch("/api/files/upload_fields",{method:"POST",headers:E,body:JSON.stringify({map_id:g,fields:o})}).then(async S=>{const w=await S.json();if(!S.ok)throw new Error(w.error);return w});$e.promise(I,{loading:"Submitting paddocks...",success:S=>{const w=S.insertedFields.length;return w===1?`Paddock "${S.insertedFields[0].name}" was uploaded.`:`${w} paddocks were uploaded.`},error:S=>S.message});try{const S=await I;if(S.rejectedFields&&S.rejectedFields.length>0){const w=S.rejectedFields.reduce((O,F)=>(O[F.reason]=(O[F.reason]||0)+1,O),{});let k=`${S.rejectedFields.length} paddock(s) were rejected:`;for(const[O,F]of Object.entries(w))k+=`
${F} ${F===1?"paddock":"paddocks"} rejected for ${O}`;$e.error(k,{duration:7e3})}}catch{}finally{setTimeout(()=>{qe("/account/fieldview/")},500)}}const R=(g,E)=>c(g,E);function T(g,E){a.$$.not_equal(E.area,g)&&(E.area=g,t(0,o))}const J=g=>u(g),U=g=>d(g);function Y(g){i=g,t(1,i)}return a.$$set=g=>{"data"in g&&t(9,l=g.data)},a.$$.update=()=>{a.$$.dirty&2&&i&&(p=i.scrollSnapList().length,t(2,f=i.selectedScrollSnap()),i.on("select",()=>{t(2,f=i.selectedScrollSnap())})),a.$$.dirty&1&&t(3,n=o.every(g=>g.status!==null))},[o,i,f,n,c,u,d,z,M,l,R,T,J,U,Y]}class ln extends se{constructor(e){super(),ae(this,e,Ft,Vt,re,{data:9})}}export{ln as component,on as universal};

import{s as we,n as ue,d as y,q as F,i as U,a as l,A as xe,b as h,c as b,e as x,g as R,f as C,h as H,j as _,k as V,t as P,l as Ee,$ as De,G as Se,L as ke}from"../chunks/Bqk-ehBx.js";import{e as fe}from"../chunks/3VE9X77f.js";import{S as Le,i as Te}from"../chunks/BSIXs_Xe.js";import{s as te}from"../chunks/BZNkLwfI.js";import{i as ye,a as Ae,p as Ie,b as Ce}from"../chunks/DjC0lmFS.js";import{p as Ve}from"../chunks/BjDwzmod.js";function Me(r){const t=JSON.parse(r);return t.data&&(t.data=Ie(t.data,Ce.decoders)),t}function oe(r){return HTMLElement.prototype.cloneNode.call(r)}function Oe(r,t=()=>{}){const e=async({action:s,result:o,reset:n=!0,invalidateAll:i=!0})=>{o.type==="success"&&(n&&HTMLFormElement.prototype.reset.call(r),i&&await ye()),(location.origin+location.pathname===s.origin+s.pathname||o.type==="redirect"||o.type==="error")&&await Ae(o)};async function f(s){var L,k,E,g,u;if(((L=s.submitter)!=null&&L.hasAttribute("formmethod")?s.submitter.formMethod:oe(r).method)!=="post")return;s.preventDefault();const n=new URL((k=s.submitter)!=null&&k.hasAttribute("formaction")?s.submitter.formAction:oe(r).action),i=(E=s.submitter)!=null&&E.hasAttribute("formenctype")?s.submitter.formEnctype:oe(r).enctype,a=new FormData(r),c=(g=s.submitter)==null?void 0:g.getAttribute("name");c&&a.append(c,((u=s.submitter)==null?void 0:u.getAttribute("value"))??"");const p=new AbortController;let d=!1;const D=await t({action:n,cancel:()=>d=!0,controller:p,formData:a,formElement:r,submitter:s.submitter})??e;if(d)return;let I;try{const m=new Headers({accept:"application/json","x-sveltekit-action":"true"});i!=="multipart/form-data"&&m.set("Content-Type",/^(:?application\/x-www-form-urlencoded|text\/plain)$/.test(i)?i:"application/x-www-form-urlencoded");const S=i==="multipart/form-data"?a:new URLSearchParams(a),w=await fetch(n,{method:"POST",headers:m,cache:"no-store",body:S,signal:p.signal});I=Me(await w.text()),I.type==="error"&&(I.status=w.status)}catch(m){if((m==null?void 0:m.name)==="AbortError")return;I={type:"error",error:m}}await D({action:n,formData:a,formElement:r,update:m=>e({action:n,result:I,reset:m==null?void 0:m.reset,invalidateAll:m==null?void 0:m.invalidateAll}),result:I})}return HTMLFormElement.prototype.addEventListener.call(r,"submit",f),{destroy(){HTMLFormElement.prototype.removeEventListener.call(r,"submit",f)}}}const Fe=!1,ze=Object.freeze(Object.defineProperty({__proto__:null,prerender:Fe},Symbol.toStringTag,{value:"Module"}));function me(r,t,e){const f=r.slice();return f[9]=t[e],f}function pe(r){let t,e,f;return{c(){t=_("div"),e=_("span"),f=P(r[3]),this.h()},l(s){t=b(s,"DIV",{class:!0,role:!0});var o=x(t);e=b(o,"SPAN",{class:!0});var n=x(e);f=H(n,r[3]),n.forEach(y),o.forEach(y),this.h()},h(){h(e,"class","block sm:inline"),h(t,"class","relative rounded border border-red-400 bg-red-100 px-4 py-3 text-red-700"),h(t,"role","alert")},m(s,o){U(s,t,o),l(t,e),l(e,f)},p(s,o){o&8&&F(f,s[3])},d(s){s&&y(t)}}}function he(r){let t,e,f=r[2]?"Loading...":"Logout",s,o,n,i;return{c(){t=_("form"),e=_("button"),s=P(f),this.h()},l(a){t=b(a,"FORM",{method:!0,action:!0});var c=x(t);e=b(c,"BUTTON",{type:!0,class:!0});var p=x(e);s=H(p,f),p.forEach(y),c.forEach(y),this.h()},h(){h(e,"type","submit"),e.disabled=r[2],h(e,"class","flex w-full justify-center rounded-md border border-transparent bg-red-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 disabled:opacity-50"),h(t,"method","POST"),h(t,"action","?/logout")},m(a,c){U(a,t,c),l(t,e),l(e,s),n||(i=De(o=Oe.call(null,t,r[7])),n=!0)},p(a,c){c&4&&f!==(f=a[2]?"Loading...":"Logout")&&F(s,f),c&4&&(e.disabled=a[2]),o&&ke(o.update)&&c&12&&o.update.call(null,a[7])},d(a){a&&y(t),n=!1,i()}}}function ge(r){let t,e,f='<h3 class="text-lg font-medium leading-6 text-gray-900">Active Session Found</h3>',s,o,n,i,a,c="User ID",p,d,v=r[0].id+"",D,I,L,k,E="Email",g,u,m=r[0].email+"",S,w,T,A,N="Provider",B,z,J=r[0].provider+"",Z,se,j,q,le="Expires At",ae,G,K=new Date(r[0].expiresAt*1e3).toLocaleString()+"",$;return{c(){t=_("div"),e=_("div"),e.innerHTML=f,s=V(),o=_("div"),n=_("dl"),i=_("div"),a=_("dt"),a.textContent=c,p=V(),d=_("dd"),D=P(v),I=V(),L=_("div"),k=_("dt"),k.textContent=E,g=V(),u=_("dd"),S=P(m),w=V(),T=_("div"),A=_("dt"),A.textContent=N,B=V(),z=_("dd"),Z=P(J),se=V(),j=_("div"),q=_("dt"),q.textContent=le,ae=V(),G=_("dd"),$=P(K),this.h()},l(O){t=b(O,"DIV",{class:!0});var M=x(t);e=b(M,"DIV",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-m18uka"&&(e.innerHTML=f),s=C(M),o=b(M,"DIV",{class:!0});var re=x(o);n=b(re,"DL",{});var Q=x(n);i=b(Q,"DIV",{class:!0});var W=x(i);a=b(W,"DT",{class:!0,"data-svelte-h":!0}),R(a)!=="svelte-11k5p0n"&&(a.textContent=c),p=C(W),d=b(W,"DD",{class:!0});var ne=x(d);D=H(ne,v),ne.forEach(y),I=C(W),W.forEach(y),L=b(Q,"DIV",{class:!0});var X=x(L);k=b(X,"DT",{class:!0,"data-svelte-h":!0}),R(k)!=="svelte-qj6i1v"&&(k.textContent=E),g=C(X),u=b(X,"DD",{class:!0});var ie=x(u);S=H(ie,m),ie.forEach(y),w=C(X),X.forEach(y),T=b(Q,"DIV",{class:!0});var Y=x(T);A=b(Y,"DT",{class:!0,"data-svelte-h":!0}),R(A)!=="svelte-12jityq"&&(A.textContent=N),B=C(Y),z=b(Y,"DD",{class:!0});var ce=x(z);Z=H(ce,J),ce.forEach(y),se=C(Y),Y.forEach(y),j=b(Q,"DIV",{class:!0});var ee=x(j);q=b(ee,"DT",{class:!0,"data-svelte-h":!0}),R(q)!=="svelte-1qs6ebm"&&(q.textContent=le),ae=C(ee),G=b(ee,"DD",{class:!0});var de=x(G);$=H(de,K),de.forEach(y),ee.forEach(y),Q.forEach(y),re.forEach(y),M.forEach(y),this.h()},h(){h(e,"class","px-4 py-5 sm:px-6"),h(a,"class","text-sm font-medium text-gray-500"),h(d,"class","mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0"),h(i,"class","bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"),h(k,"class","text-sm font-medium text-gray-500"),h(u,"class","mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0"),h(L,"class","bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"),h(A,"class","text-sm font-medium text-gray-500"),h(z,"class","mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0"),h(T,"class","bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"),h(q,"class","text-sm font-medium text-gray-500"),h(G,"class","mt-1 text-sm text-gray-900 sm:col-span-2 sm:mt-0"),h(j,"class","bg-white px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6"),h(o,"class","border-t border-gray-200"),h(t,"class","overflow-hidden bg-white shadow sm:rounded-lg")},m(O,M){U(O,t,M),l(t,e),l(t,s),l(t,o),l(o,n),l(n,i),l(i,a),l(i,p),l(i,d),l(d,D),l(i,I),l(n,L),l(L,k),l(L,g),l(L,u),l(u,S),l(L,w),l(n,T),l(T,A),l(T,B),l(T,z),l(z,Z),l(T,se),l(n,j),l(j,q),l(j,ae),l(j,G),l(G,$)},p(O,M){M&1&&v!==(v=O[0].id+"")&&F(D,v),M&1&&m!==(m=O[0].email+"")&&F(S,m),M&1&&J!==(J=O[0].provider+"")&&F(Z,J),M&1&&K!==(K=new Date(O[0].expiresAt*1e3).toLocaleString()+"")&&F($,K)},d(O){O&&y(t)}}}function ve(r){let t,e,f='<h3 class="text-lg font-medium leading-6 text-gray-900">Active Cookies Found</h3> <p class="mt-1 text-sm text-gray-500">Supabase-related cookies currently stored in browser</p>',s,o,n,i=fe(r[4]),a=[];for(let c=0;c<i.length;c+=1)a[c]=be(me(r,i,c));return{c(){t=_("div"),e=_("div"),e.innerHTML=f,s=V(),o=_("div"),n=_("dl");for(let c=0;c<a.length;c+=1)a[c].c();this.h()},l(c){t=b(c,"DIV",{class:!0});var p=x(t);e=b(p,"DIV",{class:!0,"data-svelte-h":!0}),R(e)!=="svelte-s04tvc"&&(e.innerHTML=f),s=C(p),o=b(p,"DIV",{class:!0});var d=x(o);n=b(d,"DL",{});var v=x(n);for(let D=0;D<a.length;D+=1)a[D].l(v);v.forEach(y),d.forEach(y),p.forEach(y),this.h()},h(){h(e,"class","px-4 py-5 sm:px-6"),h(o,"class","border-t border-gray-200"),h(t,"class","mt-8 overflow-hidden bg-white shadow sm:rounded-lg")},m(c,p){U(c,t,p),l(t,e),l(t,s),l(t,o),l(o,n);for(let d=0;d<a.length;d+=1)a[d]&&a[d].m(n,null)},p(c,p){if(p&16){i=fe(c[4]);let d;for(d=0;d<i.length;d+=1){const v=me(c,i,d);a[d]?a[d].p(v,p):(a[d]=be(v),a[d].c(),a[d].m(n,null))}for(;d<a.length;d+=1)a[d].d(1);a.length=i.length}},d(c){c&&y(t),Se(a,c)}}}function be(r){let t,e,f=r[9].name+"",s,o,n,i=r[9].value+"",a,c;return{c(){t=_("div"),e=_("dt"),s=P(f),o=V(),n=_("dd"),a=P(i),c=V(),this.h()},l(p){t=b(p,"DIV",{class:!0});var d=x(t);e=b(d,"DT",{class:!0});var v=x(e);s=H(v,f),v.forEach(y),o=C(d),n=b(d,"DD",{class:!0});var D=x(n);a=H(D,i),D.forEach(y),c=C(d),d.forEach(y),this.h()},h(){h(e,"class","break-all text-sm font-medium text-gray-500"),h(n,"class","mt-1 break-all text-sm text-gray-900 sm:col-span-2 sm:mt-0"),h(t,"class","bg-gray-50 px-4 py-5 sm:grid sm:grid-cols-3 sm:gap-4 sm:px-6")},m(p,d){U(p,t,d),l(t,e),l(e,s),l(t,o),l(t,n),l(n,a),l(t,c)},p(p,d){d&16&&f!==(f=p[9].name+"")&&F(s,f),d&16&&i!==(i=p[9].value+"")&&F(a,i)},d(p){p&&y(t)}}}function _e(r){let t,e,f;return{c(){t=_("div"),e=_("span"),f=P(r[1]),this.h()},l(s){t=b(s,"DIV",{class:!0,role:!0});var o=x(t);e=b(o,"SPAN",{class:!0});var n=x(e);f=H(n,r[1]),n.forEach(y),o.forEach(y),this.h()},h(){h(e,"class","block sm:inline"),h(t,"class","relative rounded border border-green-400 bg-green-100 px-4 py-3 text-green-700"),h(t,"role","alert")},m(s,o){U(s,t,o),l(t,e),l(e,f)},p(s,o){o&2&&F(f,s[1])},d(s){s&&y(t)}}}function He(r){let t,e,f,s='<h2 class="mt-6 text-3xl font-extrabold text-gray-900">Session Management</h2>',o,n,i,a,c=r[2]?"Loading...":"Find Session",p,d,v,D,I,L,k,E=r[3]&&pe(r),g=r[0]&&he(r),u=r[0]&&ge(r),m=r[4].length>0&&ve(r),S=r[1]&&_e(r);return{c(){t=_("div"),e=_("div"),f=_("div"),f.innerHTML=s,o=V(),E&&E.c(),n=V(),i=_("div"),a=_("button"),p=P(c),d=V(),g&&g.c(),v=V(),u&&u.c(),D=V(),m&&m.c(),I=V(),S&&S.c(),this.h()},l(w){t=b(w,"DIV",{class:!0});var T=x(t);e=b(T,"DIV",{class:!0});var A=x(e);f=b(A,"DIV",{class:!0,"data-svelte-h":!0}),R(f)!=="svelte-1n2wac4"&&(f.innerHTML=s),o=C(A),E&&E.l(A),n=C(A),i=b(A,"DIV",{class:!0});var N=x(i);a=b(N,"BUTTON",{class:!0});var B=x(a);p=H(B,c),B.forEach(y),d=C(N),g&&g.l(N),N.forEach(y),v=C(A),u&&u.l(A),D=C(A),m&&m.l(A),I=C(A),S&&S.l(A),A.forEach(y),T.forEach(y),this.h()},h(){h(f,"class","text-center"),a.disabled=r[2],h(a,"class","flex w-full justify-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 disabled:opacity-50"),h(i,"class","space-y-4"),h(e,"class","mx-auto max-w-md space-y-8"),h(t,"class","min-h-screen bg-gray-50 px-4 py-12 sm:px-6 lg:px-8")},m(w,T){U(w,t,T),l(t,e),l(e,f),l(e,o),E&&E.m(e,null),l(e,n),l(e,i),l(i,a),l(a,p),l(i,d),g&&g.m(i,null),l(e,v),u&&u.m(e,null),l(e,D),m&&m.m(e,null),l(e,I),S&&S.m(e,null),L||(k=xe(a,"click",r[5]),L=!0)},p(w,[T]){w[3]?E?E.p(w,T):(E=pe(w),E.c(),E.m(e,n)):E&&(E.d(1),E=null),T&4&&c!==(c=w[2]?"Loading...":"Find Session")&&F(p,c),T&4&&(a.disabled=w[2]),w[0]?g?g.p(w,T):(g=he(w),g.c(),g.m(i,null)):g&&(g.d(1),g=null),w[0]?u?u.p(w,T):(u=ge(w),u.c(),u.m(e,D)):u&&(u.d(1),u=null),w[4].length>0?m?m.p(w,T):(m=ve(w),m.c(),m.m(e,I)):m&&(m.d(1),m=null),w[1]?S?S.p(w,T):(S=_e(w),S.c(),S.m(e,null)):S&&(S.d(1),S=null)},i:ue,o:ue,d(w){w&&y(t),E&&E.d(),g&&g.d(),u&&u.d(),m&&m.d(),S&&S.d(),L=!1,k()}}}function Pe(r,t,e){let f;Ee(r,Ve,v=>e(8,f=v));let s=null,o="",n=!1,i="",a=[];async function c(){var v,D,I,L;try{e(2,n=!0),e(3,i=""),e(0,s=f.data.session),console.log("Raw session data:",f.data.session),e(4,a=document.cookie.split(";").map(k=>{const[E,g]=k.trim().split("=");return{name:E,value:g}}).filter(k=>k.name.includes("supabase")||k.name.includes("sb-"))),console.log("Current cookies:",a),s?(e(0,s={id:(v=s.user)==null?void 0:v.id,email:(D=s.user)==null?void 0:D.email,provider:(L=(I=s.user)==null?void 0:I.app_metadata)==null?void 0:L.provider,expiresAt:s.expires_at}),console.log("Processed session data:",s),e(1,o="")):(e(0,s=null),e(1,o="No active session found"))}catch(k){e(3,i=k.message||"Failed to fetch session"),e(0,s=null)}finally{e(2,n=!1)}}async function p(){try{e(2,n=!0),e(3,i="");const v=()=>{for(let g=0;g<localStorage.length;g++){const u=localStorage.key(g);(u!=null&&u.includes("supabase")||u!=null&&u.includes("sb-"))&&localStorage.removeItem(u)}for(let g=0;g<sessionStorage.length;g++){const u=sessionStorage.key(g);(u!=null&&u.includes("supabase")||u!=null&&u.includes("sb-"))&&sessionStorage.removeItem(u)}const k=[window.location.hostname,`.${window.location.hostname}`,window.location.hostname.split(".").slice(1).join("."),""],E=["/",""];document.cookie.split(";").forEach(g=>{const u=g.split("=")[0].trim();(u.includes("supabase")||u.includes("sb-"))&&k.forEach(m=>{E.forEach(S=>{document.cookie=`${u}=; expires=Thu, 01 Jan 1970 00:00:00 GMT; path=${S}${m?`; domain=${m}`:""}`})})})},D=new FormData;if(!(await fetch("?/logout",{method:"POST",body:D})).ok)throw new Error("Server-side logout failed");const{error:L}=await te.auth.signOut({scope:"global"});if(L)throw L;v(),await ye(),e(0,s=null),e(4,a=[]),e(1,o="Successfully logged out and cleared session"),console.log("Initial cleanup completed"),setTimeout(async()=>{v(),e(1,o="Verifying session state..."),await c();const{data:{session:k}}=await te.auth.getSession();k||s?(console.log("Session still detected - attempting final cleanup"),e(1,o="Session still detected - forcing page reload..."),await te.auth.signOut({scope:"global"}),v(),window.location.href="/login"):(e(1,o="Verification complete: No active session found"),console.log("Logout successful - no session detected"))},2e3)}catch(v){console.error("Logout error:",v),e(3,i=v.message||"Failed to logout");try{clearBrowserStorage(),await te.auth.signOut({scope:"global"})}catch(D){console.error("Recovery attempt failed:",D)}}finally{e(2,n=!1)}}return[s,o,n,i,a,c,p,()=>(e(2,n=!0),async({result:v})=>{v.error&&e(3,i=v.error),await p()})]}class Ge extends Le{constructor(t){super(),Te(this,t,Pe,He,we,{})}}export{Ge as component,ze as universal};

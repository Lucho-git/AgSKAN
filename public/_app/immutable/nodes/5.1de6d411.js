import{i as yt,a as St,s as kt}from"../chunks/sessionStore.a0feee67.js";import{s as It,e as s,a as u,t as P,c as l,b as h,g as L,f as d,h as y,d as c,i as r,j as Ce,k as e,q as j,l as Et,z as Dt,n as re,B as Pt,m as Nt,u as Lt,o as Tt,p as At}from"../chunks/scheduler.0ff5556b.js";import{S as Vt,i as Ht,b as ut,e as zt,t as dt,g as Ot}from"../chunks/index.e3d1f712.js";import{g as ct}from"../chunks/navigation.f06e96a7.js";import{p as jt}from"../chunks/stores.7b09ef55.js";const Ut=async()=>({}),Xt=Object.freeze(Object.defineProperty({__proto__:null,load:Ut},Symbol.toStringTag,{value:"Module"}));function wt(a){let t,o,n=a[3].message+"",E;return{c(){t=s("p"),o=P("Error: "),E=P(n),this.h()},l(i){t=l(i,"P",{class:!0});var f=h(t);o=y(f,"Error: "),E=y(f,n),f.forEach(c),this.h()},h(){r(t,"class","text-red-500")},m(i,f){Ce(i,t,f),e(t,o),e(t,E)},p(i,f){f&8&&n!==(n=i[3].message+"")&&j(E,n)},d(i){i&&c(t)}}}function Mt(a){let t,o='<div class="h-12 w-12 animate-spin rounded-full border-4 border-blue-500 border-t-transparent"></div> <p class="mt-4 text-lg">Checking authentication...</p>';return{c(){t=s("div"),t.innerHTML=o,this.h()},l(n){t=l(n,"DIV",{class:!0,"data-svelte-h":!0}),L(t)!=="svelte-1gzcq5r"&&(t.innerHTML=o),this.h()},h(){r(t,"class","flex flex-col items-center justify-center p-12")},m(n,E){Ce(n,t,E)},p:re,i:re,o:re,d(n){n&&c(t)}}}function Rt(a){let t,o='<div class="rounded-lg bg-red-50 p-6 text-center"><h2 class="mb-2 text-xl font-semibold text-red-700">No Session Found</h2> <p>You don&#39;t appear to be authenticated. Redirecting to login page...</p> <div class="mt-4"><a href="/login" class="inline-block rounded bg-blue-500 px-4 py-2 text-white">Go to Login</a></div></div>';return{c(){t=s("div"),t.innerHTML=o,this.h()},l(n){t=l(n,"DIV",{class:!0,"data-svelte-h":!0}),L(t)!=="svelte-rfig46"&&(t.innerHTML=o),this.h()},h(){r(t,"class","flex flex-col items-center justify-center p-12")},m(n,E){Ce(n,t,E)},p:re,i:re,o:re,d(n){n&&c(t)}}}function Ft(a){let t,o,n="Session detected but not in store",E,i,f=`You appear to be authenticated, but the session store hasn't updated.\r
        This could be due to initialization timing.`,U,g,C,V="Manually set session",m,D,T=Ke(a[2])+"",_,M,w;return{c(){t=s("div"),o=s("h2"),o.textContent=n,E=u(),i=s("p"),i.textContent=f,U=u(),g=s("div"),C=s("button"),C.textContent=V,m=u(),D=s("pre"),_=P(T),this.h()},l(I){t=l(I,"DIV",{class:!0});var x=h(t);o=l(x,"H2",{class:!0,"data-svelte-h":!0}),L(o)!=="svelte-1bi0801"&&(o.textContent=n),E=d(x),i=l(x,"P",{class:!0,"data-svelte-h":!0}),L(i)!=="svelte-15gdphk"&&(i.textContent=f),U=d(x),g=l(x,"DIV",{class:!0});var B=h(g);C=l(B,"BUTTON",{class:!0,"data-svelte-h":!0}),L(C)!=="svelte-2sirs2"&&(C.textContent=V),B.forEach(c),m=d(x),D=l(x,"PRE",{class:!0});var J=h(D);_=y(J,T),J.forEach(c),x.forEach(c),this.h()},h(){r(o,"class","text-lg font-semibold"),r(i,"class","mt-2"),r(C,"class","rounded bg-blue-500 px-4 py-2 text-white"),r(g,"class","mt-4"),r(D,"class","mt-4 rounded bg-gray-100 p-4 text-sm"),r(t,"class","rounded-lg bg-yellow-50 p-6")},m(I,x){Ce(I,t,x),e(t,o),e(t,E),e(t,i),e(t,U),e(t,g),e(g,C),e(t,m),e(t,D),e(D,_),M||(w=Pt(C,"click",a[10]),M=!0)},p(I,x){x&4&&T!==(T=Ke(I[2])+"")&&j(_,T)},i:re,o:re,d(I){I&&c(t),M=!1,w()}}}function qt(a){let t,o,n,E="✓ Authenticated",i,f,U,g=a[1].user.email+"",C,V,m,D,T,_="User Info",M,w,I,x,B="ID:",J,Y=a[1].user.id+"",Q,ce,R,G,Z="Email:",$,W=a[1].user.email+"",ee,H,N,z,A="Last Signed In:",xe,F=new Date(a[1].user.last_sign_in_at).toLocaleString()+"",ue,p,b,S,Se="Created At:",de,X=new Date(a[1].user.created_at).toLocaleString()+"",te,Qe,se,fe,ft="Session Details",We,K,pe,he,pt="Expires At:",Xe,we=new Date(a[1].expires_at*1e3).toLocaleString()+"",Ne,Ze,ve,_e,ht="Access Token Available:",$e,Pe=a[1].access_token?"✓":"✗",Le,et,ge,me,vt="Refresh Token Available:",tt,ye=a[1].refresh_token?"✓":"✗",Te,st,le,be,_t="Full Session Data (JSON)",lt,ke,Ee,Ie=Ke(a[1])+"",Ae,ot,oe,ne,gt="Sign Out",nt,ae,mt="Go to Home",Ve,O,at,bt;const it=a[9].default,q=Nt(it,a,a[8],null);return{c(){t=s("div"),o=s("div"),n=s("p"),n.textContent=E,i=u(),f=s("p"),U=P("User is signed in as "),C=P(g),V=u(),m=s("div"),D=s("div"),T=s("h2"),T.textContent=_,M=u(),w=s("div"),I=s("p"),x=s("span"),x.textContent=B,J=u(),Q=P(Y),ce=u(),R=s("p"),G=s("span"),G.textContent=Z,$=u(),ee=P(W),H=u(),N=s("p"),z=s("span"),z.textContent=A,xe=u(),ue=P(F),p=u(),b=s("p"),S=s("span"),S.textContent=Se,de=u(),te=P(X),Qe=u(),se=s("div"),fe=s("h2"),fe.textContent=ft,We=u(),K=s("div"),pe=s("p"),he=s("span"),he.textContent=pt,Xe=u(),Ne=P(we),Ze=u(),ve=s("p"),_e=s("span"),_e.textContent=ht,$e=u(),Le=P(Pe),et=u(),ge=s("p"),me=s("span"),me.textContent=vt,tt=u(),Te=P(ye),st=u(),le=s("div"),be=s("h2"),be.textContent=_t,lt=u(),ke=s("div"),Ee=s("pre"),Ae=P(Ie),ot=u(),oe=s("div"),ne=s("button"),ne.textContent=gt,nt=u(),ae=s("a"),ae.textContent=mt,Ve=u(),q&&q.c(),this.h()},l(v){t=l(v,"DIV",{class:!0});var k=h(t);o=l(k,"DIV",{class:!0});var He=h(o);n=l(He,"P",{class:!0,"data-svelte-h":!0}),L(n)!=="svelte-r13s7d"&&(n.textContent=E),i=d(He),f=l(He,"P",{class:!0});var rt=h(f);U=y(rt,"User is signed in as "),C=y(rt,g),rt.forEach(c),He.forEach(c),V=d(k),m=l(k,"DIV",{class:!0});var ze=h(m);D=l(ze,"DIV",{class:!0});var Oe=h(D);T=l(Oe,"H2",{class:!0,"data-svelte-h":!0}),L(T)!=="svelte-7bcbcr"&&(T.textContent=_),M=d(Oe),w=l(Oe,"DIV",{class:!0});var ie=h(w);I=l(ie,"P",{});var je=h(I);x=l(je,"SPAN",{class:!0,"data-svelte-h":!0}),L(x)!=="svelte-7fxu4f"&&(x.textContent=B),J=d(je),Q=y(je,Y),je.forEach(c),ce=d(ie),R=l(ie,"P",{});var Ue=h(R);G=l(Ue,"SPAN",{class:!0,"data-svelte-h":!0}),L(G)!=="svelte-z1jqoe"&&(G.textContent=Z),$=d(Ue),ee=y(Ue,W),Ue.forEach(c),H=d(ie),N=l(ie,"P",{});var Me=h(N);z=l(Me,"SPAN",{class:!0,"data-svelte-h":!0}),L(z)!=="svelte-4avlh5"&&(z.textContent=A),xe=d(Me),ue=y(Me,F),Me.forEach(c),p=d(ie),b=l(ie,"P",{});var Re=h(b);S=l(Re,"SPAN",{class:!0,"data-svelte-h":!0}),L(S)!=="svelte-1opwh7"&&(S.textContent=Se),de=d(Re),te=y(Re,X),Re.forEach(c),ie.forEach(c),Oe.forEach(c),Qe=d(ze),se=l(ze,"DIV",{class:!0});var Fe=h(se);fe=l(Fe,"H2",{class:!0,"data-svelte-h":!0}),L(fe)!=="svelte-x75ow4"&&(fe.textContent=ft),We=d(Fe),K=l(Fe,"DIV",{class:!0});var De=h(K);pe=l(De,"P",{});var qe=h(pe);he=l(qe,"SPAN",{class:!0,"data-svelte-h":!0}),L(he)!=="svelte-1hldhij"&&(he.textContent=pt),Xe=d(qe),Ne=y(qe,we),qe.forEach(c),Ze=d(De),ve=l(De,"P",{});var Be=h(ve);_e=l(Be,"SPAN",{class:!0,"data-svelte-h":!0}),L(_e)!=="svelte-u76evy"&&(_e.textContent=ht),$e=d(Be),Le=y(Be,Pe),Be.forEach(c),et=d(De),ge=l(De,"P",{});var Ye=h(ge);me=l(Ye,"SPAN",{class:!0,"data-svelte-h":!0}),L(me)!=="svelte-1cs8cvx"&&(me.textContent=vt),tt=d(Ye),Te=y(Ye,ye),Ye.forEach(c),De.forEach(c),Fe.forEach(c),ze.forEach(c),st=d(k),le=l(k,"DIV",{class:!0});var Ge=h(le);be=l(Ge,"H2",{class:!0,"data-svelte-h":!0}),L(be)!=="svelte-1712m1a"&&(be.textContent=_t),lt=d(Ge),ke=l(Ge,"DIV",{class:!0});var Ct=h(ke);Ee=l(Ct,"PRE",{class:!0});var xt=h(Ee);Ae=y(xt,Ie),xt.forEach(c),Ct.forEach(c),Ge.forEach(c),ot=d(k),oe=l(k,"DIV",{class:!0});var Je=h(oe);ne=l(Je,"BUTTON",{class:!0,"data-svelte-h":!0}),L(ne)!=="svelte-1njwmat"&&(ne.textContent=gt),nt=d(Je),ae=l(Je,"A",{href:!0,class:!0,"data-svelte-h":!0}),L(ae)!=="svelte-anvipy"&&(ae.textContent=mt),Je.forEach(c),k.forEach(c),Ve=d(v),q&&q.l(v),this.h()},h(){r(n,"class","font-semibold text-green-700"),r(f,"class","mt-2"),r(o,"class","rounded-lg bg-green-50 p-4"),r(T,"class","mb-4 text-xl font-semibold"),r(x,"class","font-semibold"),r(G,"class","font-semibold"),r(z,"class","font-semibold"),r(S,"class","font-semibold"),r(w,"class","mt-4"),r(D,"class","rounded-lg bg-white p-6 shadow"),r(fe,"class","mb-4 text-xl font-semibold"),r(he,"class","font-semibold"),r(_e,"class","font-semibold"),r(me,"class","font-semibold"),r(K,"class","mt-4"),r(se,"class","rounded-lg bg-white p-6 shadow"),r(m,"class","grid gap-6 md:grid-cols-2"),r(be,"class","mb-4 text-xl font-semibold"),r(Ee,"class","whitespace-pre-wrap rounded bg-gray-100 p-4 text-sm"),r(ke,"class","overflow-x-auto"),r(le,"class","rounded-lg bg-white p-6 shadow"),r(ne,"class","rounded bg-red-600 px-4 py-2 text-white hover:bg-red-700"),r(ae,"href","/"),r(ae,"class","ml-4 inline-block rounded border border-gray-300 px-4 py-2 hover:bg-gray-50"),r(oe,"class","mt-6"),r(t,"class","grid gap-6")},m(v,k){Ce(v,t,k),e(t,o),e(o,n),e(o,i),e(o,f),e(f,U),e(f,C),e(t,V),e(t,m),e(m,D),e(D,T),e(D,M),e(D,w),e(w,I),e(I,x),e(I,J),e(I,Q),e(w,ce),e(w,R),e(R,G),e(R,$),e(R,ee),e(w,H),e(w,N),e(N,z),e(N,xe),e(N,ue),e(w,p),e(w,b),e(b,S),e(b,de),e(b,te),e(m,Qe),e(m,se),e(se,fe),e(se,We),e(se,K),e(K,pe),e(pe,he),e(pe,Xe),e(pe,Ne),e(K,Ze),e(K,ve),e(ve,_e),e(ve,$e),e(ve,Le),e(K,et),e(K,ge),e(ge,me),e(ge,tt),e(ge,Te),e(t,st),e(t,le),e(le,be),e(le,lt),e(le,ke),e(ke,Ee),e(Ee,Ae),e(t,ot),e(t,oe),e(oe,ne),e(oe,nt),e(oe,ae),Ce(v,Ve,k),q&&q.m(v,k),O=!0,at||(bt=Pt(ne,"click",a[5]),at=!0)},p(v,k){(!O||k&2)&&g!==(g=v[1].user.email+"")&&j(C,g),(!O||k&2)&&Y!==(Y=v[1].user.id+"")&&j(Q,Y),(!O||k&2)&&W!==(W=v[1].user.email+"")&&j(ee,W),(!O||k&2)&&F!==(F=new Date(v[1].user.last_sign_in_at).toLocaleString()+"")&&j(ue,F),(!O||k&2)&&X!==(X=new Date(v[1].user.created_at).toLocaleString()+"")&&j(te,X),(!O||k&2)&&we!==(we=new Date(v[1].expires_at*1e3).toLocaleString()+"")&&j(Ne,we),(!O||k&2)&&Pe!==(Pe=v[1].access_token?"✓":"✗")&&j(Le,Pe),(!O||k&2)&&ye!==(ye=v[1].refresh_token?"✓":"✗")&&j(Te,ye),(!O||k&2)&&Ie!==(Ie=Ke(v[1])+"")&&j(Ae,Ie),q&&q.p&&(!O||k&256)&&Lt(q,it,v,v[8],O?At(it,v[8],k,null):Tt(v[8]),null)},i(v){O||(dt(q,v),O=!0)},o(v){ut(q,v),O=!1},d(v){v&&(c(t),c(Ve)),q&&q.d(v),at=!1,bt()}}}function Bt(a){let t,o,n="Static Authentication Details",E,i,f,U="Debug Information",g,C,V,m=a[0]?"Yes":"No",D,T,_,M,w=a[2]?"Found":"Not found",I,x,B,J,Y=a[1]?"Found":"Not found",Q,ce,R,G,Z=a[4].url.pathname+"",$,W,ee,H,N,z,A=a[3]&&wt(a);const xe=[qt,Ft,Rt,Mt],F=[];function ue(p,b){return p[1]?0:p[2]&&!p[1]?1:p[0]&&!p[2]?2:3}return H=ue(a),N=F[H]=xe[H](a),{c(){t=s("div"),o=s("h1"),o.textContent=n,E=u(),i=s("div"),f=s("h2"),f.textContent=U,g=u(),C=s("p"),V=P("Session checked: "),D=P(m),T=u(),_=s("p"),M=P("Direct session check: "),I=P(w),x=u(),B=s("p"),J=P("Store session: "),Q=P(Y),ce=u(),R=s("p"),G=P("Current URL: "),$=P(Z),W=u(),A&&A.c(),ee=u(),N.c(),this.h()},l(p){t=l(p,"DIV",{class:!0});var b=h(t);o=l(b,"H1",{class:!0,"data-svelte-h":!0}),L(o)!=="svelte-b9zpbp"&&(o.textContent=n),E=d(b),i=l(b,"DIV",{class:!0});var S=h(i);f=l(S,"H2",{class:!0,"data-svelte-h":!0}),L(f)!=="svelte-p8pdfv"&&(f.textContent=U),g=d(S),C=l(S,"P",{});var Se=h(C);V=y(Se,"Session checked: "),D=y(Se,m),Se.forEach(c),T=d(S),_=l(S,"P",{});var de=h(_);M=y(de,"Direct session check: "),I=y(de,w),de.forEach(c),x=d(S),B=l(S,"P",{});var X=h(B);J=y(X,"Store session: "),Q=y(X,Y),X.forEach(c),ce=d(S),R=l(S,"P",{});var te=h(R);G=y(te,"Current URL: "),$=y(te,Z),te.forEach(c),W=d(S),A&&A.l(S),S.forEach(c),ee=d(b),N.l(b),b.forEach(c),this.h()},h(){r(o,"class","mb-6 text-3xl font-bold"),r(f,"class","font-semibold"),r(i,"class","mb-4 rounded-lg bg-blue-50 p-4"),r(t,"class","container mx-auto p-6")},m(p,b){Ce(p,t,b),e(t,o),e(t,E),e(t,i),e(i,f),e(i,g),e(i,C),e(C,V),e(C,D),e(i,T),e(i,_),e(_,M),e(_,I),e(i,x),e(i,B),e(B,J),e(B,Q),e(i,ce),e(i,R),e(R,G),e(R,$),e(i,W),A&&A.m(i,null),e(t,ee),F[H].m(t,null),z=!0},p(p,[b]){(!z||b&1)&&m!==(m=p[0]?"Yes":"No")&&j(D,m),(!z||b&4)&&w!==(w=p[2]?"Found":"Not found")&&j(I,w),(!z||b&2)&&Y!==(Y=p[1]?"Found":"Not found")&&j(Q,Y),(!z||b&16)&&Z!==(Z=p[4].url.pathname+"")&&j($,Z),p[3]?A?A.p(p,b):(A=wt(p),A.c(),A.m(i,null)):A&&(A.d(1),A=null);let S=H;H=ue(p),H===S?F[H].p(p,b):(Ot(),ut(F[S],1,1,()=>{F[S]=null}),zt(),N=F[H],N?N.p(p,b):(N=F[H]=xe[H](p),N.c()),dt(N,1),N.m(t,null))},i(p){z||(dt(N),z=!0)},o(p){ut(N),z=!1},d(p){p&&c(t),A&&A.d(),F[H].d()}}}function Ke(a){return JSON.stringify(a,null,2)}function Yt(a,t,o){let n,E;Et(a,kt,_=>o(1,n=_)),Et(a,jt,_=>o(4,E=_));let{$$slots:i={},$$scope:f}=t,U=!1,g=null,C=null,V=!1;console.log("Layout component initializing"),console.log("Current session state:",n),Dt(async()=>{console.log("Layout mounted, checking session...");try{console.log("Explicitly initializing session..."),await yt(),console.log("Getting session directly...");const{data:_,error:M}=await St.auth.getSession();o(2,g=_.session),o(3,C=M),console.log("Direct session check result:",g,M),g?(console.log("User authenticated:",g.user.email),console.log("Access token exists:",!!g.access_token),console.log("Session expires:",new Date(g.expires_at*1e3).toLocaleString())):(console.log("No session found directly"),setTimeout(async()=>{console.log("Delayed session check, store value:",n),!n&&!V&&(console.log("Still no session after delay, redirecting..."),o(6,V=!0),ct("/login"))},1e3))}catch(_){console.error("Error checking session:",_),o(3,C=_)}finally{o(0,U=!0)}});let m;async function D(){console.log("Signing out..."),await St.auth.signOut(),ct("/login")}Dt(()=>()=>{m&&clearTimeout(m)});const T=()=>kt.set(g);return a.$$set=_=>{"$$scope"in _&&o(8,f=_.$$scope)},a.$$.update=()=>{a.$$.dirty&2&&(console.log("Session store changed:",n),n&&console.log("Session detected in store")),a.$$.dirty&195&&U&&n===null&&!V&&(console.log("Session is null but giving it a moment..."),m&&clearTimeout(m),o(7,m=setTimeout(()=>{console.log("Timeout completed, session still null:",n===null),n===null&&(console.log("Redirecting to login after timeout..."),o(6,V=!0),ct("/login"))},2e3)))},[U,n,g,C,E,D,V,m,f,i,T]}class Zt extends Vt{constructor(t){super(),Ht(this,t,Yt,Bt,It,{})}}export{Zt as component,Xt as universal};

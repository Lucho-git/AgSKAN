import{s as H,a as k,e as S,w as y,x as T,d,f as $,c as x,g as C,i as w,j as p,l as z,y as M,z as V,n as h}from"../chunks/scheduler.0ff5556b.js";import{S as j,i as L,b as g,e as P,t as b,g as U,c as q,a as A,m as B,d as D}from"../chunks/index.e3d1f712.js";import{s as I}from"../chunks/sessionStore.a0feee67.js";import{g as E}from"../chunks/navigation.f06e96a7.js";import{u as N}from"../chunks/userSettingsApi.4dfbaeb0.js";import{S as Y}from"../chunks/settings_module.b92a59b1.js";function F(r){var a,c;let t,n;return t=new Y({props:{title:"Change Email",editable:!0,successTitle:"Email change initiated",successBody:"You should receive emails at both the old and new address to confirm the change. Please click the link in both emails to finalize the change. Until finalized, you must sign in with your current email.",apiHandler:r[2],fields:[{id:"email",label:"Email",initialValue:((c=(a=r[1])==null?void 0:a.user)==null?void 0:c.email)??"",placeholder:"Email address"}]}}),t.$on("success",r[3]),{c(){q(t.$$.fragment)},l(e){A(t.$$.fragment,e)},m(e,i){B(t,e,i),n=!0},p(e,i){var o,f;const l={};i&2&&(l.fields=[{id:"email",label:"Email",initialValue:((f=(o=e[1])==null?void 0:o.user)==null?void 0:f.email)??"",placeholder:"Email address"}]),t.$set(l)},i(e){n||(b(t.$$.fragment,e),n=!0)},o(e){g(t.$$.fragment,e),n=!1},d(e){D(t,e)}}}function G(r){let t,n='<div class="loading loading-spinner loading-lg"></div>';return{c(){t=S("div"),t.innerHTML=n,this.h()},l(a){t=x(a,"DIV",{class:!0,"data-svelte-h":!0}),C(t)!=="svelte-asr66p"&&(t.innerHTML=n),this.h()},h(){w(t,"class","flex h-64 items-center justify-center")},m(a,c){p(a,t,c)},p:h,i:h,o:h,d(a){a&&d(t)}}}function J(r){let t,n,a="Settings",c,e,i,l,o;const f=[G,F],u=[];function v(s,m){return s[0]?0:1}return e=v(r),i=u[e]=f[e](r),{c(){t=k(),n=S("h1"),n.textContent=a,c=k(),i.c(),l=y(),this.h()},l(s){T("svelte-oxf6bt",document.head).forEach(d),t=$(s),n=x(s,"H1",{class:!0,"data-svelte-h":!0}),C(n)!=="svelte-mlvd3d"&&(n.textContent=a),c=$(s),i.l(s),l=y(),this.h()},h(){document.title="Change Email",w(n,"class","mb-6 text-2xl font-bold")},m(s,m){p(s,t,m),p(s,n,m),p(s,c,m),u[e].m(s,m),p(s,l,m),o=!0},p(s,[m]){let _=e;e=v(s),e===_?u[e].p(s,m):(U(),g(u[_],1,1,()=>{u[_]=null}),P(),i=u[e],i?i.p(s,m):(i=u[e]=f[e](s),i.c()),b(i,1),i.m(l.parentNode,l))},i(s){o||(b(i),o=!0)},o(s){g(i),o=!1},d(s){s&&(d(t),d(n),d(c),d(l)),u[e].d(s)}}}function K(r,t,n){let a;z(r,I,o=>n(1,a=o)),M("adminSection").set("settings");let e=!0;V(()=>{if(!a){E("/login");return}n(0,e=!1)});async function i(o){return await N.updateEmail(o.email)}function l(){setTimeout(()=>{E("/account/settings")},1500)}return[e,a,i,l]}class ee extends j{constructor(t){super(),L(this,t,K,J,H,{})}}export{ee as component};

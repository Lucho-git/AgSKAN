import{s as B,d as f,i as S,b as h,w as N,f as E,c as m,e as g,k as w,j as _,l as H,z as $,n as P,g as D,q as L,a as u,A,h as U,t as G}from"../chunks/scheduler.BVGjjnGO.js";import{S as J,i as K,t as V,a as j,e as Q,d as R,m as W,c as X,b as Y,g as Z}from"../chunks/index.Vv2yv23T.js";import{P as ee}from"../chunks/PricingSection.CZLwpf9A.js";import{s as te,a as re}from"../chunks/sessionStore.rIZpZ3yf.js";import{p as M}from"../chunks/profileStore.DorDk9Q6.js";import{t as q}from"../chunks/Toaster.svelte_svelte_type_style_lang.BcvbULy5.js";import{g as ae}from"../chunks/entry.BMnqIGFd.js";const oe=()=>({}),ve=Object.freeze(Object.defineProperty({__proto__:null,load:oe},Symbol.toStringTag,{value:"Module"}));function se(v){let t,r,a="Select a Plan",o,s,i,c,l,e,n,d,b,p,y,T,z;return i=new ee({props:{currentPlanId:"none",useFullPrice:!0}}),{c(){t=_("div"),r=_("h1"),r.textContent=a,o=w(),s=_("div"),Y(i.$$.fragment),c=w(),l=_("div"),e=_("div"),n=_("div"),d=_("button"),b=w(),p=_("div"),this.h()},l(x){t=m(x,"DIV",{class:!0});var k=g(t);r=m(k,"H1",{class:!0,"data-svelte-h":!0}),D(r)!=="svelte-1ms61ox"&&(r.textContent=a),o=E(k),s=m(k,"DIV",{class:!0});var C=g(s);X(i.$$.fragment,C),c=E(C),l=m(C,"DIV",{class:!0});var F=g(l);e=m(F,"DIV",{class:!0});var I=g(e);n=m(I,"DIV",{class:!0});var O=g(n);d=m(O,"BUTTON",{class:!0,"aria-label":!0}),g(d).forEach(f),O.forEach(f),b=E(I),p=m(I,"DIV",{}),g(p).forEach(f),I.forEach(f),F.forEach(f),C.forEach(f),k.forEach(f),this.h()},h(){h(r,"class","mb-4 text-center text-4xl font-bold"),h(d,"class","pointer-events-auto absolute bottom-[calc(50%-80px)] left-1/2 h-12 w-[90%] -translate-x-1/2 opacity-0"),h(d,"aria-label","Get Started with Free Plan"),h(n,"class","relative"),h(e,"class","grid h-full md:grid-cols-2"),h(l,"class","pointer-events-none absolute left-0 top-0 z-10 h-full w-full"),h(s,"class","relative"),h(t,"class","py-2")},m(x,k){S(x,t,k),u(t,r),u(t,o),u(t,s),W(i,s,null),u(s,c),u(s,l),u(l,e),u(e,n),u(n,d),u(e,b),u(e,p),y=!0,T||(z=A(d,"click",v[2]),T=!0)},p:P,i(x){y||(j(i.$$.fragment,x),y=!0)},o(x){V(i.$$.fragment,x),y=!1},d(x){x&&f(t),R(i),T=!1,z()}}}function ne(v){let t,r,a="Error",o,s,i,c,l,e="Try Again",n,d;return{c(){t=_("div"),r=_("h2"),r.textContent=a,o=w(),s=_("p"),i=G(v[1]),c=w(),l=_("button"),l.textContent=e,this.h()},l(b){t=m(b,"DIV",{class:!0});var p=g(t);r=m(p,"H2",{class:!0,"data-svelte-h":!0}),D(r)!=="svelte-1ndfz0n"&&(r.textContent=a),o=E(p),s=m(p,"P",{class:!0});var y=g(s);i=U(y,v[1]),y.forEach(f),c=E(p),l=m(p,"BUTTON",{class:!0,"data-svelte-h":!0}),D(l)!=="svelte-12xr3ni"&&(l.textContent=e),p.forEach(f),this.h()},h(){h(r,"class","mb-4 text-xl font-bold text-red-700"),h(s,"class","text-red-600"),h(l,"class","mt-4 rounded bg-primary px-4 py-2 text-white"),h(t,"class","my-8 rounded-lg bg-red-50 p-6 text-center")},m(b,p){S(b,t,p),u(t,r),u(t,o),u(t,s),u(s,i),u(t,c),u(t,l),n||(d=A(l,"click",v[3]),n=!0)},p(b,p){p&2&&L(i,b[1])},i:P,o:P,d(b){b&&f(t),n=!1,d()}}}function le(v){let t,r='<div class="h-12 w-12 animate-spin rounded-full border-4 border-primary border-t-transparent"></div>';return{c(){t=_("div"),t.innerHTML=r,this.h()},l(a){t=m(a,"DIV",{class:!0,"data-svelte-h":!0}),D(t)!=="svelte-1kiyzhj"&&(t.innerHTML=r),this.h()},h(){h(t,"class","flex h-48 items-center justify-center")},m(a,o){S(a,t,o)},p:P,i:P,o:P,d(a){a&&f(t)}}}function ie(v){let t,r,a,o,s;const i=[le,ne,se],c=[];function l(e,n){return e[0]?0:e[1]?1:2}return a=l(v),o=c[a]=i[a](v),{c(){t=w(),r=_("div"),o.c(),this.h()},l(e){N("svelte-1dceu6j",document.head).forEach(f),t=E(e),r=m(e,"DIV",{class:!0});var d=g(r);o.l(d),d.forEach(f),this.h()},h(){document.title="Select a Plan",h(r,"class","container mx-auto px-4")},m(e,n){S(e,t,n),S(e,r,n),c[a].m(r,null),s=!0},p(e,[n]){let d=a;a=l(e),a===d?c[a].p(e,n):(Z(),V(c[d],1,1,()=>{c[d]=null}),Q(),o=c[a],o?o.p(e,n):(o=c[a]=i[a](e),o.c()),j(o,1),o.m(r,null))},i(e){s||(j(o),s=!0)},o(e){V(o),s=!1},d(e){e&&(f(t),f(r)),c[a].d()}}}function ce(v,t,r){let a,o;H(v,te,e=>r(4,a=e)),H(v,M,e=>r(5,o=e));let s=!0,i=null;$(async()=>{try{if(o?.id){const{error:e}=await re.from("profiles").update({onboarded:!0,updated_at:new Date().toISOString()}).eq("id",o.id);e&&console.error("Error updating onboarding status:",e),M.update(n=>({...n,onboarded:!0}))}r(0,s=!1)}catch(e){console.error("Error initializing payment page:",e),r(1,i=e.message),r(0,s=!1)}});async function c(){try{if(!a?.access_token)throw new Error("No authentication token available");if(!(await fetch("/api/subscription/free",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${a.access_token}`}})).ok)throw new Error("Failed to activate free plan");q.success("Free plan activated!"),ae("/account")}catch(e){console.error(e),q.error("Failed to activate free plan. Please try again.")}}return[s,i,c,()=>window.location.reload()]}class be extends J{constructor(t){super(),K(this,t,ce,ie,B,{})}}export{be as component,ve as universal};
